///////////////////////////////////////////////////////////////////////////////
//                                                                            /
// IAR C/C++ Compiler V8.20.2.41139 for 8051            27/Mar/2014  17:05:43 /
// Copyright 2004-2013 IAR Systems AB.                                        /
//                                                                            /
//    Core               =  plain                                             /
//    Code model         =  banked                                            /
//    Data model         =  large                                             /
//    Calling convention =  xdata reentrant                                   /
//    Constant location  =  data_rom                                          /
//    Dptr setup         =  1,16                                              /
//                                                                            /
//    Source file        =  D:\Texas Instruments\Z-Stack Lighting             /
//                          1.0.2\Components\stack\zdo\ZDSecMgr.c             /
//    Command line       =  -f "D:\Texas Instruments\Z-Stack Lighting         /
//                          1.0.2\Projects\zstack\ZLL\SampleApp\CC253x\..\..\ /
//                          ..\Tools\CC2530DB\f8wRouter.cfg" (-DCPU32MHZ      /
//                          -DROOT=__near_func -DMAC_CFG_APP_PENDING_QUEUE=TR /
//                          UE -DMAC_CFG_TX_DATA_MAX=5 -DMAC_CFG_TX_MAX=8     /
//                          -DMAC_CFG_RX_MAX=5 -DRTR_NWK) -f "D:\Texas        /
//                          Instruments\Z-Stack Lighting                      /
//                          1.0.2\Projects\zstack\ZLL\SampleApp\CC253x\..\..\ /
//                          ..\Tools\CC2530DB\f8wConfig.cfg" (-DZIGBEEPRO     /
//                          -DSECURE=1 -DZG_SECURE_DYNAMIC=0 -DREFLECTOR      /
//                          -DDEFAULT_CHANLIST=0x00000800                     /
//                          -DZDAPP_CONFIG_PAN_ID=0xFFFF                      /
//                          -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_M /
//                          ASK=0x007F -DBEACON_REQUEST_DELAY=100             /
//                          -DBEACON_REQ_DELAY_MASK=0x00FF                    /
//                          -DLINK_STATUS_JITTER_MASK=0x007F                  /
//                          -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_P /
//                          OLLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7           /
//                          -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3   /
//                          -DNWK_MAX_DATA_RETRIES=2                          /
//                          -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9        /
//                          -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40          /
//                          -DNWK_MAX_BINDING_ENTRIES=4                       /
//                          -DMAX_BINDING_CLUSTER_IDS=4                       /
//                          "-DDEFAULT_KEY={0x01, 0x03, 0x05, 0x07, 0x09,     /
//                          0x0B, 0x0D, 0x0F, 0x00, 0x02, 0x04, 0x06, 0x08,   /
//                          0x0A, 0x0C, 0x0D}" -DMAC_MAX_FRAME_SIZE=116       /
//                          -DZDNWKMGR_MIN_TRANSMISSIONS=20 "-DCONST=const    /
//                          __code" -DGENERIC=__generic                       /
//                          -DRFD_RCVC_ALWAYS_ON=FALSE -DPOLL_RATE=1000       /
//                          -DQUEUED_POLL_RATE=100 -DRESPONSE_POLL_RATE=100   /
//                          -DREJOIN_POLL_RATE=440) -f "D:\Texas              /
//                          Instruments\Z-Stack Lighting                      /
//                          1.0.2\Projects\zstack\ZLL\SampleApp\CC253x\..\..\ /
//                          ..\Tools\CC2530DB\f8wZCL.cfg" "D:\Texas           /
//                          Instruments\Z-Stack Lighting                      /
//                          1.0.2\Components\stack\zdo\ZDSecMgr.c" -D         /
//                          FEATURE_GREEN_POWER -D SECURE=1 -D                /
//                          TC_LINKKEY_JOIN -D ZDSECMGR_TC_DEVICE_MAX=2 -D    /
//                          NV_RESTORE -D HOLD_AUTO_START -D INTER_PAN -D     /
//                          ZTOOL_P1 -D MT_TASK -D MT_APP_FUNC -D             /
//                          MT_SYS_FUNC -D MT_ZDO_FUNC -D MT_ZDO_CB_FUNC -D   /
//                          MT_UTIL_FUNC -D MT_ZDO_MGMT -D LCD_SUPPORTED -D   /
//                          HAL_LCD=FALSE -D HAL_KEY=FALSE -D ZCL_BASIC -D    /
//                          ZCL_READ -D ZCL_WRITE -D ZCL_IDENTIFY -D          /
//                          ZCL_ON_OFF -D ZCL_SCENES -D ZCL_GROUPS -D         /
//                          ZCL_LIGHT_LINK_ENHANCE -D ZCL_LEVEL_CTRL -D       /
//                          ZCL_COLOR_CTRL -D xMAX_CHANNELS_24GHZ=0x02108800  /
//                          -lC "D:\Texas Instruments\Z-Stack Lighting        /
//                          1.0.2\Projects\zstack\ZLL\SampleApp\CC253x\Bridge /
//                          EB-Pro\List\" -lA "D:\Texas Instruments\Z-Stack   /
//                          Lighting 1.0.2\Projects\zstack\ZLL\SampleApp\CC25 /
//                          3x\BridgeEB-Pro\List\" --diag_suppress            /
//                          Pe001,Pa010 -o "D:\Texas Instruments\Z-Stack      /
//                          Lighting 1.0.2\Projects\zstack\ZLL\SampleApp\CC25 /
//                          3x\BridgeEB-Pro\Obj\" -e --debug --core=plain     /
//                          --dptr=16,1 --data_model=large                    /
//                          --code_model=banked --calling_convention=xdata_re /
//                          entrant --place_constants=data_rom                /
//                          --nr_virtual_regs 16 -I "D:\Texas                 /
//                          Instruments\Z-Stack Lighting                      /
//                          1.0.2\Projects\zstack\ZLL\SampleApp\CC253x\" -I   /
//                          "D:\Texas Instruments\Z-Stack Lighting            /
//                          1.0.2\Projects\zstack\ZLL\SampleApp\CC253x\..\Sou /
//                          rce\" -I "D:\Texas Instruments\Z-Stack Lighting   /
//                          1.0.2\Projects\zstack\ZLL\SampleApp\CC253x\..\..\ /
//                          Source\" -I "D:\Texas Instruments\Z-Stack         /
//                          Lighting 1.0.2\Projects\zstack\ZLL\SampleApp\CC25 /
//                          3x\..\..\..\HomeAutomation\Source\" -I "D:\Texas  /
//                          Instruments\Z-Stack Lighting                      /
//                          1.0.2\Projects\zstack\ZLL\SampleApp\CC253x\..\..\ /
//                          ..\HomeAutomation\SampleLight\Source\" -I         /
//                          "D:\Texas Instruments\Z-Stack Lighting            /
//                          1.0.2\Projects\zstack\ZLL\SampleApp\CC253x\..\..\ /
//                          ..\ZMain\TI2530DB\" -I "D:\Texas                  /
//                          Instruments\Z-Stack Lighting                      /
//                          1.0.2\Projects\zstack\ZLL\SampleApp\CC253x\..\..\ /
//                          ..\..\..\Components\hal\include\" -I "D:\Texas    /
//                          Instruments\Z-Stack Lighting                      /
//                          1.0.2\Projects\zstack\ZLL\SampleApp\CC253x\..\..\ /
//                          ..\..\..\Components\hal\target\CC2530EB\" -I      /
//                          "D:\Texas Instruments\Z-Stack Lighting            /
//                          1.0.2\Projects\zstack\ZLL\SampleApp\CC253x\..\..\ /
//                          ..\..\..\Components\mac\include\" -I "D:\Texas    /
//                          Instruments\Z-Stack Lighting                      /
//                          1.0.2\Projects\zstack\ZLL\SampleApp\CC253x\..\..\ /
//                          ..\..\..\Components\mac\high_level\" -I           /
//                          "D:\Texas Instruments\Z-Stack Lighting            /
//                          1.0.2\Projects\zstack\ZLL\SampleApp\CC253x\..\..\ /
//                          ..\..\..\Components\mac\low_level\srf04\" -I      /
//                          "D:\Texas Instruments\Z-Stack Lighting            /
//                          1.0.2\Projects\zstack\ZLL\SampleApp\CC253x\..\..\ /
//                          ..\..\..\Components\mac\low_level\srf04\single_ch /
//                          ip\" -I "D:\Texas Instruments\Z-Stack Lighting    /
//                          1.0.2\Projects\zstack\ZLL\SampleApp\CC253x\..\..\ /
//                          ..\..\..\Components\mt\" -I "D:\Texas             /
//                          Instruments\Z-Stack Lighting                      /
//                          1.0.2\Projects\zstack\ZLL\SampleApp\CC253x\..\..\ /
//                          ..\..\..\Components\osal\include\" -I "D:\Texas   /
//                          Instruments\Z-Stack Lighting                      /
//                          1.0.2\Projects\zstack\ZLL\SampleApp\CC253x\..\..\ /
//                          ..\..\..\Components\services\saddr\" -I           /
//                          "D:\Texas Instruments\Z-Stack Lighting            /
//                          1.0.2\Projects\zstack\ZLL\SampleApp\CC253x\..\..\ /
//                          ..\..\..\Components\services\sdata\" -I           /
//                          "D:\Texas Instruments\Z-Stack Lighting            /
//                          1.0.2\Projects\zstack\ZLL\SampleApp\CC253x\..\..\ /
//                          ..\..\..\Components\stack\af\" -I "D:\Texas       /
//                          Instruments\Z-Stack Lighting                      /
//                          1.0.2\Projects\zstack\ZLL\SampleApp\CC253x\..\..\ /
//                          ..\..\..\Components\stack\nwk\" -I "D:\Texas      /
//                          Instruments\Z-Stack Lighting                      /
//                          1.0.2\Projects\zstack\ZLL\SampleApp\CC253x\..\..\ /
//                          ..\..\..\Components\stack\sapi\" -I "D:\Texas     /
//                          Instruments\Z-Stack Lighting                      /
//                          1.0.2\Projects\zstack\ZLL\SampleApp\CC253x\..\..\ /
//                          ..\..\..\Components\stack\sec\" -I "D:\Texas      /
//                          Instruments\Z-Stack Lighting                      /
//                          1.0.2\Projects\zstack\ZLL\SampleApp\CC253x\..\..\ /
//                          ..\..\..\Components\stack\sys\" -I "D:\Texas      /
//                          Instruments\Z-Stack Lighting                      /
//                          1.0.2\Projects\zstack\ZLL\SampleApp\CC253x\..\..\ /
//                          ..\..\..\Components\stack\zcl\" -I "D:\Texas      /
//                          Instruments\Z-Stack Lighting                      /
//                          1.0.2\Projects\zstack\ZLL\SampleApp\CC253x\..\..\ /
//                          ..\..\..\Components\stack\zdo\" -I "D:\Texas      /
//                          Instruments\Z-Stack Lighting                      /
//                          1.0.2\Projects\zstack\ZLL\SampleApp\CC253x\..\..\ /
//                          ..\..\..\Components\zmac\" -I "D:\Texas           /
//                          Instruments\Z-Stack Lighting                      /
//                          1.0.2\Projects\zstack\ZLL\SampleApp\CC253x\..\..\ /
//                          ..\..\..\Components\zmac\f8w\" -Ohz               /
//                          --require_prototypes                              /
//    List file          =  D:\Texas Instruments\Z-Stack Lighting             /
//                          1.0.2\Projects\zstack\ZLL\SampleApp\CC253x\Bridge /
//                          EB-Pro\List\ZDSecMgr.s51                          /
//                                                                            /
//                                                                            /
///////////////////////////////////////////////////////////////////////////////

        NAME ZDSecMgr

        RTMODEL "__SystemLibrary", "CLib"
        RTMODEL "__calling_convention", "xdata_reentrant"
        RTMODEL "__code_model", "banked"
        RTMODEL "__core", "plain"
        RTMODEL "__data_model", "large"
        RTMODEL "__dptr_size", "16"
        RTMODEL "__extended_stack", "disabled"
        RTMODEL "__location_for_constants", "data"
        RTMODEL "__number_of_dptrs", "1"
        RTMODEL "__rt_version", "1"

        RSEG DOVERLAY:DATA:NOROOT(0)
        RSEG IOVERLAY:IDATA:NOROOT(0)
        RSEG ISTACK:IDATA:NOROOT(0)
        RSEG PSTACK:XDATA:NOROOT(0)
        RSEG XSTACK:XDATA:NOROOT(0)

        EXTERN ?ALLOC_XSTACK8
        EXTERN ?BANKED_ENTER_XDATA
        EXTERN ?BANKED_LEAVE_XDATA
        EXTERN ?BDISPATCH
        EXTERN ?BRET
        EXTERN ?DEALLOC_XSTACK8
        EXTERN ?L_ADD_TO_X
        EXTERN ?L_ADD_X
        EXTERN ?L_MOV_TO_X
        EXTERN ?L_MOV_X
        EXTERN ?MOVE_LONG8_XDATA_XDATA
        EXTERN ?PUSH_XSTACK_I_THREE
        EXTERN ?PUSH_XSTACK_I_TWO
        EXTERN ?UL_DIV_MOD
        EXTERN ?UL_GE_X
        EXTERN ?V0
        EXTERN ?XLOAD_R2345
        EXTERN ?XSP
        EXTERN ?XSTACK_DISP0_8
        EXTERN ?XSTORE_R2345
        EXTERN __INIT_XDATA_I
        EXTERN __INIT_XDATA_Z

        PUBLIC ??APSME_IsDefaultTCLK?relay
        FUNCTION ??APSME_IsDefaultTCLK?relay,0203H
        PUBLIC ??APSME_IsLinkKeyValid?relay
        FUNCTION ??APSME_IsLinkKeyValid?relay,0203H
        PUBLIC ??APSME_KeyFwdToChild?relay
        FUNCTION ??APSME_KeyFwdToChild?relay,0203H
        PUBLIC ??APSME_LinkKeyNVIdGet?relay
        FUNCTION ??APSME_LinkKeyNVIdGet?relay,0203H
        PUBLIC ??APSME_LinkKeySet?relay
        FUNCTION ??APSME_LinkKeySet?relay,0203H
        PUBLIC ??APSME_TCLinkKeyInit?relay
        FUNCTION ??APSME_TCLinkKeyInit?relay,0203H
        PUBLIC ??APSME_TCLinkKeyLoad?relay
        FUNCTION ??APSME_TCLinkKeyLoad?relay,0203H
        PUBLIC ??APSME_TCLinkKeySync?relay
        FUNCTION ??APSME_TCLinkKeySync?relay,0203H
        PUBLIC ??ZDSecMgrAPSRemove?relay
        FUNCTION ??ZDSecMgrAPSRemove?relay,0203H
        PUBLIC ??ZDSecMgrAddLinkKey?relay
        FUNCTION ??ZDSecMgrAddLinkKey?relay,0203H
        PUBLIC ??ZDSecMgrAddrClear?relay
        FUNCTION ??ZDSecMgrAddrClear?relay,0203H
        PUBLIC ??ZDSecMgrAddrStore?relay
        FUNCTION ??ZDSecMgrAddrStore?relay,0203H
        PUBLIC ??ZDSecMgrAppKeyGet?relay
        FUNCTION ??ZDSecMgrAppKeyGet?relay,0203H
        PUBLIC ??ZDSecMgrAppKeyReq?relay
        FUNCTION ??ZDSecMgrAppKeyReq?relay,0203H
        PUBLIC ??ZDSecMgrApsLinkKeyInit?relay
        FUNCTION ??ZDSecMgrApsLinkKeyInit?relay,0203H
        PUBLIC ??ZDSecMgrAssocDeviceAuth?relay
        FUNCTION ??ZDSecMgrAssocDeviceAuth?relay,0203H
        PUBLIC ??ZDSecMgrAuthNwkKey?relay
        FUNCTION ??ZDSecMgrAuthNwkKey?relay,0203H
        PUBLIC ??ZDSecMgrAuthenticationCheck?relay
        FUNCTION ??ZDSecMgrAuthenticationCheck?relay,0203H
        PUBLIC ??ZDSecMgrAuthenticationSet?relay
        FUNCTION ??ZDSecMgrAuthenticationSet?relay,0203H
        PUBLIC ??ZDSecMgrClearNVKeyValues?relay
        FUNCTION ??ZDSecMgrClearNVKeyValues?relay,0203H
        PUBLIC ??ZDSecMgrConfig?relay
        FUNCTION ??ZDSecMgrConfig?relay,0203H
        PUBLIC ??ZDSecMgrDeviceJoin?relay
        FUNCTION ??ZDSecMgrDeviceJoin?relay,0203H
        PUBLIC ??ZDSecMgrDeviceJoinDirect?relay
        FUNCTION ??ZDSecMgrDeviceJoinDirect?relay,0203H
        PUBLIC ??ZDSecMgrDeviceJoinFwd?relay
        FUNCTION ??ZDSecMgrDeviceJoinFwd?relay,0203H
        PUBLIC ??ZDSecMgrDeviceNew?relay
        FUNCTION ??ZDSecMgrDeviceNew?relay,0203H
        PUBLIC ??ZDSecMgrDeviceRemove?relay
        FUNCTION ??ZDSecMgrDeviceRemove?relay,0203H
        PUBLIC ??ZDSecMgrDeviceRemoveByExtAddr?relay
        FUNCTION ??ZDSecMgrDeviceRemoveByExtAddr?relay,0203H
        PUBLIC ??ZDSecMgrDeviceValidate?relay
        FUNCTION ??ZDSecMgrDeviceValidate?relay,0203H
        PUBLIC ??ZDSecMgrDeviceValidateRM?relay
        FUNCTION ??ZDSecMgrDeviceValidateRM?relay,0203H
        PUBLIC ??ZDSecMgrEntryFree?relay
        FUNCTION ??ZDSecMgrEntryFree?relay,0203H
        PUBLIC ??ZDSecMgrEntryInit?relay
        FUNCTION ??ZDSecMgrEntryInit?relay,0203H
        PUBLIC ??ZDSecMgrEntryLookup?relay
        FUNCTION ??ZDSecMgrEntryLookup?relay,0203H
        PUBLIC ??ZDSecMgrEntryLookupAMI?relay
        FUNCTION ??ZDSecMgrEntryLookupAMI?relay,0203H
        PUBLIC ??ZDSecMgrEntryLookupAMIGetIndex?relay
        FUNCTION ??ZDSecMgrEntryLookupAMIGetIndex?relay,0203H
        PUBLIC ??ZDSecMgrEntryLookupExt?relay
        FUNCTION ??ZDSecMgrEntryLookupExt?relay,0203H
        PUBLIC ??ZDSecMgrEntryLookupExtGetIndex?relay
        FUNCTION ??ZDSecMgrEntryLookupExtGetIndex?relay,0203H
        PUBLIC ??ZDSecMgrEntryNew?relay
        FUNCTION ??ZDSecMgrEntryNew?relay,0203H
        PUBLIC ??ZDSecMgrExtAddrLookup?relay
        FUNCTION ??ZDSecMgrExtAddrLookup?relay,0203H
        PUBLIC ??ZDSecMgrExtAddrStore?relay
        FUNCTION ??ZDSecMgrExtAddrStore?relay,0203H
        PUBLIC ??ZDSecMgrInit?relay
        FUNCTION ??ZDSecMgrInit?relay,0203H
        PUBLIC ??ZDSecMgrInitNV?relay
        FUNCTION ??ZDSecMgrInitNV?relay,0203H
        PUBLIC ??ZDSecMgrInitNVKeyTables?relay
        FUNCTION ??ZDSecMgrInitNVKeyTables?relay,0203H
        PUBLIC ??ZDSecMgrNewDeviceEvent?relay
        FUNCTION ??ZDSecMgrNewDeviceEvent?relay,0203H
        PUBLIC ??ZDSecMgrNwkKeyInit?relay
        FUNCTION ??ZDSecMgrNwkKeyInit?relay,0203H
        PUBLIC ??ZDSecMgrPermitJoining?relay
        FUNCTION ??ZDSecMgrPermitJoining?relay,0203H
        PUBLIC ??ZDSecMgrPermitJoiningTimeout?relay
        FUNCTION ??ZDSecMgrPermitJoiningTimeout?relay,0203H
        PUBLIC ??ZDSecMgrReadKeyFromNv?relay
        FUNCTION ??ZDSecMgrReadKeyFromNv?relay,0203H
        PUBLIC ??ZDSecMgrRemoveDeviceInd?relay
        FUNCTION ??ZDSecMgrRemoveDeviceInd?relay,0203H
        PUBLIC ??ZDSecMgrRequestAppKey?relay
        FUNCTION ??ZDSecMgrRequestAppKey?relay,0203H
        PUBLIC ??ZDSecMgrRequestKeyInd?relay
        FUNCTION ??ZDSecMgrRequestKeyInd?relay,0203H
        FUNCTION ??ZDSecMgrRestoreFromNV?relay,0203H
        PUBLIC ??ZDSecMgrSaveApsLinkKey?relay
        FUNCTION ??ZDSecMgrSaveApsLinkKey?relay,0203H
        PUBLIC ??ZDSecMgrSaveTCLinkKey?relay
        FUNCTION ??ZDSecMgrSaveTCLinkKey?relay,0203H
        PUBLIC ??ZDSecMgrSendNwkKey?relay
        FUNCTION ??ZDSecMgrSendNwkKey?relay,0203H
        PUBLIC ??ZDSecMgrSetDefaultNV?relay
        FUNCTION ??ZDSecMgrSetDefaultNV?relay,0203H
        PUBLIC ??ZDSecMgrSetupPartner?relay
        FUNCTION ??ZDSecMgrSetupPartner?relay,0203H
        PUBLIC ??ZDSecMgrSwitchKeyInd?relay
        FUNCTION ??ZDSecMgrSwitchKeyInd?relay,0203H
        PUBLIC ??ZDSecMgrTCDataLoad?relay
        FUNCTION ??ZDSecMgrTCDataLoad?relay,0203H
        PUBLIC ??ZDSecMgrTCExtAddrCheck?relay
        FUNCTION ??ZDSecMgrTCExtAddrCheck?relay,0203H
        PUBLIC ??ZDSecMgrTransportKeyInd?relay
        FUNCTION ??ZDSecMgrTransportKeyInd?relay,0203H
        PUBLIC ??ZDSecMgrUpdateDeviceInd?relay
        FUNCTION ??ZDSecMgrUpdateDeviceInd?relay,0203H
        PUBLIC ??ZDSecMgrUpdateTCAddress?relay
        FUNCTION ??ZDSecMgrUpdateTCAddress?relay,0203H
        FUNCTION ??ZDSecMgrWriteNV?relay,0203H
        PUBLIC APSME_IsDefaultTCLK
        FUNCTION APSME_IsDefaultTCLK,021203H
        ARGFRAME XSTACK, 65, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME ISTACK, 2, STACK
        PUBLIC APSME_IsLinkKeyValid
        FUNCTION APSME_IsLinkKeyValid,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 37, STACK
        PUBLIC APSME_KeyFwdToChild
        FUNCTION APSME_KeyFwdToChild,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME ISTACK, 2, STACK
        PUBLIC APSME_LinkKeyNVIdGet
        FUNCTION APSME_LinkKeyNVIdGet,021203H
        ARGFRAME XSTACK, 33, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 11, STACK
        PUBLIC APSME_LinkKeySet
        FUNCTION APSME_LinkKeySet,021203H
        ARGFRAME XSTACK, 34, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 23, STACK
        PUBLIC APSME_TCLinkKeyInit
        FUNCTION APSME_TCLinkKeyInit,021203H
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 52, STACK
        PUBLIC APSME_TCLinkKeyLoad
        FUNCTION APSME_TCLinkKeyLoad,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 69, STACK
        PUBLIC APSME_TCLinkKeySync
        FUNCTION APSME_TCLinkKeySync,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 54, STACK
        PUBLIC ApsLinkKeyFrmCntr
        PUBLIC TCLinkKeyFrmCntr
        PUBLIC TrustCenterLinkKey
        PUBLIC ZDSecMgrAPSRemove
        FUNCTION ZDSecMgrAPSRemove,021203H
        ARGFRAME XSTACK, 2, STACK
        LOCFRAME ISTACK, 2, STACK
        LOCFRAME XSTACK, 8, STACK
        PUBLIC ZDSecMgrAddLinkKey
        FUNCTION ZDSecMgrAddLinkKey,021203H
        ARGFRAME XSTACK, 2, STACK
        LOCFRAME XSTACK, 18, STACK
        PUBLIC ZDSecMgrAddrClear
        FUNCTION ZDSecMgrAddrClear,021203H
        ARGFRAME XSTACK, 33, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 24, STACK
        PUBLIC ZDSecMgrAddrStore
        FUNCTION ZDSecMgrAddrStore,021203H
        ARGFRAME XSTACK, 36, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 22, STACK
        PUBLIC ZDSecMgrAppKeyGet
        FUNCTION ZDSecMgrAppKeyGet,021203H
        ARGFRAME XSTACK, 8, STACK
        LOCFRAME ISTACK, 1, STACK
        LOCFRAME XSTACK, 9, STACK
        PUBLIC ZDSecMgrAppKeyReq
        FUNCTION ZDSecMgrAppKeyReq,021203H
        ARGFRAME XSTACK, 0, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME ISTACK, 1, STACK
        LOCFRAME XSTACK, 49, STACK
        PUBLIC ZDSecMgrAppKeyType
        PUBLIC ZDSecMgrApsLinkKeyInit
        FUNCTION ZDSecMgrApsLinkKeyInit,021203H
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 36, STACK
        PUBLIC ZDSecMgrAssocDeviceAuth
        FUNCTION ZDSecMgrAssocDeviceAuth,0203H
        ARGFRAME XSTACK, 33, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME ISTACK, 2, STACK
        PUBLIC ZDSecMgrAuthNwkKey
        FUNCTION ZDSecMgrAuthNwkKey,021203H
        ARGFRAME XSTACK, 34, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME ISTACK, 2, STACK
        PUBLIC ZDSecMgrAuthenticationCheck
        FUNCTION ZDSecMgrAuthenticationCheck,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 21, STACK
        PUBLIC ZDSecMgrAuthenticationSet
        FUNCTION ZDSecMgrAuthenticationSet,021203H
        ARGFRAME XSTACK, 16, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME ISTACK, 1, STACK
        LOCFRAME XSTACK, 11, STACK
        PUBLIC ZDSecMgrClearNVKeyValues
        FUNCTION ZDSecMgrClearNVKeyValues,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 52, STACK
        PUBLIC ZDSecMgrConfig
        FUNCTION ZDSecMgrConfig,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME ISTACK, 2, STACK
        PUBLIC ZDSecMgrDeviceJoin
        FUNCTION ZDSecMgrDeviceJoin,021203H
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 17, STACK
        PUBLIC ZDSecMgrDeviceJoinDirect
        FUNCTION ZDSecMgrDeviceJoinDirect,021203H
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 9, STACK
        PUBLIC ZDSecMgrDeviceJoinFwd
        FUNCTION ZDSecMgrDeviceJoinFwd,021203H
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME ISTACK, 2, STACK
        LOCFRAME XSTACK, 8, STACK
        PUBLIC ZDSecMgrDeviceNew
        FUNCTION ZDSecMgrDeviceNew,021203H
        ARGFRAME XSTACK, 33, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 9, STACK
        PUBLIC ZDSecMgrDeviceRemove
        FUNCTION ZDSecMgrDeviceRemove,021203H
        ARGFRAME XSTACK, 17, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 20, STACK
        PUBLIC ZDSecMgrDeviceRemoveByExtAddr
        FUNCTION ZDSecMgrDeviceRemoveByExtAddr,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 11, STACK
        PUBLIC ZDSecMgrDeviceValidate
        FUNCTION ZDSecMgrDeviceValidate,021203H
        ARGFRAME XSTACK, 15, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME ISTACK, 2, STACK
        PUBLIC ZDSecMgrDeviceValidateRM
        FUNCTION ZDSecMgrDeviceValidateRM,0203H
        ARGFRAME XSTACK, 0, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME ISTACK, 2, STACK
        PUBLIC ZDSecMgrEntries
        PUBLIC ZDSecMgrEntryFree
        FUNCTION ZDSecMgrEntryFree,021203H
        ARGFRAME XSTACK, 11, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 24, STACK
        PUBLIC ZDSecMgrEntryInit
        FUNCTION ZDSecMgrEntryInit,021203H
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 9, STACK
        PUBLIC ZDSecMgrEntryLookup
        FUNCTION ZDSecMgrEntryLookup,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 22, STACK
        PUBLIC ZDSecMgrEntryLookupAMI
        FUNCTION ZDSecMgrEntryLookupAMI,0203H
        ARGFRAME XSTACK, 34, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 9, STACK
        PUBLIC ZDSecMgrEntryLookupAMIGetIndex
        FUNCTION ZDSecMgrEntryLookupAMIGetIndex,0203H
        ARGFRAME XSTACK, 20, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 9, STACK
        PUBLIC ZDSecMgrEntryLookupExt
        FUNCTION ZDSecMgrEntryLookupExt,021203H
        ARGFRAME XSTACK, 21, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 11, STACK
        PUBLIC ZDSecMgrEntryLookupExtGetIndex
        FUNCTION ZDSecMgrEntryLookupExtGetIndex,021203H
        ARGFRAME XSTACK, 21, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 12, STACK
        PUBLIC ZDSecMgrEntryNew
        FUNCTION ZDSecMgrEntryNew,0203H
        ARGFRAME XSTACK, 34, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 9, STACK
        PUBLIC ZDSecMgrExtAddrLookup
        FUNCTION ZDSecMgrExtAddrLookup,021203H
        ARGFRAME XSTACK, 34, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 22, STACK
        PUBLIC ZDSecMgrExtAddrStore
        FUNCTION ZDSecMgrExtAddrStore,021203H
        ARGFRAME XSTACK, 2, STACK
        LOCFRAME XSTACK, 22, STACK
        PUBLIC ZDSecMgrInit
        FUNCTION ZDSecMgrInit,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        PUBLIC ZDSecMgrInitNV
        FUNCTION ZDSecMgrInitNV,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 16, STACK
        PUBLIC ZDSecMgrInitNVKeyTables
        FUNCTION ZDSecMgrInitNVKeyTables,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        PUBLIC ZDSecMgrNewDeviceEvent
        FUNCTION ZDSecMgrNewDeviceEvent,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME ISTACK, 1, STACK
        LOCFRAME XSTACK, 33, STACK
        PUBLIC ZDSecMgrNwkKeyInit
        FUNCTION ZDSecMgrNwkKeyInit,021203H
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 52, STACK
        PUBLIC ZDSecMgrPermitJoining
        FUNCTION ZDSecMgrPermitJoining,0203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME ISTACK, 2, STACK
        PUBLIC ZDSecMgrPermitJoiningEnabled
        PUBLIC ZDSecMgrPermitJoiningTimed
        PUBLIC ZDSecMgrPermitJoiningTimeout
        FUNCTION ZDSecMgrPermitJoiningTimeout,0203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME ISTACK, 2, STACK
        PUBLIC ZDSecMgrReadKeyFromNv
        FUNCTION ZDSecMgrReadKeyFromNv,021203H
        ARGFRAME XSTACK, 34, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 14, STACK
        PUBLIC ZDSecMgrRemoveDeviceInd
        FUNCTION ZDSecMgrRemoveDeviceInd,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 17, STACK
        PUBLIC ZDSecMgrRequestAppKey
        FUNCTION ZDSecMgrRequestAppKey,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME ISTACK, 2, STACK
        LOCFRAME XSTACK, 4, STACK
        PUBLIC ZDSecMgrRequestKeyInd
        FUNCTION ZDSecMgrRequestKeyInd,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME ISTACK, 2, STACK
        FUNCTION ZDSecMgrRestoreFromNV,021203H
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 24, STACK
        PUBLIC ZDSecMgrSaveApsLinkKey
        FUNCTION ZDSecMgrSaveApsLinkKey,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 22, STACK
        PUBLIC ZDSecMgrSaveTCLinkKey
        FUNCTION ZDSecMgrSaveTCLinkKey,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 22, STACK
        PUBLIC ZDSecMgrSendNwkKey
        FUNCTION ZDSecMgrSendNwkKey,021203H
        ARGFRAME XSTACK, 15, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME ISTACK, 1, STACK
        LOCFRAME XSTACK, 50, STACK
        PUBLIC ZDSecMgrSetDefaultNV
        FUNCTION ZDSecMgrSetDefaultNV,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 23, STACK
        PUBLIC ZDSecMgrSetupPartner
        FUNCTION ZDSecMgrSetupPartner,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 24, STACK
        PUBLIC ZDSecMgrSwitchKeyInd
        FUNCTION ZDSecMgrSwitchKeyInd,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME ISTACK, 2, STACK
        PUBLIC ZDSecMgrTCAuthenticated
        PUBLIC ZDSecMgrTCDataLoad
        FUNCTION ZDSecMgrTCDataLoad,021203H
        ARGFRAME XSTACK, 34, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 27, STACK
        PUBLIC ZDSecMgrTCExtAddr
        PUBLIC ZDSecMgrTCExtAddrCheck
        FUNCTION ZDSecMgrTCExtAddrCheck,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 17, STACK
        PUBLIC ZDSecMgrTransportKeyInd
        FUNCTION ZDSecMgrTransportKeyInd,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 36, STACK
        PUBLIC ZDSecMgrUpdateDeviceInd
        FUNCTION ZDSecMgrUpdateDeviceInd,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME ISTACK, 2, STACK
        LOCFRAME XSTACK, 8, STACK
        PUBLIC ZDSecMgrUpdateTCAddress
        FUNCTION ZDSecMgrUpdateTCAddress,021203H
        ARGFRAME XSTACK, 34, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME ISTACK, 2, STACK
        LOCFRAME XSTACK, 22, STACK
        FUNCTION ZDSecMgrWriteNV,021203H
        ARGFRAME XSTACK, 34, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 18, STACK
        PUBWEAK __Constant_1
        PUBWEAK __Constant_3e9
        PUBWEAK __Constant_a
        PUBWEAK __Constant_b
        
          CFI Names cfiNames0
          CFI StackFrame CFA_SP SP IDATA
          CFI StackFrame CFA_PSP16 PSP16 XDATA
          CFI StackFrame CFA_XSP16 XSP16 XDATA
          CFI StaticOverlayFrame CFA_IOVERLAY IOVERLAY
          CFI StaticOverlayFrame CFA_DOVERLAY DOVERLAY
          CFI Resource `PSW.CY`:1, `B.BR0`:1, `B.BR1`:1, `B.BR2`:1, `B.BR3`:1
          CFI Resource `B.BR4`:1, `B.BR5`:1, `B.BR6`:1, `B.BR7`:1, `VB.BR8`:1
          CFI Resource `VB.BR9`:1, `VB.BR10`:1, `VB.BR11`:1, `VB.BR12`:1
          CFI Resource `VB.BR13`:1, `VB.BR14`:1, `VB.BR15`:1, VB:8, B:8, A:8
          CFI Resource PSW:8, DPL0:8, DPH0:8, R0:8, R1:8, R2:8, R3:8, R4:8, R5:8
          CFI Resource R6:8, R7:8, V0:8, V1:8, V2:8, V3:8, V4:8, V5:8, V6:8, V7:8
          CFI Resource V8:8, V9:8, V10:8, V11:8, V12:8, V13:8, V14:8, V15:8, SP:8
          CFI Resource PSPH:8, PSPL:8, PSP16:16, XSPH:8, XSPL:8, XSP16:16
          CFI VirtualResource ?RET:24
          CFI Resource ?BRET_EXT:8
          CFI VirtualResource ?RET_HIGH:8, ?RET_LOW:8
          CFI ResourceParts PSP16 PSPH, PSPL
          CFI ResourceParts XSP16 XSPH, XSPL
          CFI ResourceParts ?RET ?BRET_EXT, ?RET_HIGH, ?RET_LOW
          CFI EndNames cfiNames0
        
          CFI Common cfiCommon0 Using cfiNames0
          CFI CodeAlign 1
          CFI DataAlign -1
          CFI ReturnAddress ?RET CODE
          CFI CFA_DOVERLAY Used
          CFI CFA_IOVERLAY Used
          CFI CFA_SP SP+-3
          CFI CFA_PSP16 PSP16+0
          CFI CFA_XSP16 XSP16+0
          CFI `PSW.CY` SameValue
          CFI `B.BR0` SameValue
          CFI `B.BR1` SameValue
          CFI `B.BR2` SameValue
          CFI `B.BR3` SameValue
          CFI `B.BR4` SameValue
          CFI `B.BR5` SameValue
          CFI `B.BR6` SameValue
          CFI `B.BR7` SameValue
          CFI `VB.BR8` SameValue
          CFI `VB.BR9` SameValue
          CFI `VB.BR10` SameValue
          CFI `VB.BR11` SameValue
          CFI `VB.BR12` SameValue
          CFI `VB.BR13` SameValue
          CFI `VB.BR14` SameValue
          CFI `VB.BR15` SameValue
          CFI VB SameValue
          CFI B Undefined
          CFI A Undefined
          CFI PSW SameValue
          CFI DPL0 SameValue
          CFI DPH0 SameValue
          CFI R0 Undefined
          CFI R1 Undefined
          CFI R2 Undefined
          CFI R3 Undefined
          CFI R4 Undefined
          CFI R5 Undefined
          CFI R6 SameValue
          CFI R7 SameValue
          CFI V0 SameValue
          CFI V1 SameValue
          CFI V2 SameValue
          CFI V3 SameValue
          CFI V4 SameValue
          CFI V5 SameValue
          CFI V6 SameValue
          CFI V7 SameValue
          CFI V8 SameValue
          CFI V9 SameValue
          CFI V10 SameValue
          CFI V11 SameValue
          CFI V12 SameValue
          CFI V13 SameValue
          CFI V14 SameValue
          CFI V15 SameValue
          CFI PSPH Undefined
          CFI PSPL Undefined
          CFI XSPH Undefined
          CFI XSPL Undefined
          CFI ?RET Concat
          CFI ?BRET_EXT Frame(CFA_SP, 3)
          CFI ?RET_HIGH Frame(CFA_SP, 2)
          CFI ?RET_LOW Frame(CFA_SP, 1)
          CFI EndCommon cfiCommon0
        
        
          CFI Common cfiCommon1 Using cfiNames0
          CFI CodeAlign 1
          CFI DataAlign -1
          CFI ReturnAddress ?RET CODE
          CFI CFA_DOVERLAY Used
          CFI CFA_IOVERLAY Used
          CFI CFA_SP SP+-2
          CFI CFA_PSP16 PSP16+0
          CFI CFA_XSP16 XSP16+0
          CFI `PSW.CY` SameValue
          CFI `B.BR0` SameValue
          CFI `B.BR1` SameValue
          CFI `B.BR2` SameValue
          CFI `B.BR3` SameValue
          CFI `B.BR4` SameValue
          CFI `B.BR5` SameValue
          CFI `B.BR6` SameValue
          CFI `B.BR7` SameValue
          CFI `VB.BR8` SameValue
          CFI `VB.BR9` SameValue
          CFI `VB.BR10` SameValue
          CFI `VB.BR11` SameValue
          CFI `VB.BR12` SameValue
          CFI `VB.BR13` SameValue
          CFI `VB.BR14` SameValue
          CFI `VB.BR15` SameValue
          CFI VB SameValue
          CFI B SameValue
          CFI A SameValue
          CFI PSW SameValue
          CFI DPL0 SameValue
          CFI DPH0 SameValue
          CFI R0 SameValue
          CFI R1 SameValue
          CFI R2 SameValue
          CFI R3 SameValue
          CFI R4 SameValue
          CFI R5 SameValue
          CFI R6 SameValue
          CFI R7 SameValue
          CFI V0 SameValue
          CFI V1 SameValue
          CFI V2 SameValue
          CFI V3 SameValue
          CFI V4 SameValue
          CFI V5 SameValue
          CFI V6 SameValue
          CFI V7 SameValue
          CFI V8 SameValue
          CFI V9 SameValue
          CFI V10 SameValue
          CFI V11 SameValue
          CFI V12 SameValue
          CFI V13 SameValue
          CFI V14 SameValue
          CFI V15 SameValue
          CFI PSPH Undefined
          CFI PSPL Undefined
          CFI XSPH Undefined
          CFI XSPL Undefined
          CFI ?RET Concat
          CFI ?BRET_EXT SameValue
          CFI ?RET_HIGH Frame(CFA_SP, 2)
          CFI ?RET_LOW Frame(CFA_SP, 1)
          CFI EndCommon cfiCommon1
        
APSME_GetRequest    SYMBOL "APSME_GetRequest"
??APSME_GetRequest?relay SYMBOL "?relay", APSME_GetRequest
APSME_IsDistributedSecurity SYMBOL "APSME_IsDistributedSecurity"
??APSME_IsDistributedSecurity?relay SYMBOL "?relay", APSME_IsDistributedSecurity
APSME_LookupExtAddr SYMBOL "APSME_LookupExtAddr"
??APSME_LookupExtAddr?relay SYMBOL "?relay", APSME_LookupExtAddr
APSME_LookupNwkAddr SYMBOL "APSME_LookupNwkAddr"
??APSME_LookupNwkAddr?relay SYMBOL "?relay", APSME_LookupNwkAddr
APSME_RemoveDeviceReq SYMBOL "APSME_RemoveDeviceReq"
??APSME_RemoveDeviceReq?relay SYMBOL "?relay", APSME_RemoveDeviceReq
APSME_RequestKeyReq SYMBOL "APSME_RequestKeyReq"
??APSME_RequestKeyReq?relay SYMBOL "?relay", APSME_RequestKeyReq
APSME_SecurityCM_RD SYMBOL "APSME_SecurityCM_RD"
??APSME_SecurityCM_RD?relay SYMBOL "?relay", APSME_SecurityCM_RD
APSME_SetRequest    SYMBOL "APSME_SetRequest"
??APSME_SetRequest?relay SYMBOL "?relay", APSME_SetRequest
APSME_TransportKeyReq SYMBOL "APSME_TransportKeyReq"
??APSME_TransportKeyReq?relay SYMBOL "?relay", APSME_TransportKeyReq
APSME_UpdateDeviceReq SYMBOL "APSME_UpdateDeviceReq"
??APSME_UpdateDeviceReq?relay SYMBOL "?relay", APSME_UpdateDeviceReq
AddrMgrEntryGet     SYMBOL "AddrMgrEntryGet"
??AddrMgrEntryGet?relay SYMBOL "?relay", AddrMgrEntryGet
AddrMgrEntryLookupExt SYMBOL "AddrMgrEntryLookupExt"
??AddrMgrEntryLookupExt?relay SYMBOL "?relay", AddrMgrEntryLookupExt
AddrMgrEntryLookupNwk SYMBOL "AddrMgrEntryLookupNwk"
??AddrMgrEntryLookupNwk?relay SYMBOL "?relay", AddrMgrEntryLookupNwk
AddrMgrEntryRelease SYMBOL "AddrMgrEntryRelease"
??AddrMgrEntryRelease?relay SYMBOL "?relay", AddrMgrEntryRelease
AddrMgrEntryUpdate  SYMBOL "AddrMgrEntryUpdate"
??AddrMgrEntryUpdate?relay SYMBOL "?relay", AddrMgrEntryUpdate
AddrMgrExtAddrEqual SYMBOL "AddrMgrExtAddrEqual"
??AddrMgrExtAddrEqual?relay SYMBOL "?relay", AddrMgrExtAddrEqual
AddrMgrExtAddrLookup SYMBOL "AddrMgrExtAddrLookup"
??AddrMgrExtAddrLookup?relay SYMBOL "?relay", AddrMgrExtAddrLookup
AddrMgrExtAddrSet   SYMBOL "AddrMgrExtAddrSet"
??AddrMgrExtAddrSet?relay SYMBOL "?relay", AddrMgrExtAddrSet
AddrMgrExtAddrValid SYMBOL "AddrMgrExtAddrValid"
??AddrMgrExtAddrValid?relay SYMBOL "?relay", AddrMgrExtAddrValid
AssocGetWithExt     SYMBOL "AssocGetWithExt"
??AssocGetWithExt?relay SYMBOL "?relay", AssocGetWithExt
AssocGetWithShort   SYMBOL "AssocGetWithShort"
??AssocGetWithShort?relay SYMBOL "?relay", AssocGetWithShort
AssocRemove         SYMBOL "AssocRemove"
??AssocRemove?relay SYMBOL "?relay", AssocRemove
NLME_GetExtAddr     SYMBOL "NLME_GetExtAddr"
??NLME_GetExtAddr?relay SYMBOL "?relay", NLME_GetExtAddr
NLME_GetShortAddr   SYMBOL "NLME_GetShortAddr"
??NLME_GetShortAddr?relay SYMBOL "?relay", NLME_GetShortAddr
NLME_LeaveReq       SYMBOL "NLME_LeaveReq"
??NLME_LeaveReq?relay SYMBOL "?relay", NLME_LeaveReq
NLME_ReadNwkKeyInfo SYMBOL "NLME_ReadNwkKeyInfo"
??NLME_ReadNwkKeyInfo?relay SYMBOL "?relay", NLME_ReadNwkKeyInfo
SSP_GetTrueRand     SYMBOL "SSP_GetTrueRand"
??SSP_GetTrueRand?relay SYMBOL "?relay", SSP_GetTrueRand
SSP_Init            SYMBOL "SSP_Init"
??SSP_Init?relay    SYMBOL "?relay", SSP_Init
SSP_SwitchNwkKey    SYMBOL "SSP_SwitchNwkKey"
??SSP_SwitchNwkKey?relay SYMBOL "?relay", SSP_SwitchNwkKey
SSP_UpdateNwkKey    SYMBOL "SSP_UpdateNwkKey"
??SSP_UpdateNwkKey?relay SYMBOL "?relay", SSP_UpdateNwkKey
ZDApp_NVUpdate      SYMBOL "ZDApp_NVUpdate"
??ZDApp_NVUpdate?relay SYMBOL "?relay", ZDApp_NVUpdate
ZDP_IEEEAddrReq     SYMBOL "ZDP_IEEEAddrReq"
??ZDP_IEEEAddrReq?relay SYMBOL "?relay", ZDP_IEEEAddrReq
ZDP_NwkAddrReq      SYMBOL "ZDP_NwkAddrReq"
??ZDP_NwkAddrReq?relay SYMBOL "?relay", ZDP_NwkAddrReq
osal_isbufset       SYMBOL "osal_isbufset"
??osal_isbufset?relay SYMBOL "?relay", osal_isbufset
osal_mem_alloc      SYMBOL "osal_mem_alloc"
??osal_mem_alloc?relay SYMBOL "?relay", osal_mem_alloc
osal_mem_free       SYMBOL "osal_mem_free"
??osal_mem_free?relay SYMBOL "?relay", osal_mem_free
osal_memcmp         SYMBOL "osal_memcmp"
??osal_memcmp?relay SYMBOL "?relay", osal_memcmp
osal_memcpy         SYMBOL "osal_memcpy"
??osal_memcpy?relay SYMBOL "?relay", osal_memcpy
osal_memset         SYMBOL "osal_memset"
??osal_memset?relay SYMBOL "?relay", osal_memset
osal_nv_item_init   SYMBOL "osal_nv_item_init"
??osal_nv_item_init?relay SYMBOL "?relay", osal_nv_item_init
osal_nv_read        SYMBOL "osal_nv_read"
??osal_nv_read?relay SYMBOL "?relay", osal_nv_read
osal_nv_write       SYMBOL "osal_nv_write"
??osal_nv_write?relay SYMBOL "?relay", osal_nv_write
osal_set_event      SYMBOL "osal_set_event"
??osal_set_event?relay SYMBOL "?relay", osal_set_event
sAddrExtCmp         SYMBOL "sAddrExtCmp"
??sAddrExtCmp?relay SYMBOL "?relay", sAddrExtCmp
sAddrExtCpy         SYMBOL "sAddrExtCpy"
??sAddrExtCpy?relay SYMBOL "?relay", sAddrExtCpy
APSME_IsDefaultTCLK SYMBOL "APSME_IsDefaultTCLK"
??APSME_IsDefaultTCLK?relay SYMBOL "?relay", APSME_IsDefaultTCLK
APSME_IsLinkKeyValid SYMBOL "APSME_IsLinkKeyValid"
??APSME_IsLinkKeyValid?relay SYMBOL "?relay", APSME_IsLinkKeyValid
APSME_KeyFwdToChild SYMBOL "APSME_KeyFwdToChild"
??APSME_KeyFwdToChild?relay SYMBOL "?relay", APSME_KeyFwdToChild
APSME_LinkKeyNVIdGet SYMBOL "APSME_LinkKeyNVIdGet"
??APSME_LinkKeyNVIdGet?relay SYMBOL "?relay", APSME_LinkKeyNVIdGet
APSME_LinkKeySet    SYMBOL "APSME_LinkKeySet"
??APSME_LinkKeySet?relay SYMBOL "?relay", APSME_LinkKeySet
APSME_TCLinkKeyInit SYMBOL "APSME_TCLinkKeyInit"
??APSME_TCLinkKeyInit?relay SYMBOL "?relay", APSME_TCLinkKeyInit
APSME_TCLinkKeyLoad SYMBOL "APSME_TCLinkKeyLoad"
??APSME_TCLinkKeyLoad?relay SYMBOL "?relay", APSME_TCLinkKeyLoad
APSME_TCLinkKeySync SYMBOL "APSME_TCLinkKeySync"
??APSME_TCLinkKeySync?relay SYMBOL "?relay", APSME_TCLinkKeySync
ZDSecMgrAPSRemove   SYMBOL "ZDSecMgrAPSRemove"
??ZDSecMgrAPSRemove?relay SYMBOL "?relay", ZDSecMgrAPSRemove
ZDSecMgrAddLinkKey  SYMBOL "ZDSecMgrAddLinkKey"
??ZDSecMgrAddLinkKey?relay SYMBOL "?relay", ZDSecMgrAddLinkKey
ZDSecMgrAddrClear   SYMBOL "ZDSecMgrAddrClear"
??ZDSecMgrAddrClear?relay SYMBOL "?relay", ZDSecMgrAddrClear
ZDSecMgrAddrStore   SYMBOL "ZDSecMgrAddrStore"
??ZDSecMgrAddrStore?relay SYMBOL "?relay", ZDSecMgrAddrStore
ZDSecMgrAppKeyGet   SYMBOL "ZDSecMgrAppKeyGet"
??ZDSecMgrAppKeyGet?relay SYMBOL "?relay", ZDSecMgrAppKeyGet
ZDSecMgrAppKeyReq   SYMBOL "ZDSecMgrAppKeyReq"
??ZDSecMgrAppKeyReq?relay SYMBOL "?relay", ZDSecMgrAppKeyReq
ZDSecMgrApsLinkKeyInit SYMBOL "ZDSecMgrApsLinkKeyInit"
??ZDSecMgrApsLinkKeyInit?relay SYMBOL "?relay", ZDSecMgrApsLinkKeyInit
ZDSecMgrAssocDeviceAuth SYMBOL "ZDSecMgrAssocDeviceAuth"
??ZDSecMgrAssocDeviceAuth?relay SYMBOL "?relay", ZDSecMgrAssocDeviceAuth
ZDSecMgrAuthNwkKey  SYMBOL "ZDSecMgrAuthNwkKey"
??ZDSecMgrAuthNwkKey?relay SYMBOL "?relay", ZDSecMgrAuthNwkKey
ZDSecMgrAuthenticationCheck SYMBOL "ZDSecMgrAuthenticationCheck"
??ZDSecMgrAuthenticationCheck?relay SYMBOL "?relay", ZDSecMgrAuthenticationCheck
ZDSecMgrAuthenticationSet SYMBOL "ZDSecMgrAuthenticationSet"
??ZDSecMgrAuthenticationSet?relay SYMBOL "?relay", ZDSecMgrAuthenticationSet
ZDSecMgrClearNVKeyValues SYMBOL "ZDSecMgrClearNVKeyValues"
??ZDSecMgrClearNVKeyValues?relay SYMBOL "?relay", ZDSecMgrClearNVKeyValues
ZDSecMgrConfig      SYMBOL "ZDSecMgrConfig"
??ZDSecMgrConfig?relay SYMBOL "?relay", ZDSecMgrConfig
ZDSecMgrDeviceJoin  SYMBOL "ZDSecMgrDeviceJoin"
??ZDSecMgrDeviceJoin?relay SYMBOL "?relay", ZDSecMgrDeviceJoin
ZDSecMgrDeviceJoinDirect SYMBOL "ZDSecMgrDeviceJoinDirect"
??ZDSecMgrDeviceJoinDirect?relay SYMBOL "?relay", ZDSecMgrDeviceJoinDirect
ZDSecMgrDeviceJoinFwd SYMBOL "ZDSecMgrDeviceJoinFwd"
??ZDSecMgrDeviceJoinFwd?relay SYMBOL "?relay", ZDSecMgrDeviceJoinFwd
ZDSecMgrDeviceNew   SYMBOL "ZDSecMgrDeviceNew"
??ZDSecMgrDeviceNew?relay SYMBOL "?relay", ZDSecMgrDeviceNew
ZDSecMgrDeviceRemove SYMBOL "ZDSecMgrDeviceRemove"
??ZDSecMgrDeviceRemove?relay SYMBOL "?relay", ZDSecMgrDeviceRemove
ZDSecMgrDeviceRemoveByExtAddr SYMBOL "ZDSecMgrDeviceRemoveByExtAddr"
??ZDSecMgrDeviceRemoveByExtAddr?relay SYMBOL "?relay", ZDSecMgrDeviceRemoveByExtAddr
ZDSecMgrDeviceValidate SYMBOL "ZDSecMgrDeviceValidate"
??ZDSecMgrDeviceValidate?relay SYMBOL "?relay", ZDSecMgrDeviceValidate
ZDSecMgrDeviceValidateRM SYMBOL "ZDSecMgrDeviceValidateRM"
??ZDSecMgrDeviceValidateRM?relay SYMBOL "?relay", ZDSecMgrDeviceValidateRM
ZDSecMgrEntryFree   SYMBOL "ZDSecMgrEntryFree"
??ZDSecMgrEntryFree?relay SYMBOL "?relay", ZDSecMgrEntryFree
ZDSecMgrEntryInit   SYMBOL "ZDSecMgrEntryInit"
??ZDSecMgrEntryInit?relay SYMBOL "?relay", ZDSecMgrEntryInit
ZDSecMgrEntryLookup SYMBOL "ZDSecMgrEntryLookup"
??ZDSecMgrEntryLookup?relay SYMBOL "?relay", ZDSecMgrEntryLookup
ZDSecMgrEntryLookupAMI SYMBOL "ZDSecMgrEntryLookupAMI"
??ZDSecMgrEntryLookupAMI?relay SYMBOL "?relay", ZDSecMgrEntryLookupAMI
ZDSecMgrEntryLookupAMIGetIndex SYMBOL "ZDSecMgrEntryLookupAMIGetIndex"
??ZDSecMgrEntryLookupAMIGetIndex?relay SYMBOL "?relay", ZDSecMgrEntryLookupAMIGetIndex
ZDSecMgrEntryLookupExt SYMBOL "ZDSecMgrEntryLookupExt"
??ZDSecMgrEntryLookupExt?relay SYMBOL "?relay", ZDSecMgrEntryLookupExt
ZDSecMgrEntryLookupExtGetIndex SYMBOL "ZDSecMgrEntryLookupExtGetIndex"
??ZDSecMgrEntryLookupExtGetIndex?relay SYMBOL "?relay", ZDSecMgrEntryLookupExtGetIndex
ZDSecMgrEntryNew    SYMBOL "ZDSecMgrEntryNew"
??ZDSecMgrEntryNew?relay SYMBOL "?relay", ZDSecMgrEntryNew
ZDSecMgrExtAddrLookup SYMBOL "ZDSecMgrExtAddrLookup"
??ZDSecMgrExtAddrLookup?relay SYMBOL "?relay", ZDSecMgrExtAddrLookup
ZDSecMgrExtAddrStore SYMBOL "ZDSecMgrExtAddrStore"
??ZDSecMgrExtAddrStore?relay SYMBOL "?relay", ZDSecMgrExtAddrStore
ZDSecMgrInit        SYMBOL "ZDSecMgrInit"
??ZDSecMgrInit?relay SYMBOL "?relay", ZDSecMgrInit
ZDSecMgrInitNV      SYMBOL "ZDSecMgrInitNV"
??ZDSecMgrInitNV?relay SYMBOL "?relay", ZDSecMgrInitNV
ZDSecMgrInitNVKeyTables SYMBOL "ZDSecMgrInitNVKeyTables"
??ZDSecMgrInitNVKeyTables?relay SYMBOL "?relay", ZDSecMgrInitNVKeyTables
ZDSecMgrNewDeviceEvent SYMBOL "ZDSecMgrNewDeviceEvent"
??ZDSecMgrNewDeviceEvent?relay SYMBOL "?relay", ZDSecMgrNewDeviceEvent
ZDSecMgrNwkKeyInit  SYMBOL "ZDSecMgrNwkKeyInit"
??ZDSecMgrNwkKeyInit?relay SYMBOL "?relay", ZDSecMgrNwkKeyInit
ZDSecMgrPermitJoining SYMBOL "ZDSecMgrPermitJoining"
??ZDSecMgrPermitJoining?relay SYMBOL "?relay", ZDSecMgrPermitJoining
ZDSecMgrPermitJoiningTimeout SYMBOL "ZDSecMgrPermitJoiningTimeout"
??ZDSecMgrPermitJoiningTimeout?relay SYMBOL "?relay", ZDSecMgrPermitJoiningTimeout
ZDSecMgrReadKeyFromNv SYMBOL "ZDSecMgrReadKeyFromNv"
??ZDSecMgrReadKeyFromNv?relay SYMBOL "?relay", ZDSecMgrReadKeyFromNv
ZDSecMgrRemoveDeviceInd SYMBOL "ZDSecMgrRemoveDeviceInd"
??ZDSecMgrRemoveDeviceInd?relay SYMBOL "?relay", ZDSecMgrRemoveDeviceInd
ZDSecMgrRequestAppKey SYMBOL "ZDSecMgrRequestAppKey"
??ZDSecMgrRequestAppKey?relay SYMBOL "?relay", ZDSecMgrRequestAppKey
ZDSecMgrRequestKeyInd SYMBOL "ZDSecMgrRequestKeyInd"
??ZDSecMgrRequestKeyInd?relay SYMBOL "?relay", ZDSecMgrRequestKeyInd
ZDSecMgrSaveApsLinkKey SYMBOL "ZDSecMgrSaveApsLinkKey"
??ZDSecMgrSaveApsLinkKey?relay SYMBOL "?relay", ZDSecMgrSaveApsLinkKey
ZDSecMgrSaveTCLinkKey SYMBOL "ZDSecMgrSaveTCLinkKey"
??ZDSecMgrSaveTCLinkKey?relay SYMBOL "?relay", ZDSecMgrSaveTCLinkKey
ZDSecMgrSendNwkKey  SYMBOL "ZDSecMgrSendNwkKey"
??ZDSecMgrSendNwkKey?relay SYMBOL "?relay", ZDSecMgrSendNwkKey
ZDSecMgrSetDefaultNV SYMBOL "ZDSecMgrSetDefaultNV"
??ZDSecMgrSetDefaultNV?relay SYMBOL "?relay", ZDSecMgrSetDefaultNV
ZDSecMgrSetupPartner SYMBOL "ZDSecMgrSetupPartner"
??ZDSecMgrSetupPartner?relay SYMBOL "?relay", ZDSecMgrSetupPartner
ZDSecMgrSwitchKeyInd SYMBOL "ZDSecMgrSwitchKeyInd"
??ZDSecMgrSwitchKeyInd?relay SYMBOL "?relay", ZDSecMgrSwitchKeyInd
ZDSecMgrTCDataLoad  SYMBOL "ZDSecMgrTCDataLoad"
??ZDSecMgrTCDataLoad?relay SYMBOL "?relay", ZDSecMgrTCDataLoad
ZDSecMgrTCExtAddrCheck SYMBOL "ZDSecMgrTCExtAddrCheck"
??ZDSecMgrTCExtAddrCheck?relay SYMBOL "?relay", ZDSecMgrTCExtAddrCheck
ZDSecMgrTransportKeyInd SYMBOL "ZDSecMgrTransportKeyInd"
??ZDSecMgrTransportKeyInd?relay SYMBOL "?relay", ZDSecMgrTransportKeyInd
ZDSecMgrUpdateDeviceInd SYMBOL "ZDSecMgrUpdateDeviceInd"
??ZDSecMgrUpdateDeviceInd?relay SYMBOL "?relay", ZDSecMgrUpdateDeviceInd
ZDSecMgrUpdateTCAddress SYMBOL "ZDSecMgrUpdateTCAddress"
??ZDSecMgrUpdateTCAddress?relay SYMBOL "?relay", ZDSecMgrUpdateTCAddress

        EXTERN ??APSME_GetRequest?relay
        FUNCTION ??APSME_GetRequest?relay,00H
        EXTERN ??APSME_IsDistributedSecurity?relay
        FUNCTION ??APSME_IsDistributedSecurity?relay,00H
        EXTERN ??APSME_LookupExtAddr?relay
        FUNCTION ??APSME_LookupExtAddr?relay,00H
        EXTERN ??APSME_LookupNwkAddr?relay
        FUNCTION ??APSME_LookupNwkAddr?relay,00H
        EXTERN ??APSME_RemoveDeviceReq?relay
        FUNCTION ??APSME_RemoveDeviceReq?relay,00H
        EXTERN ??APSME_RequestKeyReq?relay
        FUNCTION ??APSME_RequestKeyReq?relay,00H
        EXTERN ??APSME_SecurityCM_RD?relay
        FUNCTION ??APSME_SecurityCM_RD?relay,00H
        EXTERN ??APSME_SetRequest?relay
        FUNCTION ??APSME_SetRequest?relay,00H
        EXTERN ??APSME_TransportKeyReq?relay
        FUNCTION ??APSME_TransportKeyReq?relay,00H
        EXTERN ??APSME_UpdateDeviceReq?relay
        FUNCTION ??APSME_UpdateDeviceReq?relay,00H
        EXTERN ??AddrMgrEntryGet?relay
        FUNCTION ??AddrMgrEntryGet?relay,00H
        EXTERN ??AddrMgrEntryLookupExt?relay
        FUNCTION ??AddrMgrEntryLookupExt?relay,00H
        EXTERN ??AddrMgrEntryLookupNwk?relay
        FUNCTION ??AddrMgrEntryLookupNwk?relay,00H
        EXTERN ??AddrMgrEntryRelease?relay
        FUNCTION ??AddrMgrEntryRelease?relay,00H
        EXTERN ??AddrMgrEntryUpdate?relay
        FUNCTION ??AddrMgrEntryUpdate?relay,00H
        EXTERN ??AddrMgrExtAddrEqual?relay
        FUNCTION ??AddrMgrExtAddrEqual?relay,00H
        EXTERN ??AddrMgrExtAddrLookup?relay
        FUNCTION ??AddrMgrExtAddrLookup?relay,00H
        EXTERN ??AddrMgrExtAddrSet?relay
        FUNCTION ??AddrMgrExtAddrSet?relay,00H
        EXTERN ??AddrMgrExtAddrValid?relay
        FUNCTION ??AddrMgrExtAddrValid?relay,00H
        EXTERN ??AssocGetWithExt?relay
        FUNCTION ??AssocGetWithExt?relay,00H
        EXTERN ??AssocGetWithShort?relay
        FUNCTION ??AssocGetWithShort?relay,00H
        EXTERN ??AssocRemove?relay
        FUNCTION ??AssocRemove?relay,00H
        EXTERN ??NLME_GetExtAddr?relay
        FUNCTION ??NLME_GetExtAddr?relay,00H
        EXTERN ??NLME_GetShortAddr?relay
        FUNCTION ??NLME_GetShortAddr?relay,00H
        EXTERN ??NLME_LeaveReq?relay
        FUNCTION ??NLME_LeaveReq?relay,00H
        EXTERN ??NLME_ReadNwkKeyInfo?relay
        FUNCTION ??NLME_ReadNwkKeyInfo?relay,00H
        EXTERN ??SSP_GetTrueRand?relay
        FUNCTION ??SSP_GetTrueRand?relay,00H
        EXTERN ??SSP_Init?relay
        FUNCTION ??SSP_Init?relay,00H
        EXTERN ??SSP_SwitchNwkKey?relay
        FUNCTION ??SSP_SwitchNwkKey?relay,00H
        EXTERN ??SSP_UpdateNwkKey?relay
        FUNCTION ??SSP_UpdateNwkKey?relay,00H
        EXTERN ??ZDApp_NVUpdate?relay
        FUNCTION ??ZDApp_NVUpdate?relay,00H
        EXTERN ??ZDP_IEEEAddrReq?relay
        FUNCTION ??ZDP_IEEEAddrReq?relay,00H
        EXTERN ??ZDP_NwkAddrReq?relay
        FUNCTION ??ZDP_NwkAddrReq?relay,00H
        EXTERN ??osal_isbufset?relay
        FUNCTION ??osal_isbufset?relay,00H
        EXTERN ??osal_mem_alloc?relay
        FUNCTION ??osal_mem_alloc?relay,00H
        EXTERN ??osal_mem_free?relay
        FUNCTION ??osal_mem_free?relay,00H
        EXTERN ??osal_memcmp?relay
        FUNCTION ??osal_memcmp?relay,00H
        EXTERN ??osal_memcpy?relay
        FUNCTION ??osal_memcpy?relay,00H
        EXTERN ??osal_memset?relay
        FUNCTION ??osal_memset?relay,00H
        EXTERN ??osal_nv_item_init?relay
        FUNCTION ??osal_nv_item_init?relay,00H
        EXTERN ??osal_nv_read?relay
        FUNCTION ??osal_nv_read?relay,00H
        EXTERN ??osal_nv_write?relay
        FUNCTION ??osal_nv_write?relay,00H
        EXTERN ??osal_set_event?relay
        FUNCTION ??osal_set_event?relay,00H
        EXTERN ??sAddrExtCmp?relay
        FUNCTION ??sAddrExtCmp?relay,00H
        EXTERN ??sAddrExtCpy?relay
        FUNCTION ??sAddrExtCpy?relay,00H
        EXTERN APSME_GetRequest
        FUNCTION APSME_GetRequest,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 21, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN APSME_IsDistributedSecurity
        FUNCTION APSME_IsDistributedSecurity,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 65, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN APSME_LookupExtAddr
        FUNCTION APSME_LookupExtAddr,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 50, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN APSME_LookupNwkAddr
        FUNCTION APSME_LookupNwkAddr,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 49, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN APSME_RemoveDeviceReq
        FUNCTION APSME_RemoveDeviceReq,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 20, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN APSME_RequestKeyReq
        FUNCTION APSME_RequestKeyReq,0202H
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 4, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN APSME_SecurityCM_RD
        FUNCTION APSME_SecurityCM_RD,0202H
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN APSME_SetRequest
        FUNCTION APSME_SetRequest,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 18, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN APSME_TransportKeyReq
        FUNCTION APSME_TransportKeyReq,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 49, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN APSME_UpdateDeviceReq
        FUNCTION APSME_UpdateDeviceReq,0202H
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 8, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN AddrMgrEntryGet
        FUNCTION AddrMgrEntryGet,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 33, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN AddrMgrEntryLookupExt
        FUNCTION AddrMgrEntryLookupExt,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 25, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN AddrMgrEntryLookupNwk
        FUNCTION AddrMgrEntryLookupNwk,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 65, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN AddrMgrEntryRelease
        FUNCTION AddrMgrEntryRelease,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 65, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN AddrMgrEntryUpdate
        FUNCTION AddrMgrEntryUpdate,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 24, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN AddrMgrExtAddrEqual
        FUNCTION AddrMgrExtAddrEqual,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 65, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN AddrMgrExtAddrLookup
        FUNCTION AddrMgrExtAddrLookup,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 21, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN AddrMgrExtAddrSet
        FUNCTION AddrMgrExtAddrSet,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 24, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN AddrMgrExtAddrValid
        FUNCTION AddrMgrExtAddrValid,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 65, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN AssocGetWithExt
        FUNCTION AssocGetWithExt,0202H
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 20, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN AssocGetWithShort
        FUNCTION AssocGetWithShort,0202H
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 33, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN AssocRemove
        FUNCTION AssocRemove,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 33, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN NLME_GetExtAddr
        FUNCTION NLME_GetExtAddr,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 21, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN NLME_GetShortAddr
        FUNCTION NLME_GetShortAddr,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 46, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN NLME_LeaveReq
        FUNCTION NLME_LeaveReq,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 20, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN NLME_ReadNwkKeyInfo
        FUNCTION NLME_ReadNwkKeyInfo,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 50, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN SSP_GetTrueRand
        FUNCTION SSP_GetTrueRand,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 49, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN SSP_Init
        FUNCTION SSP_Init,0202H
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN SSP_SwitchNwkKey
        FUNCTION SSP_SwitchNwkKey,0202H
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 34, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN SSP_UpdateNwkKey
        FUNCTION SSP_UpdateNwkKey,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 34, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN ZDAppTaskID
        EXTERN ZDApp_NVUpdate
        FUNCTION ZDApp_NVUpdate,0202H
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 0, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN ZDP_IEEEAddrReq
        FUNCTION ZDP_IEEEAddrReq,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 24, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN ZDP_NwkAddrReq
        FUNCTION ZDP_NwkAddrReq,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 34, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN _NIB
        EXTERN defaultTCLinkKey
        EXTERN devState
        EXTERN osal_isbufset
        FUNCTION osal_isbufset,0202H
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 34, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN osal_mem_alloc
        FUNCTION osal_mem_alloc,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 33, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN osal_mem_free
        FUNCTION osal_mem_free,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 33, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN osal_memcmp
        FUNCTION osal_memcmp,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 36, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN osal_memcpy
        FUNCTION osal_memcpy,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 51, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN osal_memset
        FUNCTION osal_memset,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 65, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN osal_nv_item_init
        FUNCTION osal_nv_item_init,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 50, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN osal_nv_read
        FUNCTION osal_nv_read,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 69, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN osal_nv_write
        FUNCTION osal_nv_write,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 52, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN osal_set_event
        FUNCTION osal_set_event,0202H
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 65, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN sAddrExtCmp
        FUNCTION sAddrExtCmp,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 50, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN sAddrExtCpy
        FUNCTION sAddrExtCpy,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 25, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN zgApsLinkKeyType
        EXTERN zgApsTrustCenterAddr
        EXTERN zgPreConfigKeys
        EXTERN zgSecurePermitJoin
        EXTERN zgUseDefaultTCLK

// D:\Texas Instruments\Z-Stack Lighting 1.0.2\Components\stack\zdo\ZDSecMgr.c
//    1 /******************************************************************************
//    2   Filename:       ZDSecMgr.c
//    3   Revised:        $Date: 2013-10-11 17:01:59 -0700 (Fri, 11 Oct 2013) $
//    4   Revision:       $Revision: 35655 $
//    5 
//    6   Description:    The ZigBee Device Security Manager.
//    7 
//    8 
//    9   Copyright 2005-2013 Texas Instruments Incorporated. All rights reserved.
//   10 
//   11   IMPORTANT: Your use of this Software is limited to those specific rights
//   12   granted under the terms of a software license agreement between the user
//   13   who downloaded the software, his/her employer (which must be your employer)
//   14   and Texas Instruments Incorporated (the "License"). You may not use this
//   15   Software unless you agree to abide by the terms of the License. The License
//   16   limits your use, and you acknowledge, that the Software may not be modified,
//   17   copied or distributed unless embedded on a Texas Instruments microcontroller
//   18   or used solely and exclusively in conjunction with a Texas Instruments radio
//   19   frequency transceiver, which is integrated into your product. Other than for
//   20   the foregoing purpose, you may not use, reproduce, copy, prepare derivative
//   21   works of, modify, distribute, perform, display or sell this Software and/or
//   22   its documentation for any purpose.
//   23 
//   24   YOU FURTHER ACKNOWLEDGE AND AGREE THAT THE SOFTWARE AND DOCUMENTATION ARE
//   25   PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED,
//   26   INCLUDING WITHOUT LIMITATION, ANY WARRANTY OF MERCHANTABILITY, TITLE,
//   27   NON-INFRINGEMENT AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL
//   28   TEXAS INSTRUMENTS OR ITS LICENSORS BE LIABLE OR OBLIGATED UNDER CONTRACT,
//   29   NEGLIGENCE, STRICT LIABILITY, CONTRIBUTION, BREACH OF WARRANTY, OR OTHER
//   30   LEGAL EQUITABLE THEORY ANY DIRECT OR INDIRECT DAMAGES OR EXPENSES
//   31   INCLUDING BUT NOT LIMITED TO ANY INCIDENTAL, SPECIAL, INDIRECT, PUNITIVE
//   32   OR CONSEQUENTIAL DAMAGES, LOST PROFITS OR LOST DATA, COST OF PROCUREMENT
//   33   OF SUBSTITUTE GOODS, TECHNOLOGY, SERVICES, OR ANY CLAIMS BY THIRD PARTIES
//   34   (INCLUDING BUT NOT LIMITED TO ANY DEFENSE THEREOF), OR OTHER SIMILAR COSTS.
//   35 
//   36   Should you have any questions regarding your right to use this Software,
//   37   contact Texas Instruments Incorporated at www.TI.com.
//   38 ******************************************************************************/
//   39 
//   40 #ifdef __cplusplus
//   41 extern "C"
//   42 {
//   43 #endif
//   44 
//   45 /******************************************************************************
//   46  * INCLUDES
//   47  */
//   48 #include "ZComDef.h"
//   49 #include "OSAL.h"
//   50 #include "OSAL_Nv.h"
//   51 #include "ZGlobals.h"
//   52 #include "ssp.h"
//   53 #include "nwk_globals.h"
//   54 #include "nwk.h"
//   55 #include "NLMEDE.h"
//   56 #include "AddrMgr.h"
//   57 #include "AssocList.h"
//   58 #include "APSMEDE.h"
//   59 #include "ZDConfig.h"
//   60 #include "ZDSecMgr.h"
//   61 
//   62 /******************************************************************************
//   63  * CONSTANTS
//   64  */
//   65 // maximum number of devices managed by this Security Manager
//   66 #if !defined ( ZDSECMGR_DEVICE_MAX )
//   67   #define ZDSECMGR_DEVICE_MAX 3
//   68 #endif
//   69 
//   70 // maximum number of LINK keys this device may store
//   71 #define ZDSECMGR_ENTRY_MAX ZDSECMGR_DEVICE_MAX
//   72 
//   73 // total number of stored devices
//   74 #if !defined ( ZDSECMGR_STORED_DEVICES )
//   75   #define ZDSECMGR_STORED_DEVICES 3
//   76 #endif
//   77 
//   78 // Total number of preconfigured trust center link key
//   79 #if !defined ( ZDSECMGR_TC_DEVICE_MAX )
//   80   #define ZDSECMGR_TC_DEVICE_MAX 1
//   81 #endif
//   82 
//   83 #if ( ZDSECMGR_TC_DEVICE_MAX < 1 ) || ( ZDSECMGR_TC_DEVICE_MAX > 255 )
//   84   #error "ZDSECMGR_TC_DEVICE_MAX shall be between 1 and 255 !"
//   85 #endif
//   86 
//   87 // APSME Stub Implementations
//   88 #define ZDSecMgrLinkKeySet     APSME_LinkKeySet
//   89 #define ZDSecMgrLinkKeyNVIdGet APSME_LinkKeyNVIdGet
//   90 #define ZDSecMgrKeyFwdToChild  APSME_KeyFwdToChild
//   91 #define ZDSecMgrIsLinkKeyValid APSME_IsLinkKeyValid
//   92 
//   93 /******************************************************************************
//   94  * TYPEDEFS
//   95  */
//   96 typedef struct
//   97 {
//   98   uint16            ami;
//   99   uint16            keyNvId;   // index to the Link Key table in NV
//  100   ZDSecMgr_Authentication_Option authenticateOption;
//  101 } ZDSecMgrEntry_t;
//  102 
//  103 typedef struct
//  104 {
//  105   uint16          nwkAddr;
//  106   uint8*          extAddr;
//  107   uint16          parentAddr;
//  108   uint8           secure;
//  109   uint8           devStatus;
//  110 } ZDSecMgrDevice_t;
//  111 
//  112 /******************************************************************************
//  113  * LOCAL VARIABLES
//  114  */
//  115 #if 0 // Taken out because the following functionality is only used for test
//  116       // purpose. A more efficient (above) way is used. It can be put
//  117       // back in if customers request for a white/black list feature.
//  118 uint8 ZDSecMgrStoredDeviceList[ZDSECMGR_STORED_DEVICES][Z_EXTADDR_LEN] =
//  119 {
//  120   { 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 },
//  121   { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01 },
//  122   { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 },
//  123 };
//  124 #endif
//  125 

        RSEG XDATA_Z:XDATA:NOROOT(0)
        DATA8
//  126 uint8 ZDSecMgrTCExtAddr[Z_EXTADDR_LEN]=
ZDSecMgrTCExtAddr:
        DS 8
        REQUIRE __INIT_XDATA_Z
//  127   { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 };
//  128 

        RSEG XDATA_Z:XDATA:NOROOT(0)
        DATA8
//  129 uint8 ZDSecMgrTCAuthenticated = FALSE;
ZDSecMgrTCAuthenticated:
        DS 1
        REQUIRE __INIT_XDATA_Z
//  130 

        RSEG XDATA_Z:XDATA:NOROOT(0)
        DATA16
//  131 ZDSecMgrEntry_t* ZDSecMgrEntries  = NULL;
ZDSecMgrEntries:
        DS 2
        REQUIRE __INIT_XDATA_Z
//  132 
//  133 void ZDSecMgrAddrMgrCB( uint8 update, AddrMgrEntry_t* newEntry, AddrMgrEntry_t* oldEntry );
//  134 

        RSEG XDATA_Z:XDATA:NOROOT(0)
        DATA8
//  135 uint8 ZDSecMgrPermitJoiningEnabled;
ZDSecMgrPermitJoiningEnabled:
        DS 1
        REQUIRE __INIT_XDATA_Z

        RSEG XDATA_Z:XDATA:NOROOT(0)
        DATA8
//  136 uint8 ZDSecMgrPermitJoiningTimed;
ZDSecMgrPermitJoiningTimed:
        DS 1
        REQUIRE __INIT_XDATA_Z
//  137 

        RSEG XDATA_Z:XDATA:NOROOT(0)
        DATA8
//  138 APSME_TCLinkKey_t TrustCenterLinkKey;
TrustCenterLinkKey:
        DS 32
        REQUIRE __INIT_XDATA_Z
//  139 

        RSEG XDATA_Z:XDATA:NOROOT(0)
        DATA8
//  140 APSME_ApsLinkKeyFrmCntr_t ApsLinkKeyFrmCntr[ZDSECMGR_ENTRY_MAX];
ApsLinkKeyFrmCntr:
        DS 27
        REQUIRE __INIT_XDATA_Z

        RSEG XDATA_Z:XDATA:NOROOT(0)
        DATA8
//  141 APSME_TCLinkKeyFrmCntr_t TCLinkKeyFrmCntr[ZDSECMGR_TC_DEVICE_MAX];
TCLinkKeyFrmCntr:
        DS 18
        REQUIRE __INIT_XDATA_Z
//  142 
//  143 /******************************************************************************
//  144  * PRIVATE FUNCTIONS
//  145  *
//  146  *   ZDSecMgrAddrStore
//  147  *   ZDSecMgrExtAddrStore
//  148  *   ZDSecMgrExtAddrLookup
//  149  *   ZDSecMgrEntryInit
//  150  *   ZDSecMgrEntryLookup
//  151  *   ZDSecMgrEntryLookupAMI
//  152  *   ZDSecMgrEntryLookupExt
//  153  *   ZDSecMgrEntryLookupExtGetIndex
//  154  *   ZDSecMgrEntryFree
//  155  *   ZDSecMgrEntryNew
//  156  *   ZDSecMgrAppKeyGet
//  157  *   ZDSecMgrAppKeyReq
//  158  *   ZDSecMgrSendNwkKey
//  159  *   ZDSecMgrDeviceRemove
//  160  *   ZDSecMgrDeviceValidateRM
//  161  *   ZDSecMgrDeviceValidate
//  162  *   ZDSecMgrDeviceJoin
//  163  *   ZDSecMgrDeviceJoinDirect
//  164  *   ZDSecMgrDeviceJoinFwd
//  165  *   ZDSecMgrDeviceNew
//  166  *   ZDSecMgrAssocDeviceAuth
//  167  *   ZDSecMgrAuthNwkKey
//  168  *   APSME_TCLinkKeyInit
//  169  *   APSME_IsDefaultTCLK
//  170  */
//  171 
//  172 //-----------------------------------------------------------------------------
//  173 // address management
//  174 //-----------------------------------------------------------------------------
//  175 ZStatus_t ZDSecMgrAddrStore( uint16 nwkAddr, uint8* extAddr, uint16* ami );
//  176 ZStatus_t ZDSecMgrExtAddrStore( uint16 nwkAddr, uint8* extAddr, uint16* ami );
//  177 ZStatus_t ZDSecMgrExtAddrLookup( uint8* extAddr, uint16* ami );
//  178 
//  179 //-----------------------------------------------------------------------------
//  180 // Trust Center management
//  181 //-----------------------------------------------------------------------------
//  182 uint8 ZDSecMgrTCExtAddrCheck( uint8* extAddr );
//  183 void ZDSecMgrTCDataLoad( uint8* extAddr );
//  184 
//  185 //-----------------------------------------------------------------------------
//  186 // entry data
//  187 //-----------------------------------------------------------------------------
//  188 void ZDSecMgrEntryInit(uint8 state);
//  189 ZStatus_t ZDSecMgrEntryLookup( uint16 nwkAddr, ZDSecMgrEntry_t** entry );
//  190 ZStatus_t ZDSecMgrEntryLookupAMI( uint16 ami, ZDSecMgrEntry_t** entry );
//  191 ZStatus_t ZDSecMgrEntryLookupExt( uint8* extAddr, ZDSecMgrEntry_t** entry );
//  192 ZStatus_t ZDSecMgrEntryLookupExtGetIndex( uint8* extAddr, ZDSecMgrEntry_t** entry, uint16* entryIndex );
//  193 ZStatus_t ZDSecMgrEntryLookupAMIGetIndex( uint16 ami, uint16* entryIndex );
//  194 void ZDSecMgrEntryFree( ZDSecMgrEntry_t* entry );
//  195 ZStatus_t ZDSecMgrEntryNew( ZDSecMgrEntry_t** entry );
//  196 ZStatus_t ZDSecMgrAuthenticationSet( uint8* extAddr, ZDSecMgr_Authentication_Option option );
//  197 void ZDSecMgrApsLinkKeyInit(void);
//  198 #if defined ( NV_RESTORE )
//  199 static void ZDSecMgrWriteNV(void);
//  200 static void ZDSecMgrRestoreFromNV(void);
//  201 static void ZDSecMgrUpdateNV( uint16 index );
//  202 #endif
//  203 
//  204 //-----------------------------------------------------------------------------
//  205 // key support
//  206 //-----------------------------------------------------------------------------
//  207 ZStatus_t ZDSecMgrAppKeyGet( uint16  initNwkAddr,
//  208                              uint8*  initExtAddr,
//  209                              uint16  partNwkAddr,
//  210                              uint8*  partExtAddr,
//  211                              uint8** key,
//  212                              uint8*  keyType );
//  213 void ZDSecMgrAppKeyReq( ZDO_RequestKeyInd_t* ind );
//  214 ZStatus_t ZDSecMgrSendNwkKey( ZDSecMgrDevice_t* device );
//  215 void ZDSecMgrNwkKeyInit(uint8 setDefault);
//  216 
//  217 //-----------------------------------------------------------------------------
//  218 // device management
//  219 //-----------------------------------------------------------------------------
//  220 void ZDSecMgrDeviceRemove( ZDSecMgrDevice_t* device );
//  221 ZStatus_t ZDSecMgrDeviceValidateRM( ZDSecMgrDevice_t* device );
//  222 ZStatus_t ZDSecMgrDeviceValidate( ZDSecMgrDevice_t* device );
//  223 ZStatus_t ZDSecMgrDeviceJoin( ZDSecMgrDevice_t* device );
//  224 ZStatus_t ZDSecMgrDeviceJoinDirect( ZDSecMgrDevice_t* device );
//  225 ZStatus_t ZDSecMgrDeviceJoinFwd( ZDSecMgrDevice_t* device );
//  226 ZStatus_t ZDSecMgrDeviceNew( ZDSecMgrDevice_t* device );
//  227 
//  228 //-----------------------------------------------------------------------------
//  229 // association management
//  230 //-----------------------------------------------------------------------------
//  231 void ZDSecMgrAssocDeviceAuth( associated_devices_t* assoc );
//  232 
//  233 //-----------------------------------------------------------------------------
//  234 // authentication management
//  235 //-----------------------------------------------------------------------------
//  236 void ZDSecMgrAuthNwkKey( void );
//  237 
//  238 //-----------------------------------------------------------------------------
//  239 // APSME function
//  240 //-----------------------------------------------------------------------------
//  241 void APSME_TCLinkKeyInit( uint8 setDefault );
//  242 uint8 APSME_IsDefaultTCLK( uint8 *extAddr );
//  243 
//  244 /******************************************************************************
//  245  * @fn          ZDSecMgrAddrStore
//  246  *
//  247  * @brief       Store device addresses.
//  248  *
//  249  * @param       nwkAddr - [in] NWK address
//  250  * @param       extAddr - [in] EXT address
//  251  * @param       ami     - [out] Address Manager index
//  252  *
//  253  * @return      ZStatus_t
//  254  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  255 ZStatus_t ZDSecMgrAddrStore( uint16 nwkAddr, uint8* extAddr, uint16* ami )
ZDSecMgrAddrStore:
          CFI Block cfiBlock0 Using cfiCommon0
          CFI Function ZDSecMgrAddrStore
        CODE
//  256 {
        FUNCALL ZDSecMgrAddrStore, AddrMgrExtAddrSet
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 22, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 22, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrAddrStore, AddrMgrEntryUpdate
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 22, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 22, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x9
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 13
        MOV     A,#-0xd
        LCALL   ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 22)
//  257   ZStatus_t      status;
//  258   AddrMgrEntry_t entry;
//  259 
//  260 
//  261   // add entry
//  262   entry.user    = ADDRMGR_USER_SECURITY;
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     A,#0x2
        MOVX    @DPTR,A
//  263   entry.nwkAddr = nwkAddr;
        DEC     A
        LCALL   ?XSTACK_DISP0_8
        LCALL   ?Subroutine18 & 0xFFFF
//  264   AddrMgrExtAddrSet( entry.extAddr, extAddr );
??CrossCallReturnLabel_8:
        LCALL   ?XSTACK_DISP0_8
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??AddrMgrExtAddrSet?relay
        MOV     A,#0x16
        LCALL   ?XSTACK_DISP0_8
        LCALL   ?Subroutine24 & 0xFFFF
//  265 
//  266   if ( AddrMgrEntryUpdate( &entry ) == TRUE )
??CrossCallReturnLabel_14:
        LCALL   ??AddrMgrEntryUpdate?relay
        MOV     A,R1
        XRL     A,#0x1
        JNZ     ??ZDSecMgrAddrStore_0
//  267   {
//  268     // return successful results
//  269     *ami   = entry.index;
        MOV     A,#0xb
        LCALL   ?XSTACK_DISP0_8
        LCALL   ?Subroutine12 & 0xFFFF
//  270     status = ZSuccess;
//  271   }
??CrossCallReturnLabel_70:
        SJMP    ??CrossCallReturnLabel_11
//  272   else
//  273   {
//  274     // return failed results
//  275     *ami   = entry.index;
??ZDSecMgrAddrStore_0:
        MOV     A,#0xb
        LCALL   ?XSTACK_DISP0_8
        LCALL   ?Subroutine19 & 0xFFFF
//  276     status = ZNwkUnknownDevice;
//  277   }
//  278 
//  279   return status;
??CrossCallReturnLabel_11:
        LJMP    ?Subroutine0 & 0xFFFF
          CFI EndBlock cfiBlock0
//  280 }
//  281 
//  282 /******************************************************************************
//  283  * @fn          ZDSecMgrExtAddrStore
//  284  *
//  285  * @brief       Store EXT address.
//  286  *
//  287  * @param       extAddr - [in] EXT address
//  288  * @param       ami     - [out] Address Manager index
//  289  *
//  290  * @return      ZStatus_t
//  291  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  292 ZStatus_t ZDSecMgrExtAddrStore( uint16 nwkAddr, uint8* extAddr, uint16* ami )
ZDSecMgrExtAddrStore:
          CFI Block cfiBlock1 Using cfiCommon0
          CFI Function ZDSecMgrExtAddrStore
        CODE
//  293 {
        FUNCALL ZDSecMgrExtAddrStore, AddrMgrExtAddrSet
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 22, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 22, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrExtAddrStore, AddrMgrEntryUpdate
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 22, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 22, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x9
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 13
        MOV     A,#-0xd
        LCALL   ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 22)
//  294   ZStatus_t      status;
//  295   AddrMgrEntry_t entry;
//  296 
//  297 
//  298   // add entry
//  299   entry.user    = ADDRMGR_USER_SECURITY;
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     A,#0x2
        MOVX    @DPTR,A
//  300   entry.nwkAddr = nwkAddr;
        DEC     A
        LCALL   ?XSTACK_DISP0_8
        LCALL   ?Subroutine18 & 0xFFFF
//  301   AddrMgrExtAddrSet( entry.extAddr, extAddr );
??CrossCallReturnLabel_9:
        LCALL   ?XSTACK_DISP0_8
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??AddrMgrExtAddrSet?relay
        MOV     A,#0x16
        LCALL   ?XSTACK_DISP0_8
        LCALL   ?Subroutine24 & 0xFFFF
//  302 
//  303   if ( AddrMgrEntryUpdate( &entry ) == TRUE )
??CrossCallReturnLabel_15:
        LCALL   ??AddrMgrEntryUpdate?relay
        MOV     A,R1
        XRL     A,#0x1
        JNZ     ??ZDSecMgrExtAddrStore_0
//  304   {
//  305     // return successful results
//  306     *ami   = entry.index;
        MOV     A,#0xb
        LCALL   ?XSTACK_DISP0_8
        LCALL   ?Subroutine12 & 0xFFFF
//  307     status = ZSuccess;
//  308   }
??CrossCallReturnLabel_71:
        SJMP    ??CrossCallReturnLabel_12
//  309   else
//  310   {
//  311     // return failed results
//  312     *ami   = entry.index;
??ZDSecMgrExtAddrStore_0:
        MOV     A,#0xb
        LCALL   ?XSTACK_DISP0_8
        LCALL   ?Subroutine19 & 0xFFFF
//  313     status = ZNwkUnknownDevice;
//  314   }
//  315 
//  316   return status;
??CrossCallReturnLabel_12:
        LJMP    ?Subroutine0 & 0xFFFF
          CFI EndBlock cfiBlock1
//  317 }

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine24:
          CFI Block cfiCond2 Using cfiCommon0
          CFI Function ZDSecMgrAddrStore
          CFI Conditional ??CrossCallReturnLabel_14
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 22)
          CFI Block cfiCond3 Using cfiCommon0
          CFI (cfiCond3) Function ZDSecMgrExtAddrStore
          CFI (cfiCond3) Conditional ??CrossCallReturnLabel_15
          CFI (cfiCond3) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond3) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond3) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond3) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond3) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond3) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond3) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond3) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond3) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond3) CFA_SP SP+0
          CFI (cfiCond3) CFA_XSP16 add(XSP16, 22)
          CFI Block cfiPicker4 Using cfiCommon1
          CFI (cfiPicker4) NoFunction
          CFI (cfiPicker4) Picker
        LCALL   ?Subroutine44 & 0xFFFF
??CrossCallReturnLabel_163:
        MOV     R6,A
        MOV     A,R1
        MOV     R7,A
        ; Setup parameters for call to function AddrMgrEntryUpdate
        ; Setup parameters for call to function AddrMgrEntryUpdate
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     R2,DPL
        MOV     R3,DPH
        RET
          CFI EndBlock cfiCond2
          CFI EndBlock cfiCond3
          CFI EndBlock cfiPicker4

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine19:
          CFI Block cfiCond5 Using cfiCommon0
          CFI Function ZDSecMgrAddrStore
          CFI Conditional ??CrossCallReturnLabel_11
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 22)
          CFI Block cfiCond6 Using cfiCommon0
          CFI (cfiCond6) Function ZDSecMgrExtAddrStore
          CFI (cfiCond6) Conditional ??CrossCallReturnLabel_12
          CFI (cfiCond6) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond6) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond6) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond6) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond6) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond6) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond6) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond6) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond6) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond6) CFA_SP SP+0
          CFI (cfiCond6) CFA_XSP16 add(XSP16, 22)
          CFI Block cfiCond7 Using cfiCommon0
          CFI (cfiCond7) Function ZDSecMgrExtAddrLookup
          CFI (cfiCond7) Conditional ??CrossCallReturnLabel_13
          CFI (cfiCond7) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond7) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond7) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond7) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond7) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond7) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond7) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond7) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond7) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond7) CFA_SP SP+0
          CFI (cfiCond7) CFA_XSP16 add(XSP16, 22)
          CFI Block cfiPicker8 Using cfiCommon1
          CFI (cfiPicker8) NoFunction
          CFI (cfiPicker8) Picker
        LCALL   ?Subroutine46 & 0xFFFF
??CrossCallReturnLabel_177:
        MOV     DPL,R6
        MOV     DPH,R7
        MOV     A,R0
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R1
        MOVX    @DPTR,A
        MOV     R1,#-0x38
        RET
          CFI EndBlock cfiCond5
          CFI EndBlock cfiCond6
          CFI EndBlock cfiCond7
          CFI EndBlock cfiPicker8

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine18:
          CFI Block cfiCond9 Using cfiCommon0
          CFI Function ZDSecMgrAddrStore
          CFI Conditional ??CrossCallReturnLabel_8
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 22)
          CFI Block cfiCond10 Using cfiCommon0
          CFI (cfiCond10) Function ZDSecMgrExtAddrStore
          CFI (cfiCond10) Conditional ??CrossCallReturnLabel_9
          CFI (cfiCond10) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond10) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond10) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond10) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond10) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond10) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond10) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond10) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond10) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond10) CFA_SP SP+0
          CFI (cfiCond10) CFA_XSP16 add(XSP16, 22)
          CFI Block cfiCond11 Using cfiCommon0
          CFI (cfiCond11) Function ZDSecMgrSetupPartner
          CFI (cfiCond11) Conditional ??CrossCallReturnLabel_10
          CFI (cfiCond11) R6 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond11) VB load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond11) V0 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond11) V1 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond11) V2 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond11) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond11) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond11) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond11) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond11) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond11) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond11) CFA_SP SP+0
          CFI (cfiCond11) CFA_XSP16 add(XSP16, 24)
          CFI Block cfiPicker12 Using cfiCommon1
          CFI (cfiPicker12) NoFunction
          CFI (cfiPicker12) Picker
        LCALL   ??Subroutine62_0 & 0xFFFF
??CrossCallReturnLabel_114:
        ; Setup parameters for call to function AddrMgrExtAddrSet
        ; Setup parameters for call to function AddrMgrExtAddrSet
        ; Setup parameters for call to function AddrMgrExtAddrSet
        MOV     A,#0x3
        RET
          CFI EndBlock cfiCond9
          CFI EndBlock cfiCond10
          CFI EndBlock cfiCond11
          CFI EndBlock cfiPicker12
//  318 
//  319 /******************************************************************************
//  320  * @fn          ZDSecMgrExtAddrLookup
//  321  *
//  322  * @brief       Lookup index for specified EXT address.
//  323  *
//  324  * @param       extAddr - [in] EXT address
//  325  * @param       ami     - [out] Address Manager index
//  326  *
//  327  * @return      ZStatus_t
//  328  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  329 ZStatus_t ZDSecMgrExtAddrLookup( uint8* extAddr, uint16* ami )
ZDSecMgrExtAddrLookup:
          CFI Block cfiBlock13 Using cfiCommon0
          CFI Function ZDSecMgrExtAddrLookup
        CODE
//  330 {
        FUNCALL ZDSecMgrExtAddrLookup, AddrMgrExtAddrSet
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 22, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 22, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrExtAddrLookup, AddrMgrEntryLookupExt
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 22, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 22, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x9
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 13
        MOV     A,#-0xd
        LCALL   ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 22)
        MOV     A,R4
        MOV     R6,A
        MOV     A,R5
        MOV     R7,A
//  331   ZStatus_t      status;
//  332   AddrMgrEntry_t entry;
//  333 
//  334 
//  335   // lookup entry
//  336   entry.user = ADDRMGR_USER_SECURITY;
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     A,#0x2
        MOVX    @DPTR,A
//  337   AddrMgrExtAddrSet( entry.extAddr, extAddr );
        ; Setup parameters for call to function AddrMgrExtAddrSet
        MOV     A,R2
        MOV     R4,A
        MOV     A,R3
        MOV     R5,A
        MOV     A,#0x3
        LCALL   ?XSTACK_DISP0_8
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??AddrMgrExtAddrSet?relay
//  338 
//  339   if ( AddrMgrEntryLookupExt( &entry ) == TRUE )
        ; Setup parameters for call to function AddrMgrEntryLookupExt
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??AddrMgrEntryLookupExt?relay
        MOV     A,R1
        XRL     A,#0x1
        JNZ     ??ZDSecMgrExtAddrLookup_0
//  340   {
//  341     // return successful results
//  342     *ami   = entry.index;
        MOV     A,#0xb
        LCALL   ?XSTACK_DISP0_8
        LCALL   ?Subroutine12 & 0xFFFF
//  343     status = ZSuccess;
//  344   }
??CrossCallReturnLabel_72:
        SJMP    ??CrossCallReturnLabel_13
//  345   else
//  346   {
//  347     // return failed results
//  348     *ami   = entry.index;
??ZDSecMgrExtAddrLookup_0:
        MOV     A,#0xb
        LCALL   ?XSTACK_DISP0_8
        LCALL   ?Subroutine19 & 0xFFFF
//  349     status = ZNwkUnknownDevice;
//  350   }
//  351 
//  352   return status;
??CrossCallReturnLabel_13:
        LJMP    ?Subroutine0 & 0xFFFF
          CFI EndBlock cfiBlock13
//  353 }
//  354 
//  355 /******************************************************************************
//  356  * @fn          ZDSecMgrAddrClear
//  357  *
//  358  * @brief       Clear security bit from Address Manager for specific device.
//  359  *
//  360  * @param       extAddr - [in] EXT address
//  361  *
//  362  * @return      ZStatus_t
//  363  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  364 ZStatus_t ZDSecMgrAddrClear( uint8* extAddr )
ZDSecMgrAddrClear:
          CFI Block cfiBlock14 Using cfiCommon0
          CFI Function ZDSecMgrAddrClear
        CODE
//  365 {
        FUNCALL ZDSecMgrAddrClear, ZDSecMgrExtAddrLookup
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 24, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 24, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrAddrClear, AddrMgrEntryRelease
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 24, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 24, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x9
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 15
        MOV     A,#-0xf
        LCALL   ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 24)
//  366   ZStatus_t status;
//  367   uint16 entryAmi;
//  368 
//  369   // get Address Manager Index
//  370   status = ZDSecMgrExtAddrLookup( extAddr, &entryAmi );
        ; Setup parameters for call to function ZDSecMgrExtAddrLookup
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     R4,DPL
        MOV     R5,DPH
        LCALL   ??ZDSecMgrExtAddrLookup?relay
        MOV     A,R1
        MOV     R6,A
//  371 
//  372   if ( status == ZSuccess )
        JNZ     ??ZDSecMgrAddrClear_0
//  373   {
//  374     AddrMgrEntry_t addrEntry;
//  375 
//  376     // Clear SECURITY User bit from the address manager
//  377     addrEntry.user = ADDRMGR_USER_SECURITY;
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        MOV     A,#0x2
        MOVX    @DPTR,A
//  378     addrEntry.index = entryAmi;
        LCALL   ?Subroutine30 & 0xFFFF
??CrossCallReturnLabel_172:
        MOV     A,#0xd
        LCALL   ?XSTACK_DISP0_8
        LCALL   ??Subroutine63_0 & 0xFFFF
//  379 
//  380     if ( AddrMgrEntryRelease( &addrEntry ) != TRUE )
??CrossCallReturnLabel_119:
        ; Setup parameters for call to function AddrMgrEntryRelease
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??AddrMgrEntryRelease?relay
        MOV     A,R1
        XRL     A,#0x1
        JZ      ??ZDSecMgrAddrClear_0
//  381     {
//  382       // return failure results
//  383       status = ZFailure;
        MOV     R6,#0x1
//  384     }
//  385   }
//  386 
//  387   return status;
??ZDSecMgrAddrClear_0:
        MOV     A,R6
        MOV     R1,A
        MOV     A,#0xf
        LJMP    ??Subroutine67_0 & 0xFFFF
          CFI EndBlock cfiBlock14
//  388 }
//  389 
//  390 /******************************************************************************
//  391  * @fn          ZDSecMgrEntryInit
//  392  *
//  393  * @brief       Initialize entry sub module
//  394  *
//  395  * @param       state - device initialization state
//  396  *
//  397  * @return      none
//  398  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  399 void ZDSecMgrEntryInit(uint8 state)
ZDSecMgrEntryInit:
          CFI Block cfiBlock15 Using cfiCommon0
          CFI Function ZDSecMgrEntryInit
        CODE
//  400 {
        FUNCALL ZDSecMgrEntryInit, osal_mem_alloc
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrEntryInit, ZDSecMgrRestoreFromNV
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x9
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 0
        MOV     A,R1
        MOV     R6,A
//  401   if (ZDSecMgrEntries == NULL)
        MOV     DPTR,#ZDSecMgrEntries
        LCALL   ??Subroutine69_0 & 0xFFFF
??CrossCallReturnLabel_152:
        JNZ     ??ZDSecMgrEntryInit_0
//  402   {
//  403     uint16 index;
//  404 
//  405     if ((ZDSecMgrEntries = osal_mem_alloc(sizeof(ZDSecMgrEntry_t) * ZDSECMGR_ENTRY_MAX)) == NULL)
        ; Setup parameters for call to function osal_mem_alloc
        MOV     R2,#0xf
        MOV     R3,#0x0
        LCALL   ??osal_mem_alloc?relay
        MOV     DPTR,#ZDSecMgrEntries
        MOV     A,R2
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R3
        LCALL   ??Subroutine55_0 & 0xFFFF
??CrossCallReturnLabel_81:
        JZ      ??ZDSecMgrEntryInit_1
//  406     {
//  407       return;
//  408     }
//  409 
//  410     for (index = 0; index < ZDSECMGR_ENTRY_MAX; index++)
        MOV     R0,#0x0
        MOV     R1,#0x0
//  411     {
//  412       ZDSecMgrEntries[index].ami = INVALID_NODE_ADDR;
??ZDSecMgrEntryInit_2:
        LCALL   ?Subroutine27 & 0xFFFF
//  413 
//  414       ZDSecMgrEntries[index].keyNvId = SEC_NO_KEY_NV_ID;
//  415     }
??CrossCallReturnLabel_20:
        MOV     A,#-0x2
        MOVX    @DPTR,A
        INC     DPTR
        INC     A
        LCALL   ?Subroutine43 & 0xFFFF
??CrossCallReturnLabel_51:
        INC     DPTR
        INC     DPTR
        CLR     A
        MOVX    @DPTR,A
        INC     DPTR
        MOVX    @DPTR,A
        LCALL   ?Subroutine32 & 0xFFFF
//  416   }
??CrossCallReturnLabel_29:
        JC      ??ZDSecMgrEntryInit_2
//  417 
//  418 #if defined NV_RESTORE
//  419   if (state == ZDO_INITDEV_RESTORED_NETWORK_STATE)
??ZDSecMgrEntryInit_0:
        MOV     A,R6
        JNZ     ??ZDSecMgrEntryInit_1
//  420   {
//  421     ZDSecMgrRestoreFromNV();
        ; Setup parameters for call to function ZDSecMgrRestoreFromNV
        LCALL   ??ZDSecMgrRestoreFromNV?relay
//  422   }
??ZDSecMgrEntryInit_1:
        LJMP    ??Subroutine68_0 & 0xFFFF
          CFI EndBlock cfiBlock15
//  423 #else
//  424   (void)state;
//  425 #endif
//  426 }
//  427 
//  428 /******************************************************************************
//  429  * @fn          ZDSecMgrEntryLookup
//  430  *
//  431  * @brief       Lookup entry index using specified NWK address.
//  432  *
//  433  * @param       nwkAddr - [in] NWK address
//  434  * @param       entry   - [out] valid entry
//  435  *
//  436  * @return      ZStatus_t
//  437  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  438 ZStatus_t ZDSecMgrEntryLookup( uint16 nwkAddr, ZDSecMgrEntry_t** entry )
ZDSecMgrEntryLookup:
          CFI Block cfiBlock16 Using cfiCommon0
          CFI Function ZDSecMgrEntryLookup
        CODE
//  439 {
        FUNCALL ZDSecMgrEntryLookup, AddrMgrEntryLookupNwk
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 22, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 22, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x9
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 13
        MOV     A,#-0xd
        LCALL   ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 22)
        MOV     A,R4
        MOV     R6,A
        MOV     A,R5
        MOV     R7,A
//  440   uint16         index;
//  441   AddrMgrEntry_t addrMgrEntry;
//  442 
//  443   // initialize results
//  444   *entry = NULL;
        MOV     DPL,R6
        MOV     DPH,R7
        LCALL   ?Subroutine11 & 0xFFFF
//  445 
//  446   // verify data is available
//  447   if ( ZDSecMgrEntries != NULL )
??CrossCallReturnLabel_77:
        JZ      ??ZDSecMgrEntryLookup_0
//  448   {
//  449     addrMgrEntry.user    = ADDRMGR_USER_SECURITY;
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     A,#0x2
        MOVX    @DPTR,A
//  450     addrMgrEntry.nwkAddr = nwkAddr;
        DEC     A
        LCALL   ?XSTACK_DISP0_8
        LCALL   ?Subroutine10 & 0xFFFF
//  451 
//  452     if ( AddrMgrEntryLookupNwk( &addrMgrEntry ) == TRUE )
??CrossCallReturnLabel_138:
        LCALL   ??AddrMgrEntryLookupNwk?relay
        MOV     A,R1
        XRL     A,#0x1
        JNZ     ??ZDSecMgrEntryLookup_0
//  453     {
//  454       for ( index = 0; index < ZDSECMGR_ENTRY_MAX ; index++ )
        MOV     R0,#0x0
        MOV     R1,#0x0
//  455       {
//  456         if ( addrMgrEntry.index == ZDSecMgrEntries[index].ami )
??ZDSecMgrEntryLookup_1:
        LCALL   ?Subroutine49 & 0xFFFF
??CrossCallReturnLabel_61:
        MOV     A,#0xb
        LCALL   ?XSTACK_DISP0_8
        MOVX    A,@DPTR
        MOV     R4,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R5,A
        MOV     DPL,R2
        MOV     DPH,R3
        MOVX    A,@DPTR
        XRL     A,R4
        JNZ     ??ZDSecMgrEntryLookup_2
        INC     DPTR
        MOVX    A,@DPTR
        XRL     A,R5
??ZDSecMgrEntryLookup_2:
        JNZ     ??ZDSecMgrEntryLookup_3
//  457         {
//  458           // return successful results
//  459           *entry = &ZDSecMgrEntries[index];
        MOV     A,R2
        MOV     R0,A
        MOV     A,R3
        LCALL   ??Subroutine53_0 & 0xFFFF
//  460 
//  461           // break from loop
//  462           return ZSuccess;
//  463         }
//  464       }
??CrossCallReturnLabel_73:
        SJMP    ??ZDSecMgrEntryLookup_4
??ZDSecMgrEntryLookup_3:
        LCALL   ?Subroutine32 & 0xFFFF
//  465     }
//  466   }
??CrossCallReturnLabel_30:
        JC      ??ZDSecMgrEntryLookup_1
//  467 
//  468   return ZNwkUnknownDevice;
??ZDSecMgrEntryLookup_0:
        MOV     R1,#-0x38
??ZDSecMgrEntryLookup_4:
        LJMP    ?Subroutine0 & 0xFFFF
          CFI EndBlock cfiBlock16
//  469 }

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine12:
          CFI Block cfiCond17 Using cfiCommon0
          CFI Function ZDSecMgrAddrStore
          CFI Conditional ??CrossCallReturnLabel_70
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 22)
          CFI Block cfiCond18 Using cfiCommon0
          CFI (cfiCond18) Function ZDSecMgrExtAddrStore
          CFI (cfiCond18) Conditional ??CrossCallReturnLabel_71
          CFI (cfiCond18) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond18) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond18) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond18) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond18) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond18) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond18) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond18) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond18) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond18) CFA_SP SP+0
          CFI (cfiCond18) CFA_XSP16 add(XSP16, 22)
          CFI Block cfiCond19 Using cfiCommon0
          CFI (cfiCond19) Function ZDSecMgrExtAddrLookup
          CFI (cfiCond19) Conditional ??CrossCallReturnLabel_72
          CFI (cfiCond19) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond19) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond19) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond19) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond19) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond19) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond19) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond19) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond19) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond19) CFA_SP SP+0
          CFI (cfiCond19) CFA_XSP16 add(XSP16, 22)
          CFI Block cfiPicker20 Using cfiCommon1
          CFI (cfiPicker20) NoFunction
          CFI (cfiPicker20) Picker
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
          CFI EndBlock cfiCond17
          CFI EndBlock cfiCond18
          CFI EndBlock cfiCond19
          CFI EndBlock cfiPicker20
        REQUIRE ??Subroutine53_0
        ; // Fall through to label ??Subroutine53_0

        RSEG BANKED_CODE:CODE:NOROOT(0)
??Subroutine53_0:
          CFI Block cfiCond21 Using cfiCommon0
          CFI Function ZDSecMgrEntryLookup
          CFI Conditional ??CrossCallReturnLabel_73
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 22)
          CFI Block cfiCond22 Using cfiCommon0
          CFI (cfiCond22) Function ZDSecMgrAddrStore
          CFI (cfiCond22) Conditional ??CrossCallReturnLabel_70
          CFI (cfiCond22) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond22) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond22) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond22) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond22) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond22) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond22) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond22) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond22) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond22) CFA_SP SP+0
          CFI (cfiCond22) CFA_XSP16 add(XSP16, 22)
          CFI Block cfiCond23 Using cfiCommon0
          CFI (cfiCond23) Function ZDSecMgrExtAddrStore
          CFI (cfiCond23) Conditional ??CrossCallReturnLabel_71
          CFI (cfiCond23) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond23) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond23) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond23) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond23) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond23) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond23) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond23) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond23) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond23) CFA_SP SP+0
          CFI (cfiCond23) CFA_XSP16 add(XSP16, 22)
          CFI Block cfiCond24 Using cfiCommon0
          CFI (cfiCond24) Function ZDSecMgrExtAddrLookup
          CFI (cfiCond24) Conditional ??CrossCallReturnLabel_72
          CFI (cfiCond24) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond24) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond24) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond24) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond24) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond24) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond24) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond24) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond24) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond24) CFA_SP SP+0
          CFI (cfiCond24) CFA_XSP16 add(XSP16, 22)
          CFI Block cfiPicker25 Using cfiCommon1
          CFI (cfiPicker25) NoFunction
          CFI (cfiPicker25) Picker
        MOV     R1,A
        MOV     DPL,R6
        MOV     DPH,R7
          CFI EndBlock cfiCond21
          CFI EndBlock cfiCond22
          CFI EndBlock cfiCond23
          CFI EndBlock cfiCond24
          CFI EndBlock cfiPicker25
        REQUIRE ??Subroutine54_0
        ; // Fall through to label ??Subroutine54_0

        RSEG BANKED_CODE:CODE:NOROOT(0)
??Subroutine54_0:
          CFI Block cfiCond26 Using cfiCommon0
          CFI Function ZDSecMgrEntryLookupAMI
          CFI Conditional ??CrossCallReturnLabel_74
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
          CFI Block cfiCond27 Using cfiCommon0
          CFI (cfiCond27) Function ZDSecMgrEntryLookupExtGetIndex
          CFI (cfiCond27) Conditional ??CrossCallReturnLabel_75
          CFI (cfiCond27) R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond27) VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond27) V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond27) V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond27) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond27) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond27) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond27) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond27) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond27) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond27) CFA_SP SP+0
          CFI (cfiCond27) CFA_XSP16 add(XSP16, 12)
          CFI Block cfiCond28 Using cfiCommon0
          CFI (cfiCond28) Function ZDSecMgrEntryLookupAMIGetIndex
          CFI (cfiCond28) Conditional ??CrossCallReturnLabel_76
          CFI (cfiCond28) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond28) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond28) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond28) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond28) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond28) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond28) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond28) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond28) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond28) CFA_SP SP+0
          CFI (cfiCond28) CFA_XSP16 add(XSP16, 9)
          CFI Block cfiCond29 Using cfiCommon0
          CFI (cfiCond29) Function ZDSecMgrEntryLookup
          CFI (cfiCond29) Conditional ??CrossCallReturnLabel_73
          CFI (cfiCond29) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond29) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond29) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond29) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond29) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond29) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond29) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond29) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond29) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond29) CFA_SP SP+0
          CFI (cfiCond29) CFA_XSP16 add(XSP16, 22)
          CFI Block cfiCond30 Using cfiCommon0
          CFI (cfiCond30) Function ZDSecMgrAddrStore
          CFI (cfiCond30) Conditional ??CrossCallReturnLabel_70
          CFI (cfiCond30) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond30) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond30) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond30) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond30) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond30) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond30) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond30) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond30) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond30) CFA_SP SP+0
          CFI (cfiCond30) CFA_XSP16 add(XSP16, 22)
          CFI Block cfiCond31 Using cfiCommon0
          CFI (cfiCond31) Function ZDSecMgrExtAddrStore
          CFI (cfiCond31) Conditional ??CrossCallReturnLabel_71
          CFI (cfiCond31) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond31) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond31) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond31) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond31) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond31) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond31) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond31) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond31) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond31) CFA_SP SP+0
          CFI (cfiCond31) CFA_XSP16 add(XSP16, 22)
          CFI Block cfiCond32 Using cfiCommon0
          CFI (cfiCond32) Function ZDSecMgrExtAddrLookup
          CFI (cfiCond32) Conditional ??CrossCallReturnLabel_72
          CFI (cfiCond32) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond32) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond32) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond32) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond32) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond32) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond32) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond32) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond32) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond32) CFA_SP SP+0
          CFI (cfiCond32) CFA_XSP16 add(XSP16, 22)
          CFI Block cfiPicker33 Using cfiCommon1
          CFI (cfiPicker33) NoFunction
          CFI (cfiPicker33) Picker
        MOV     A,R0
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R1
        MOVX    @DPTR,A
        MOV     R1,#0x0
        RET
          CFI EndBlock cfiCond26
          CFI EndBlock cfiCond27
          CFI EndBlock cfiCond28
          CFI EndBlock cfiCond29
          CFI EndBlock cfiCond30
          CFI EndBlock cfiCond31
          CFI EndBlock cfiCond32
          CFI EndBlock cfiPicker33
//  470 
//  471 /******************************************************************************
//  472  * @fn          ZDSecMgrEntryLookupAMI
//  473  *
//  474  * @brief       Lookup entry using specified address index
//  475  *
//  476  * @param       ami   - [in] Address Manager index
//  477  * @param       entry - [out] valid entry
//  478  *
//  479  * @return      ZStatus_t
//  480  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  481 ZStatus_t ZDSecMgrEntryLookupAMI( uint16 ami, ZDSecMgrEntry_t** entry )
ZDSecMgrEntryLookupAMI:
          CFI Block cfiBlock34 Using cfiCommon0
          CFI Function ZDSecMgrEntryLookupAMI
        CODE
//  482 {
        MOV     A,#-0x9
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 0
//  483   uint16 index;
//  484 
//  485   // initialize results
//  486   *entry = NULL;
        MOV     DPL,R4
        MOV     DPH,R5
        LCALL   ?Subroutine11 & 0xFFFF
//  487 
//  488   // verify data is available
//  489   if ( ZDSecMgrEntries != NULL )
??CrossCallReturnLabel_78:
        JZ      ??ZDSecMgrEntryLookupAMI_0
//  490   {
//  491     for ( index = 0; index < ZDSECMGR_ENTRY_MAX ; index++ )
        MOV     R0,#0x0
        MOV     R1,#0x0
//  492     {
//  493       if ( ZDSecMgrEntries[index].ami == ami )
??ZDSecMgrEntryLookupAMI_1:
        LCALL   ?Subroutine41 & 0xFFFF
??CrossCallReturnLabel_49:
        MOV     R6,A
        INC     DPTR
        MOVX    A,@DPTR
        ADDC    A,R7
        MOV     R7,A
        MOV     DPL,R6
        MOV     DPH,R7
        MOVX    A,@DPTR
        XRL     A,R2
        JNZ     ??ZDSecMgrEntryLookupAMI_2
        INC     DPTR
        MOVX    A,@DPTR
        XRL     A,R3
??ZDSecMgrEntryLookupAMI_2:
        JNZ     ??ZDSecMgrEntryLookupAMI_3
//  494       {
//  495         // return successful results
//  496         *entry = &ZDSecMgrEntries[index];
        MOV     A,R6
        MOV     R0,A
        MOV     A,R7
        MOV     R1,A
        MOV     DPL,R4
        MOV     DPH,R5
        LCALL   ??Subroutine54_0 & 0xFFFF
//  497 
//  498         // break from loop
//  499         return ZSuccess;
//  500       }
//  501     }
??CrossCallReturnLabel_74:
        SJMP    ??ZDSecMgrEntryLookupAMI_4
??ZDSecMgrEntryLookupAMI_3:
        LCALL   ?Subroutine32 & 0xFFFF
//  502   }
??CrossCallReturnLabel_31:
        JC      ??ZDSecMgrEntryLookupAMI_1
//  503 
//  504   return ZNwkUnknownDevice;
??ZDSecMgrEntryLookupAMI_0:
        MOV     R1,#-0x38
??ZDSecMgrEntryLookupAMI_4:
        LJMP    ??Subroutine68_0 & 0xFFFF
          CFI EndBlock cfiBlock34
//  505 }

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine32:
          CFI Block cfiCond35 Using cfiCommon0
          CFI Function ZDSecMgrEntryInit
          CFI Conditional ??CrossCallReturnLabel_29
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
          CFI Block cfiCond36 Using cfiCommon0
          CFI (cfiCond36) Function ZDSecMgrEntryLookup
          CFI (cfiCond36) Conditional ??CrossCallReturnLabel_30
          CFI (cfiCond36) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond36) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond36) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond36) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond36) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond36) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond36) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond36) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond36) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond36) CFA_SP SP+0
          CFI (cfiCond36) CFA_XSP16 add(XSP16, 22)
          CFI Block cfiCond37 Using cfiCommon0
          CFI (cfiCond37) Function ZDSecMgrEntryLookupAMI
          CFI (cfiCond37) Conditional ??CrossCallReturnLabel_31
          CFI (cfiCond37) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond37) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond37) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond37) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond37) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond37) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond37) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond37) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond37) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond37) CFA_SP SP+0
          CFI (cfiCond37) CFA_XSP16 add(XSP16, 9)
          CFI Block cfiCond38 Using cfiCommon0
          CFI (cfiCond38) Function ZDSecMgrEntryLookupExtGetIndex
          CFI (cfiCond38) Conditional ??CrossCallReturnLabel_32
          CFI (cfiCond38) R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond38) VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond38) V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond38) V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond38) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond38) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond38) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond38) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond38) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond38) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond38) CFA_SP SP+0
          CFI (cfiCond38) CFA_XSP16 add(XSP16, 12)
          CFI Block cfiCond39 Using cfiCommon0
          CFI (cfiCond39) Function ZDSecMgrEntryLookupAMIGetIndex
          CFI (cfiCond39) Conditional ??CrossCallReturnLabel_33
          CFI (cfiCond39) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond39) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond39) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond39) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond39) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond39) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond39) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond39) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond39) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond39) CFA_SP SP+0
          CFI (cfiCond39) CFA_XSP16 add(XSP16, 9)
          CFI Block cfiPicker40 Using cfiCommon1
          CFI (cfiPicker40) NoFunction
          CFI (cfiPicker40) Picker
        MOV     A,R0
        ADD     A,#0x1
        INC     R0
        MOV     A,R1
        ADDC    A,#0x0
        MOV     R1,A
        CLR     C
        MOV     A,R0
        SUBB    A,#0x3
        MOV     A,R1
        SUBB    A,#0x0
        RET
          CFI EndBlock cfiCond35
          CFI EndBlock cfiCond36
          CFI EndBlock cfiCond37
          CFI EndBlock cfiCond38
          CFI EndBlock cfiCond39
          CFI EndBlock cfiPicker40

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine11:
          CFI Block cfiCond41 Using cfiCommon0
          CFI Function ZDSecMgrEntryLookup
          CFI Conditional ??CrossCallReturnLabel_77
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 22)
          CFI Block cfiCond42 Using cfiCommon0
          CFI (cfiCond42) Function ZDSecMgrEntryLookupAMI
          CFI (cfiCond42) Conditional ??CrossCallReturnLabel_78
          CFI (cfiCond42) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond42) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond42) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond42) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond42) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond42) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond42) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond42) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond42) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond42) CFA_SP SP+0
          CFI (cfiCond42) CFA_XSP16 add(XSP16, 9)
          CFI Block cfiCond43 Using cfiCommon0
          CFI (cfiCond43) Function ZDSecMgrEntryNew
          CFI (cfiCond43) Conditional ??CrossCallReturnLabel_79
          CFI (cfiCond43) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond43) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond43) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond43) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond43) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond43) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond43) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond43) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond43) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond43) CFA_SP SP+0
          CFI (cfiCond43) CFA_XSP16 add(XSP16, 9)
          CFI Block cfiCond44 Using cfiCommon0
          CFI (cfiCond44) Function ZDSecMgrWriteNV
          CFI (cfiCond44) Conditional ??CrossCallReturnLabel_80
          CFI (cfiCond44) R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond44) VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond44) V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond44) V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond44) V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond44) V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond44) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond44) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond44) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond44) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond44) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond44) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond44) CFA_SP SP+0
          CFI (cfiCond44) CFA_XSP16 add(XSP16, 14)
          CFI Block cfiPicker45 Using cfiCommon1
          CFI (cfiPicker45) NoFunction
          CFI (cfiPicker45) Picker
        CLR     A
        MOVX    @DPTR,A
        INC     DPTR
          CFI EndBlock cfiCond41
          CFI EndBlock cfiCond42
          CFI EndBlock cfiCond43
          CFI EndBlock cfiCond44
          CFI EndBlock cfiPicker45
        REQUIRE ??Subroutine55_0
        ; // Fall through to label ??Subroutine55_0

        RSEG BANKED_CODE:CODE:NOROOT(0)
??Subroutine55_0:
          CFI Block cfiCond46 Using cfiCommon0
          CFI Function ZDSecMgrEntryInit
          CFI Conditional ??CrossCallReturnLabel_81
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
          CFI Block cfiCond47 Using cfiCommon0
          CFI (cfiCond47) Function ZDSecMgrEntryLookup
          CFI (cfiCond47) Conditional ??CrossCallReturnLabel_77
          CFI (cfiCond47) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond47) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond47) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond47) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond47) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond47) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond47) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond47) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond47) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond47) CFA_SP SP+0
          CFI (cfiCond47) CFA_XSP16 add(XSP16, 22)
          CFI Block cfiCond48 Using cfiCommon0
          CFI (cfiCond48) Function ZDSecMgrEntryLookupAMI
          CFI (cfiCond48) Conditional ??CrossCallReturnLabel_78
          CFI (cfiCond48) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond48) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond48) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond48) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond48) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond48) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond48) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond48) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond48) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond48) CFA_SP SP+0
          CFI (cfiCond48) CFA_XSP16 add(XSP16, 9)
          CFI Block cfiCond49 Using cfiCommon0
          CFI (cfiCond49) Function ZDSecMgrEntryNew
          CFI (cfiCond49) Conditional ??CrossCallReturnLabel_79
          CFI (cfiCond49) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond49) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond49) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond49) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond49) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond49) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond49) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond49) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond49) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond49) CFA_SP SP+0
          CFI (cfiCond49) CFA_XSP16 add(XSP16, 9)
          CFI Block cfiCond50 Using cfiCommon0
          CFI (cfiCond50) Function ZDSecMgrWriteNV
          CFI (cfiCond50) Conditional ??CrossCallReturnLabel_80
          CFI (cfiCond50) R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond50) VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond50) V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond50) V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond50) V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond50) V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond50) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond50) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond50) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond50) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond50) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond50) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond50) CFA_SP SP+0
          CFI (cfiCond50) CFA_XSP16 add(XSP16, 14)
          CFI Block cfiPicker51 Using cfiCommon1
          CFI (cfiPicker51) NoFunction
          CFI (cfiPicker51) Picker
        MOVX    @DPTR,A
        MOV     DPTR,#ZDSecMgrEntries
        LCALL   ?Subroutine44 & 0xFFFF
??CrossCallReturnLabel_165:
        ORL     A,R1
        RET
          CFI EndBlock cfiCond46
          CFI EndBlock cfiCond47
          CFI EndBlock cfiCond48
          CFI EndBlock cfiCond49
          CFI EndBlock cfiCond50
          CFI EndBlock cfiPicker51
//  506 
//  507 /******************************************************************************
//  508  * @fn          ZDSecMgrEntryLookupExt
//  509  *
//  510  * @brief       Lookup entry index using specified EXT address.
//  511  *
//  512  * @param       extAddr - [in] EXT address
//  513  * @param       entry   - [out] valid entry
//  514  *
//  515  * @return      ZStatus_t
//  516  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  517 ZStatus_t ZDSecMgrEntryLookupExt( uint8* extAddr, ZDSecMgrEntry_t** entry )
ZDSecMgrEntryLookupExt:
          CFI Block cfiBlock52 Using cfiCommon0
          CFI Function ZDSecMgrEntryLookupExt
        CODE
//  518 {
        FUNCALL ZDSecMgrEntryLookupExt, ZDSecMgrExtAddrLookup
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 11, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 11, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrEntryLookupExt, ZDSecMgrEntryLookupAMI
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 11, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 11, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x9
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 2
        MOV     A,#-0x2
        LCALL   ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 11)
        MOV     A,R4
        MOV     R6,A
        MOV     A,R5
        MOV     R7,A
//  519   ZStatus_t status;
//  520   uint16    ami;
//  521 
//  522   // initialize results
//  523   *entry = NULL;
        MOV     DPL,R6
        MOV     DPH,R7
        CLR     A
        MOVX    @DPTR,A
        INC     DPTR
        MOVX    @DPTR,A
//  524   status = ZNwkUnknownDevice;
        MOV     ?V0 + 0,#-0x38
//  525 
//  526   // lookup address index
//  527   if ( ZDSecMgrExtAddrLookup( extAddr, &ami ) == ZSuccess )
        ; Setup parameters for call to function ZDSecMgrExtAddrLookup
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     R4,DPL
        MOV     R5,DPH
        LCALL   ??ZDSecMgrExtAddrLookup?relay
        MOV     A,R1
        JNZ     ??ZDSecMgrEntryLookupExt_0
//  528   {
//  529     status = ZDSecMgrEntryLookupAMI( ami, entry );
        ; Setup parameters for call to function ZDSecMgrEntryLookupAMI
        MOV     A,R6
        MOV     R4,A
        MOV     A,R7
        MOV     R5,A
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        LCALL   ??Subroutine59_0 & 0xFFFF
//  530   }
??CrossCallReturnLabel_89:
        LCALL   ??ZDSecMgrEntryLookupAMI?relay
        MOV     A,R1
        MOV     ?V0 + 0,A
//  531 
//  532   return status;
??ZDSecMgrEntryLookupExt_0:
        MOV     R1,?V0 + 0
        LJMP    ?Subroutine7 & 0xFFFF
          CFI EndBlock cfiBlock52
//  533 }
//  534 
//  535 /******************************************************************************
//  536  * @fn          ZDSecMgrEntryLookupExtGetIndex
//  537  *
//  538  * @brief       Lookup entry index using specified EXT address.
//  539  *
//  540  * @param       extAddr - [in] EXT address
//  541  * @param       entryIndex - [out] valid index to the entry table
//  542  *
//  543  * @return      ZStatus_t
//  544  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  545 ZStatus_t ZDSecMgrEntryLookupExtGetIndex( uint8* extAddr, ZDSecMgrEntry_t** entry, uint16* entryIndex )
ZDSecMgrEntryLookupExtGetIndex:
          CFI Block cfiBlock53 Using cfiCommon0
          CFI Function ZDSecMgrEntryLookupExtGetIndex
        CODE
//  546 {
        FUNCALL ZDSecMgrEntryLookupExtGetIndex, ZDSecMgrExtAddrLookup
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 12, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 12, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0xa
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 10)
        ; Saved register size: 10
        ; Auto size: 2
        MOV     A,#-0x2
        LCALL   ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 12)
        MOV     A,R4
        MOV     R6,A
        MOV     A,R5
        MOV     R7,A
        MOV     A,#0xc
        LCALL   ?XSTACK_DISP0_8
        MOVX    A,@DPTR
        MOV     ?V0 + 0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     ?V0 + 1,A
//  547   uint16 ami;
//  548   uint16 index;
//  549 
//  550   // lookup address index
//  551   if ( ZDSecMgrExtAddrLookup( extAddr, &ami ) == ZSuccess )
        ; Setup parameters for call to function ZDSecMgrExtAddrLookup
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     R4,DPL
        MOV     R5,DPH
        LCALL   ??ZDSecMgrExtAddrLookup?relay
        MOV     A,R1
        JNZ     ??ZDSecMgrEntryLookupExtGetIndex_0
//  552   {
//  553     // verify data is available
//  554     if ( ZDSecMgrEntries != NULL )
        MOV     DPTR,#ZDSecMgrEntries
        LCALL   ??Subroutine69_0 & 0xFFFF
??CrossCallReturnLabel_153:
        JZ      ??ZDSecMgrEntryLookupExtGetIndex_0
//  555     {
//  556       for ( index = 0; index < ZDSECMGR_ENTRY_MAX ; index++ )
        MOV     R0,#0x0
        MOV     R1,#0x0
//  557       {
//  558         if ( ZDSecMgrEntries[index].ami == ami )
??ZDSecMgrEntryLookupExtGetIndex_1:
        LCALL   ?Subroutine27 & 0xFFFF
??CrossCallReturnLabel_21:
        MOVX    A,@DPTR
        MOV     R4,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R5,A
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        XRL     A,R4
        JNZ     ??ZDSecMgrEntryLookupExtGetIndex_2
        INC     DPTR
        MOVX    A,@DPTR
        XRL     A,R5
??ZDSecMgrEntryLookupExtGetIndex_2:
        JNZ     ??ZDSecMgrEntryLookupExtGetIndex_3
//  559         {
//  560           // return successful results
//  561           *entry = &ZDSecMgrEntries[index];
        LCALL   ?Subroutine42 & 0xFFFF
//  562           *entryIndex = index;
??CrossCallReturnLabel_115:
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        LCALL   ??Subroutine54_0 & 0xFFFF
//  563 
//  564           // break from loop
//  565           return ZSuccess;
//  566         }
//  567       }
??CrossCallReturnLabel_75:
        SJMP    ??ZDSecMgrEntryLookupExtGetIndex_4
??ZDSecMgrEntryLookupExtGetIndex_3:
        LCALL   ?Subroutine32 & 0xFFFF
//  568     }
//  569   }
??CrossCallReturnLabel_32:
        JC      ??ZDSecMgrEntryLookupExtGetIndex_1
//  570 
//  571   return ZNwkUnknownDevice;
??ZDSecMgrEntryLookupExtGetIndex_0:
        MOV     R1,#-0x38
??ZDSecMgrEntryLookupExtGetIndex_4:
        LJMP    ?Subroutine1 & 0xFFFF
          CFI EndBlock cfiBlock53
//  572 }

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine27:
          CFI Block cfiCond54 Using cfiCommon0
          CFI Function ZDSecMgrEntryInit
          CFI Conditional ??CrossCallReturnLabel_20
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
          CFI Block cfiCond55 Using cfiCommon0
          CFI (cfiCond55) Function ZDSecMgrEntryLookupExtGetIndex
          CFI (cfiCond55) Conditional ??CrossCallReturnLabel_21
          CFI (cfiCond55) R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond55) VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond55) V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond55) V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond55) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond55) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond55) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond55) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond55) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond55) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond55) CFA_SP SP+0
          CFI (cfiCond55) CFA_XSP16 add(XSP16, 12)
          CFI Block cfiPicker56 Using cfiCommon1
          CFI (cfiPicker56) NoFunction
          CFI (cfiPicker56) Picker
        LCALL   ?Subroutine49 & 0xFFFF
??CrossCallReturnLabel_62:
        MOV     DPL,R2
        MOV     DPH,R3
        RET
          CFI EndBlock cfiCond54
          CFI EndBlock cfiCond55
          CFI EndBlock cfiPicker56

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine49:
          CFI Block cfiCond57 Using cfiCommon0
          CFI Function ZDSecMgrEntryLookup
          CFI Conditional ??CrossCallReturnLabel_61
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 22)
          CFI Block cfiCond58 Using cfiCommon0
          CFI (cfiCond58) Function ZDSecMgrEntryInit
          CFI (cfiCond58) Conditional ??CrossCallReturnLabel_62, ??CrossCallReturnLabel_20
          CFI (cfiCond58) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond58) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond58) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond58) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond58) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond58) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond58) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond58) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond58) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond58) CFA_SP SP+0
          CFI (cfiCond58) CFA_XSP16 add(XSP16, 9)
          CFI Block cfiCond59 Using cfiCommon0
          CFI (cfiCond59) Function ZDSecMgrEntryLookupExtGetIndex
          CFI (cfiCond59) Conditional ??CrossCallReturnLabel_62, ??CrossCallReturnLabel_21
          CFI (cfiCond59) R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond59) VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond59) V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond59) V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond59) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond59) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond59) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond59) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond59) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond59) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond59) CFA_SP SP+0
          CFI (cfiCond59) CFA_XSP16 add(XSP16, 12)
          CFI Block cfiPicker60 Using cfiCommon1
          CFI (cfiPicker60) NoFunction
          CFI (cfiPicker60) Picker
        MOV     A,R0
        MOV     R2,A
        MOV     A,R1
        MOV     R3,A
        MOV     A,R2
        MOV     B,#0x5
        MUL     AB
        MOV     R2,A
        MOV     R4,B
        MOV     B,#0x5
        MOV     A,R3
        MUL     AB
        ADD     A,R4
        MOV     R3,A
        MOV     DPTR,#ZDSecMgrEntries
        MOVX    A,@DPTR
        ADD     A,R2
        MOV     R2,A
        INC     DPTR
        MOVX    A,@DPTR
        ADDC    A,R3
        MOV     R3,A
        RET
          CFI EndBlock cfiCond57
          CFI EndBlock cfiCond58
          CFI EndBlock cfiCond59
          CFI EndBlock cfiPicker60
//  573 
//  574 /******************************************************************************
//  575  * @fn          ZDSecMgrEntryLookupAMIGetIndex
//  576  *
//  577  * @brief       Lookup entry using specified address index
//  578  *
//  579  * @param       ami   - [in] Address Manager index
//  580  * @param       entryIndex - [out] valid index to the entry table
//  581  *
//  582  * @return      ZStatus_t
//  583  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  584 ZStatus_t ZDSecMgrEntryLookupAMIGetIndex( uint16 ami, uint16* entryIndex )
ZDSecMgrEntryLookupAMIGetIndex:
          CFI Block cfiBlock61 Using cfiCommon0
          CFI Function ZDSecMgrEntryLookupAMIGetIndex
        CODE
//  585 {
        MOV     A,#-0x9
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 0
//  586   uint16 index;
//  587 
//  588   // verify data is available
//  589   if ( ZDSecMgrEntries != NULL )
        MOV     DPTR,#ZDSecMgrEntries
        LCALL   ??Subroutine69_0 & 0xFFFF
??CrossCallReturnLabel_154:
        JZ      ??ZDSecMgrEntryLookupAMIGetIndex_0
//  590   {
//  591     for ( index = 0; index < ZDSECMGR_ENTRY_MAX ; index++ )
        MOV     R0,#0x0
        MOV     R1,#0x0
//  592     {
//  593       if ( ZDSecMgrEntries[index].ami == ami )
??ZDSecMgrEntryLookupAMIGetIndex_1:
        LCALL   ?Subroutine41 & 0xFFFF
??CrossCallReturnLabel_50:
        MOV     ?V0 + 0,A
        INC     DPTR
        MOVX    A,@DPTR
        ADDC    A,R7
        MOV     DPL,?V0 + 0
        MOV     DPH,A
        MOVX    A,@DPTR
        XRL     A,R2
        JNZ     ??ZDSecMgrEntryLookupAMIGetIndex_2
        INC     DPTR
        MOVX    A,@DPTR
        XRL     A,R3
??ZDSecMgrEntryLookupAMIGetIndex_2:
        JNZ     ??ZDSecMgrEntryLookupAMIGetIndex_3
//  594       {
//  595         // return successful results
//  596         *entryIndex = index;
        MOV     DPL,R4
        MOV     DPH,R5
        LCALL   ??Subroutine54_0 & 0xFFFF
//  597 
//  598         // break from loop
//  599         return ZSuccess;
//  600       }
//  601     }
??CrossCallReturnLabel_76:
        SJMP    ??ZDSecMgrEntryLookupAMIGetIndex_4
??ZDSecMgrEntryLookupAMIGetIndex_3:
        LCALL   ?Subroutine32 & 0xFFFF
//  602   }
??CrossCallReturnLabel_33:
        JC      ??ZDSecMgrEntryLookupAMIGetIndex_1
//  603 
//  604   return ZNwkUnknownDevice;
??ZDSecMgrEntryLookupAMIGetIndex_0:
        MOV     R1,#-0x38
??ZDSecMgrEntryLookupAMIGetIndex_4:
        LJMP    ??Subroutine68_0 & 0xFFFF
          CFI EndBlock cfiBlock61
//  605 }

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine41:
          CFI Block cfiCond62 Using cfiCommon0
          CFI Function ZDSecMgrEntryLookupAMI
          CFI Conditional ??CrossCallReturnLabel_49
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
          CFI Block cfiCond63 Using cfiCommon0
          CFI (cfiCond63) Function ZDSecMgrEntryLookupAMIGetIndex
          CFI (cfiCond63) Conditional ??CrossCallReturnLabel_50
          CFI (cfiCond63) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond63) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond63) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond63) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond63) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond63) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond63) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond63) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond63) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond63) CFA_SP SP+0
          CFI (cfiCond63) CFA_XSP16 add(XSP16, 9)
          CFI Block cfiPicker64 Using cfiCommon1
          CFI (cfiPicker64) NoFunction
          CFI (cfiPicker64) Picker
        MOV     A,R0
        MOV     R6,A
        MOV     A,R1
        MOV     R7,A
        MOV     A,R6
        MOV     B,#0x5
        MUL     AB
        MOV     R6,A
        MOV     ?V0 + 0,B
        MOV     B,#0x5
        MOV     A,R7
        MUL     AB
        ADD     A,?V0 + 0
        MOV     R7,A
        MOV     DPTR,#ZDSecMgrEntries
        MOVX    A,@DPTR
        ADD     A,R6
        RET
          CFI EndBlock cfiCond62
          CFI EndBlock cfiCond63
          CFI EndBlock cfiPicker64
//  606 
//  607 /******************************************************************************
//  608  * @fn          ZDSecMgrEntryFree
//  609  *
//  610  * @brief       Free entry.
//  611  *
//  612  * @param       entry - [in] valid entry
//  613  *
//  614  * @return      ZStatus_t
//  615  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  616 void ZDSecMgrEntryFree( ZDSecMgrEntry_t* entry )
ZDSecMgrEntryFree:
          CFI Block cfiBlock65 Using cfiCommon0
          CFI Function ZDSecMgrEntryFree
        CODE
//  617 {
        FUNCALL ZDSecMgrEntryFree, ZDSecMgrEntryLookupAMIGetIndex
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 20, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 20, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrEntryFree, osal_mem_alloc
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 20, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 20, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrEntryFree, osal_memset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 20, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 20, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrEntryFree, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 24, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 24, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrEntryFree, osal_mem_free
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 20, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 20, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrEntryFree, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 24, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 24, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrEntryFree, osal_nv_read
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 24, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 24, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrEntryFree, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 24, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 24, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x10
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V7 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 16)
        ; Saved register size: 16
        ; Auto size: 4
        MOV     A,#-0x4
        LCALL   ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 20)
        MOV     A,R2
        MOV     R6,A
        MOV     A,R3
        MOV     R7,A
//  618   APSME_LinkKeyData_t   *pApsLinkKey = NULL;
//  619 
//  620 #if defined ( NV_RESTORE )
//  621   ZStatus_t status;
//  622   uint16 entryIndex;
//  623 
//  624   status = ZDSecMgrEntryLookupAMIGetIndex( entry->ami, &entryIndex );
        ; Setup parameters for call to function ZDSecMgrEntryLookupAMIGetIndex
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        MOV     R4,DPL
        MOV     R5,DPH
        MOV     DPL,R6
        MOV     DPH,R7
        LCALL   ??Subroutine59_0 & 0xFFFF
??CrossCallReturnLabel_90:
        LCALL   ??ZDSecMgrEntryLookupAMIGetIndex?relay
        MOV     A,R1
        MOV     ?V0 + 4,A
//  625 #endif
//  626 
//  627   pApsLinkKey = (APSME_LinkKeyData_t *)osal_mem_alloc(sizeof(APSME_LinkKeyData_t));
        ; Setup parameters for call to function osal_mem_alloc
        MOV     R2,#0x18
        MOV     R3,#0x0
        LCALL   ??osal_mem_alloc?relay
        MOV     ?V0 + 2,R2
        MOV     ?V0 + 3,R3
//  628 
//  629   if (pApsLinkKey != NULL)
        MOV     A,R2
        ORL     A,?V0 + 3
        JZ      ??ZDSecMgrEntryFree_0
//  630   {
//  631     osal_memset( pApsLinkKey, 0x00, sizeof(APSME_LinkKeyData_t) );
        ; Setup parameters for call to function osal_memset
        MOV     R4,#0x18
        MOV     R5,#0x0
        MOV     R1,#0x0
        LCALL   ??osal_memset?relay
//  632 
//  633     // Clear the APS Link key in NV
//  634     osal_nv_write( entry->keyNvId, 0,
//  635                         sizeof(APSME_LinkKeyData_t), pApsLinkKey);
        LCALL   ?Subroutine38 & 0xFFFF
??CrossCallReturnLabel_83:
        ; Setup parameters for call to function osal_nv_write
        MOV     R0,#?V0 + 2
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 22)
        MOV     ?V0 + 6,#0x18
        MOV     ?V0 + 7,#0x0
        MOV     R0,#?V0 + 6
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 24)
        MOV     R4,#0x0
        MOV     R5,#0x0
        MOV     DPL,?V0 + 0
        MOV     DPH,R1
        LCALL   ??Subroutine59_0 & 0xFFFF
??CrossCallReturnLabel_91:
        LCALL   ??osal_nv_write?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 20)
//  636 
//  637     // set entry to invalid Key
//  638     entry->keyNvId = SEC_NO_KEY_NV_ID;
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        CLR     A
        MOVX    @DPTR,A
        INC     DPTR
        MOVX    @DPTR,A
//  639 
//  640     osal_mem_free(pApsLinkKey);
        ; Setup parameters for call to function osal_mem_free
        MOV     R2,?V0 + 2
        MOV     R3,?V0 + 3
        LCALL   ??osal_mem_free?relay
//  641   }
//  642 
//  643   // marking the entry as INVALID_NODE_ADDR
//  644   entry->ami = INVALID_NODE_ADDR;
??ZDSecMgrEntryFree_0:
        MOV     DPL,R6
        MOV     DPH,R7
        MOV     A,#-0x2
        MOVX    @DPTR,A
        INC     DPTR
        INC     A
        MOVX    @DPTR,A
//  645 
//  646   // set to default value
//  647   entry->authenticateOption = ZDSecMgr_Not_Authenticated;
        MOV     DPL,R6
        MOV     DPH,R7
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        CLR     A
        MOVX    @DPTR,A
//  648 
//  649 #if defined ( NV_RESTORE )
//  650   if ( status == ZSuccess )
        MOV     A,?V0 + 4
        JZ      $+5
        LJMP    ??ZDSecMgrEntryFree_1 & 0xFFFF
//  651   {
//  652     ZDSecMgrUpdateNV(entryIndex);
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        LCALL   ??Subroutine59_0 & 0xFFFF
//  653   }
??CrossCallReturnLabel_92:
        MOV     A,R2
        MOV     R6,A
        MOV     A,R3
        MOV     R7,A
        MOV     A,R6
        MOV     B,#0x5
        MUL     AB
        MOV     R6,A
        MOV     R0,B
        MOV     B,#0x5
        MOV     A,R7
        MUL     AB
        ADD     A,R0
        MOV     R7,A
        MOV     DPTR,#ZDSecMgrEntries
        LCALL   ??Subroutine69_0 & 0xFFFF
??CrossCallReturnLabel_155:
        JZ      ??ZDSecMgrEntryFree_2
        ; Setup parameters for call to function osal_nv_write
        MOV     DPTR,#ZDSecMgrEntries
        MOVX    A,@DPTR
        ADD     A,R6
        MOV     ?V0 + 0,A
        INC     DPTR
        MOVX    A,@DPTR
        ADDC    A,R7
        MOV     ?V0 + 1,A
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 22)
        MOV     ?V0 + 0,#0x5
        MOV     ?V0 + 1,#0x0
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 24)
        MOV     A,R2
        MOV     B,#0x5
        MUL     AB
        MOV     R2,A
        MOV     R0,B
        MOV     B,#0x5
        MOV     A,R3
        MUL     AB
        ADD     A,R0
        MOV     R3,A
        MOV     A,R2
        ADD     A,#0x2
        MOV     R4,A
        MOV     A,R3
        LCALL   ?Subroutine50 & 0xFFFF
??CrossCallReturnLabel_63:
        LCALL   ??osal_nv_write?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 20)
??ZDSecMgrEntryFree_2:
        ; Setup parameters for call to function osal_nv_read
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     ?V0 + 0,DPL
        MOV     ?V0 + 1,DPH
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 22)
        MOV     ?V0 + 0,#0x2
        MOV     ?V0 + 1,#0x0
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 24)
        MOV     R4,#0x0
        MOV     R5,#0x0
        MOV     R2,#0x4c
        MOV     R3,#0x0
        LCALL   ??osal_nv_read?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 20)
        MOV     A,R1
        JNZ     ??ZDSecMgrEntryFree_1
        LCALL   ?Subroutine28 & 0xFFFF
??CrossCallReturnLabel_22:
        MOVX    A,@DPTR
        XRL     A,#0xfe
        JNZ     ??ZDSecMgrEntryFree_3
        INC     DPTR
        MOVX    A,@DPTR
        CPL     A
??ZDSecMgrEntryFree_3:
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        JNZ     ??ZDSecMgrEntryFree_4
        LCALL   ??Subroutine69_0 & 0xFFFF
??CrossCallReturnLabel_156:
        JZ      ??ZDSecMgrEntryFree_5
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        ADD     A,#-0x1
        MOVX    @DPTR,A
        INC     DPTR
        MOVX    A,@DPTR
        ADDC    A,#-0x1
        SJMP    ??CrossCallReturnLabel_27
??ZDSecMgrEntryFree_4:
        LCALL   ?Subroutine31 & 0xFFFF
??CrossCallReturnLabel_27:
        MOVX    @DPTR,A
??ZDSecMgrEntryFree_5:
        ; Setup parameters for call to function osal_nv_write
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     ?V0 + 0,DPL
        MOV     ?V0 + 1,DPH
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 22)
        MOV     ?V0 + 0,#0x2
        MOV     ?V0 + 1,#0x0
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 24)
        MOV     R4,#0x0
        MOV     R5,#0x0
        MOV     R2,#0x4c
        MOV     R3,#0x0
        LCALL   ??osal_nv_write?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 20)
//  654 #endif
//  655 }
??ZDSecMgrEntryFree_1:
        MOV     A,#0x4
          CFI EndBlock cfiBlock65
        REQUIRE ?Subroutine2
        ; // Fall through to label ?Subroutine2

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine2:
          CFI Block cfiBlock66 Using cfiCommon0
          CFI NoFunction
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 20)
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V7 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI Invalid
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 16)
          CFI Valid
        MOV     R7,#0x8
        LJMP    ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock66
//  656 
//  657 /******************************************************************************
//  658  * @fn          ZDSecMgrEntryNew
//  659  *
//  660  * @brief       Get a new entry.
//  661  *
//  662  * @param       entry - [out] valid entry
//  663  *
//  664  * @return      ZStatus_t
//  665  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  666 ZStatus_t ZDSecMgrEntryNew( ZDSecMgrEntry_t** entry )
ZDSecMgrEntryNew:
          CFI Block cfiBlock67 Using cfiCommon0
          CFI Function ZDSecMgrEntryNew
        CODE
//  667 {
        MOV     A,#-0x9
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 0
//  668   uint16 index;
//  669 
//  670   // initialize results
//  671   *entry = NULL;
        MOV     DPL,R2
        MOV     DPH,R3
        LCALL   ?Subroutine11 & 0xFFFF
//  672 
//  673   // verify data is available
//  674   if ( ZDSecMgrEntries != NULL )
??CrossCallReturnLabel_79:
        JZ      ??ZDSecMgrEntryNew_0
//  675   {
//  676     // find available entry
//  677     for ( index = 0; index < ZDSECMGR_ENTRY_MAX ; index++ )
        MOV     R4,#0x0
        MOV     R5,#0x0
//  678     {
//  679       if ( ZDSecMgrEntries[index].ami == INVALID_NODE_ADDR )
??ZDSecMgrEntryNew_1:
        MOV     A,R4
        MOV     R0,A
        MOV     A,R5
        MOV     R1,A
        MOV     A,R0
        MOV     B,#0x5
        MUL     AB
        MOV     R0,A
        MOV     R6,B
        MOV     B,#0x5
        MOV     A,R1
        MUL     AB
        ADD     A,R6
        MOV     R1,A
        MOV     DPTR,#ZDSecMgrEntries
        MOVX    A,@DPTR
        ADD     A,R0
        MOV     R6,A
        INC     DPTR
        MOVX    A,@DPTR
        ADDC    A,R1
        MOV     R7,A
        MOV     DPL,R6
        MOV     DPH,R7
        MOVX    A,@DPTR
        XRL     A,#0xfe
        JNZ     ??ZDSecMgrEntryNew_2
        INC     DPTR
        MOVX    A,@DPTR
        CPL     A
??ZDSecMgrEntryNew_2:
        JNZ     ??ZDSecMgrEntryNew_3
//  680       {
//  681         // return successful result
//  682         *entry = &ZDSecMgrEntries[index];
        MOV     A,R6
        MOV     R4,A
        MOV     A,R7
        MOV     R5,A
        MOV     DPL,R2
        MOV     DPH,R3
        MOV     A,R4
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R5
        MOVX    @DPTR,A
//  683 
//  684         // Set the authentication option to default
//  685         ZDSecMgrEntries[index].authenticateOption = ZDSecMgr_Not_Authenticated;
        MOV     DPTR,#ZDSecMgrEntries
        MOVX    A,@DPTR
        ADD     A,R0
        MOV     R2,A
        INC     DPTR
        MOVX    A,@DPTR
        ADDC    A,R1
        MOV     DPL,R2
        MOV     DPH,A
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        CLR     A
        MOVX    @DPTR,A
//  686 
//  687         // break from loop
//  688         return ZSuccess;
        MOV     R1,A
        SJMP    ??ZDSecMgrEntryNew_4
//  689       }
//  690     }
??ZDSecMgrEntryNew_3:
        MOV     A,R4
        ADD     A,#0x1
        INC     R4
        MOV     A,R5
        ADDC    A,#0x0
        MOV     R5,A
        CLR     C
        MOV     A,R4
        SUBB    A,#0x3
        MOV     A,R5
        SUBB    A,#0x0
        JC      ??ZDSecMgrEntryNew_1
//  691   }
//  692 
//  693   return ZNwkUnknownDevice;
??ZDSecMgrEntryNew_0:
        MOV     R1,#-0x38
??ZDSecMgrEntryNew_4:
        LJMP    ??Subroutine68_0 & 0xFFFF
          CFI EndBlock cfiBlock67
//  694 }
//  695 
//  696 /******************************************************************************
//  697  * @fn          ZDSecMgrAppKeyGet
//  698  *
//  699  * @brief       get an APP key - option APP(MASTER or LINK) key
//  700  *
//  701  * @param       initNwkAddr - [in] NWK address of initiator device
//  702  * @param       initExtAddr - [in] EXT address of initiator device
//  703  * @param       partNwkAddr - [in] NWK address of partner device
//  704  * @param       partExtAddr - [in] EXT address of partner device
//  705  * @param       key         - [out] APP(MASTER or LINK) key
//  706  * @param       keyType     - [out] APP(MASTER or LINK) key type
//  707  *
//  708  * @return      ZStatus_t
//  709  */

        RSEG XDATA_I:XDATA:NOROOT(0)
//  710 uint8 ZDSecMgrAppKeyType = KEY_TYPE_APP_LINK;    // Set the default key type
ZDSecMgrAppKeyType:
        DATA8
        DS 1
        REQUIRE `?<Initializer for ZDSecMgrAppKeyType>`
        REQUIRE __INIT_XDATA_I
//  711                                                  // to KEY_TYPE_APP_LINK since
//  712                                                  // only specific requirement
//  713                                                  // right now comes from SE profile
//  714 

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  715 ZStatus_t ZDSecMgrAppKeyGet( uint16  initNwkAddr,
ZDSecMgrAppKeyGet:
          CFI Block cfiBlock68 Using cfiCommon0
          CFI Function ZDSecMgrAppKeyGet
        CODE
//  716                              uint8*  initExtAddr,
//  717                              uint16  partNwkAddr,
//  718                              uint8*  partExtAddr,
//  719                              uint8** key,
//  720                              uint8*  keyType )
//  721 {
        FUNCALL ZDSecMgrAppKeyGet, SSP_GetTrueRand
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x9
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 0
        MOV     A,#0xd
        LCALL   ?XSTACK_DISP0_8
        LCALL   ?Subroutine29 & 0xFFFF
??CrossCallReturnLabel_24:
        MOV     R2,A
        MOV     A,R1
        MOV     R3,A
        MOV     A,#0xf
        LCALL   ?XSTACK_DISP0_8
        LCALL   ?Subroutine29 & 0xFFFF
??CrossCallReturnLabel_25:
        MOV     R6,A
        MOV     A,R1
        MOV     R7,A
//  722   // Intentionally unreferenced parameters
//  723   (void)initNwkAddr;
//  724   (void)initExtAddr;
//  725   (void)partNwkAddr;
//  726   (void)partExtAddr;
//  727 
//  728   //---------------------------------------------------------------------------
//  729   // note:
//  730   // should use a robust mechanism to generate keys, for example
//  731   // combine EXT addresses and call a hash function
//  732   //---------------------------------------------------------------------------
//  733   SSP_GetTrueRand( SEC_KEY_LEN, *key );
        ; Setup parameters for call to function SSP_GetTrueRand
        MOV     DPL,R2
        MOV     DPH,R3
        LCALL   ??Subroutine59_0 & 0xFFFF
??CrossCallReturnLabel_93:
        MOV     R1,#0x10
        LCALL   ??SSP_GetTrueRand?relay
//  734 
//  735   *keyType = ZDSecMgrAppKeyType;
        MOV     DPTR,#ZDSecMgrAppKeyType
        MOVX    A,@DPTR
        MOV     DPL,R6
        MOV     DPH,R7
        MOVX    @DPTR,A
//  736 
//  737   return ZSuccess;
        MOV     R1,#0x0
        LJMP    ??Subroutine68_0 & 0xFFFF
          CFI EndBlock cfiBlock68
//  738 }
//  739 
//  740 /******************************************************************************
//  741  * @fn          ZDSecMgrAppKeyReq
//  742  *
//  743  * @brief       Process request for APP key between two devices.
//  744  *
//  745  * @param       device - [in] ZDO_RequestKeyInd_t, request info
//  746  *
//  747  * @return      none
//  748  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  749 void ZDSecMgrAppKeyReq( ZDO_RequestKeyInd_t* ind )
ZDSecMgrAppKeyReq:
          CFI Block cfiBlock69 Using cfiCommon0
          CFI Function ZDSecMgrAppKeyReq
        CODE
//  750 {
        FUNCALL ZDSecMgrAppKeyReq, APSME_LookupNwkAddr
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 49, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 49, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrAppKeyReq, APSME_LookupExtAddr
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 49, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 49, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrAppKeyReq, SSP_GetTrueRand
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 49, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 49, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrAppKeyReq, APSME_TransportKeyReq
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 49, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 49, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrAppKeyReq, APSME_TransportKeyReq
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 49, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 49, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrAppKeyReq, osal_memset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 49, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 49, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0xa
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 10)
        ; Saved register size: 10
        ; Auto size: 39
        MOV     A,#-0x27
        LCALL   ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 49)
        MOV     ?V0 + 0,R2
        MOV     ?V0 + 1,R3
//  751   APSME_TransportKeyReq_t req;
//  752   uint8                   initExtAddr[Z_EXTADDR_LEN];
//  753   uint16                  partNwkAddr;
//  754   uint8                   key[SEC_KEY_LEN];
//  755 
//  756 
//  757   // validate initiator and partner
//  758   if ( ( APSME_LookupNwkAddr( ind->partExtAddr, &partNwkAddr ) == TRUE ) &&
//  759        ( APSME_LookupExtAddr( ind->srcAddr, initExtAddr ) == TRUE      )   )
        MOV     A,R2
        ADD     A,#0x5
        LCALL   ?Subroutine36 & 0xFFFF
??CrossCallReturnLabel_43:
        LCALL   ??APSME_LookupNwkAddr?relay
        MOV     A,R1
        XRL     A,#0x1
        JZ      $+5
        LJMP    ??ZDSecMgrAppKeyReq_0 & 0xFFFF
        MOV     A,?V0 + 0
        ADD     A,#0x2
        MOV     R0,A
        MOV     A,?V0 + 1
        LCALL   ??Subroutine56_0 & 0xFFFF
??CrossCallReturnLabel_82:
        ; Setup parameters for call to function APSME_LookupExtAddr
        MOV     A,#0xf
        LCALL   ?XSTACK_DISP0_8
        MOV     R4,DPL
        MOV     R5,DPH
        MOV     DPL,R0
        MOV     DPH,R1
        LCALL   ??Subroutine59_0 & 0xFFFF
??CrossCallReturnLabel_94:
        LCALL   ??APSME_LookupExtAddr?relay
        MOV     A,R1
        XRL     A,#0x1
        JZ      $+5
        LJMP    ??ZDSecMgrAppKeyReq_0 & 0xFFFF
//  760   {
//  761     // point the key to some memory
//  762     req.key = key;
        MOV     A,#0x17
        LCALL   ?XSTACK_DISP0_8
        MOV     R0,DPL
        MOV     R1,DPH
        MOV     A,#0x6
        LCALL   ?XSTACK_DISP0_8
        LCALL   ??Subroutine63_0 & 0xFFFF
//  763 
//  764     // get an APP key - option APP (MASTER or LINK) key
//  765     if ( ZDSecMgrAppKeyGet( ind->srcAddr,
//  766                             initExtAddr,
//  767                             partNwkAddr,
//  768                             ind->partExtAddr,
//  769                             &req.key,
//  770                             &req.keyType ) == ZSuccess )
??CrossCallReturnLabel_120:
        ; Setup parameters for call to function SSP_GetTrueRand
        MOV     A,#0x17
        LCALL   ?XSTACK_DISP0_8
        MOV     R2,DPL
        MOV     R3,DPH
        MOV     R1,#0x10
        LCALL   ??SSP_GetTrueRand?relay
        MOV     DPTR,#ZDSecMgrAppKeyType
        MOVX    A,@DPTR
        PUSH    A
          CFI CFA_SP SP+-1
        MOV     A,#0x4
        LCALL   ?XSTACK_DISP0_8
        POP     A
          CFI CFA_SP SP+0
        MOVX    @DPTR,A
//  771     {
//  772       // always secure
//  773       req.nwkSecure = TRUE;
        MOV     A,#0xc
        LCALL   ?XSTACK_DISP0_8
        MOV     A,#0x1
        MOVX    @DPTR,A
//  774       req.apsSecure = TRUE;
        MOV     A,#0xb
        LCALL   ?XSTACK_DISP0_8
        MOV     A,#0x1
        MOVX    @DPTR,A
//  775       req.tunnel    = NULL;
        MOV     A,#0xd
        LCALL   ?XSTACK_DISP0_8
        CLR     A
        MOVX    @DPTR,A
        INC     DPTR
        LCALL   ?Subroutine16 & 0xFFFF
//  776 
//  777       // send key to initiator device
//  778       req.dstAddr   = ind->srcAddr;
??CrossCallReturnLabel_4:
        LCALL   ?XSTACK_DISP0_8
        LCALL   ??Subroutine63_0 & 0xFFFF
//  779       req.extAddr   = ind->partExtAddr;
??CrossCallReturnLabel_121:
        MOV     A,#0x8
        LCALL   ?XSTACK_DISP0_8
        MOV     A,R6
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R7
        MOVX    @DPTR,A
//  780       req.initiator = TRUE;
        MOV     A,#0xa
        LCALL   ?XSTACK_DISP0_8
        MOV     A,#0x1
        MOVX    @DPTR,A
//  781       APSME_TransportKeyReq( &req );
        ; Setup parameters for call to function APSME_TransportKeyReq
        INC     A
        LCALL   ?XSTACK_DISP0_8
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??APSME_TransportKeyReq?relay
//  782 
//  783       // send key to partner device
//  784       req.dstAddr   = partNwkAddr;
        LCALL   ?Subroutine30 & 0xFFFF
??CrossCallReturnLabel_173:
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        LCALL   ??Subroutine63_0 & 0xFFFF
//  785       req.extAddr   = initExtAddr;
??CrossCallReturnLabel_122:
        MOV     A,#0xf
        LCALL   ?XSTACK_DISP0_8
        MOV     R0,DPL
        MOV     R1,DPH
        MOV     A,#0x8
        LCALL   ?XSTACK_DISP0_8
        LCALL   ??Subroutine63_0 & 0xFFFF
//  786       req.initiator = FALSE;
??CrossCallReturnLabel_123:
        MOV     A,#0xa
        LCALL   ?XSTACK_DISP0_8
        CLR     A
        MOVX    @DPTR,A
//  787 
//  788       APSME_TransportKeyReq( &req );
        ; Setup parameters for call to function APSME_TransportKeyReq
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??APSME_TransportKeyReq?relay
//  789 
//  790       // clear copy of key in RAM
//  791       osal_memset( key, 0x00, SEC_KEY_LEN);
        ; Setup parameters for call to function osal_memset
        MOV     R4,#0x10
        MOV     R5,#0x0
        MOV     R1,#0x0
        MOV     A,#0x17
        LCALL   ?XSTACK_DISP0_8
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??osal_memset?relay
//  792 
//  793     }
//  794   }
//  795 }
??ZDSecMgrAppKeyReq_0:
        MOV     A,#0x27
        LJMP    ??Subroutine72_0 & 0xFFFF
          CFI EndBlock cfiBlock69
//  796 
//  797 /******************************************************************************
//  798  * @fn          ZDSecMgrSendNwkKey
//  799  *
//  800  * @brief       Send NWK key to device joining network.
//  801  *
//  802  * @param       device - [in] ZDSecMgrDevice_t, device info
//  803  *
//  804  * @return      ZStatus_t
//  805  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  806 ZStatus_t ZDSecMgrSendNwkKey( ZDSecMgrDevice_t* device )
ZDSecMgrSendNwkKey:
          CFI Block cfiBlock70 Using cfiCommon0
          CFI Function ZDSecMgrSendNwkKey
        CODE
//  807 {
        FUNCALL ZDSecMgrSendNwkKey, NLME_ReadNwkKeyInfo
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 50, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 50, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrSendNwkKey, osal_memset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 46, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 46, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrSendNwkKey, NLME_GetShortAddr
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 46, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 46, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrSendNwkKey, APSME_TransportKeyReq
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 46, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 46, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrSendNwkKey, osal_memset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 46, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 46, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0xc
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 12)
        ; Saved register size: 12
        ; Auto size: 34
        MOV     A,#-0x22
        LCALL   ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 46)
        MOV     A,R2
        MOV     R6,A
        MOV     A,R3
        MOV     R7,A
//  808   ZStatus_t status;
//  809   APSME_TransportKeyReq_t req;
//  810   APSDE_FrameTunnel_t tunnel;
//  811   nwkKeyDesc tmpKey;
//  812 
//  813   req.dstAddr   = device->nwkAddr;
        MOV     DPL,R6
        MOV     DPH,R7
        LCALL   ??Subroutine70_0 & 0xFFFF
??CrossCallReturnLabel_167:
        MOV     A,#0x4
        LCALL   ?XSTACK_DISP0_8
        LCALL   ??Subroutine63_0 & 0xFFFF
//  814   req.extAddr   = device->extAddr;
??CrossCallReturnLabel_124:
        LCALL   ?Subroutine38 & 0xFFFF
??CrossCallReturnLabel_84:
        MOV     DPL,R0
        MOV     DPH,A
        LCALL   ??Subroutine70_0 & 0xFFFF
??CrossCallReturnLabel_168:
        MOV     A,#0xa
        LCALL   ?XSTACK_DISP0_8
        LCALL   ??Subroutine63_0 & 0xFFFF
//  815 
//  816   req.keyType   = KEY_TYPE_NWK;
??CrossCallReturnLabel_125:
        MOV     A,#0x6
        LCALL   ?XSTACK_DISP0_8
        MOV     A,#0x1
        MOVX    @DPTR,A
//  817 
//  818   // get the Active Key into a local variable
//  819   if ( NLME_ReadNwkKeyInfo( 0, sizeof(tmpKey), &tmpKey,
//  820                            ZCD_NV_NWK_ACTIVE_KEY_INFO ) != SUCCESS )
        ; Setup parameters for call to function NLME_ReadNwkKeyInfo
        MOV     ?V0 + 2,#0x3a
        MOV     ?V0 + 3,#0x0
        MOV     R0,#?V0 + 2
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 48)
        MOV     A,#0x13
        LCALL   ?XSTACK_DISP0_8
        MOV     ?V0 + 2,DPL
        MOV     ?V0 + 3,DPH
        MOV     R0,#?V0 + 2
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 50)
        MOV     R4,#0x11
        MOV     R5,#0x0
        MOV     R2,#0x0
        MOV     R3,#0x0
        LCALL   ??NLME_ReadNwkKeyInfo?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 46)
        MOV     A,R1
        JZ      ??ZDSecMgrSendNwkKey_0
//  821   {
//  822     // set key data to all 0s if NV read fails
//  823     osal_memset(&tmpKey, 0x00, sizeof(tmpKey));
        ; Setup parameters for call to function osal_memset
        MOV     R4,#0x11
        MOV     R5,#0x0
        MOV     R1,#0x0
        MOV     A,R4
        LCALL   ?XSTACK_DISP0_8
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??osal_memset?relay
//  824   }
//  825 
//  826   if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_SE_STANDARD )
//  827   {
//  828     // set values
//  829     req.keySeqNum = tmpKey.keySeqNum;
??ZDSecMgrSendNwkKey_0:
        MOV     A,#0x11
        LCALL   ?XSTACK_DISP0_8
        MOVX    A,@DPTR
        PUSH    A
          CFI CFA_SP SP+-1
        MOV     A,#0x7
        LCALL   ?XSTACK_DISP0_8
        POP     A
          CFI CFA_SP SP+0
        MOVX    @DPTR,A
//  830     req.key       = tmpKey.key;
        MOV     A,#0x12
        LCALL   ?XSTACK_DISP0_8
        MOV     R0,DPL
        MOV     R1,DPH
        MOV     A,#0x8
        LCALL   ?XSTACK_DISP0_8
        LCALL   ??Subroutine63_0 & 0xFFFF
//  831 
//  832     //devtag.pro.security.todo - make sure that if there is no link key the NWK
//  833     //key isn't used to secure the frame at the APS layer -- since the receiving
//  834     //device may not have a NWK key yet
//  835     req.apsSecure = TRUE;
??CrossCallReturnLabel_126:
        MOV     A,#0xd
        LCALL   ?XSTACK_DISP0_8
        MOV     A,#0x1
        MOVX    @DPTR,A
//  836 
//  837     // check if using secure hop to parent
//  838     if ( device->parentAddr == NLME_GetShortAddr() )
        ; Setup parameters for call to function NLME_GetShortAddr
        LCALL   ??NLME_GetShortAddr?relay
        MOV     A,R6
        ADD     A,#0x4
        MOV     R0,A
        MOV     A,R7
        ADDC    A,#0x0
        MOV     R1,A
        MOV     DPL,R0
        MOV     DPH,R1
        MOVX    A,@DPTR
        XRL     A,R2
        JNZ     ??ZDSecMgrSendNwkKey_1
        INC     DPTR
        MOVX    A,@DPTR
        XRL     A,R3
??ZDSecMgrSendNwkKey_1:
        JNZ     ??ZDSecMgrSendNwkKey_2
//  839     {
//  840       req.nwkSecure = FALSE;
        MOV     A,#0xe
        LCALL   ?XSTACK_DISP0_8
        CLR     A
        MOVX    @DPTR,A
//  841       req.tunnel    = NULL;
        MOV     A,#0xf
        LCALL   ?XSTACK_DISP0_8
        CLR     A
        MOVX    @DPTR,A
        INC     DPTR
        SJMP    ??ZDSecMgrSendNwkKey_3
//  842     }
//  843     else
//  844     {
//  845       req.nwkSecure   = TRUE;
??ZDSecMgrSendNwkKey_2:
        MOV     A,#0xe
        LCALL   ?XSTACK_DISP0_8
        MOV     A,#0x1
        LCALL   ??Subroutine64_0 & 0xFFFF
//  846       req.tunnel      = &tunnel;
//  847       req.tunnel->tna = device->parentAddr;
//  848       req.tunnel->dea = device->extAddr;
//  849     }
//  850   }
??CrossCallReturnLabel_140:
        MOV     A,#0xf
        LCALL   ?XSTACK_DISP0_8
        LCALL   ?Subroutine17 & 0xFFFF
??CrossCallReturnLabel_6:
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     A,R0
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R1
        LCALL   ?Subroutine16 & 0xFFFF
??CrossCallReturnLabel_5:
        LCALL   ?XSTACK_DISP0_8
        MOV     A,R0
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R1
??ZDSecMgrSendNwkKey_3:
        MOVX    @DPTR,A
//  851   else
//  852   {
//  853     // default values
//  854     //devtag.0604.verify
//  855     req.nwkSecure = TRUE;
//  856     req.apsSecure = FALSE;
//  857     req.tunnel    = NULL;
//  858 
//  859     if ( device->parentAddr != NLME_GetShortAddr() )
//  860     {
//  861       req.dstAddr = device->parentAddr;
//  862     }
//  863 
//  864     // send the real key
//  865     if ( zgPreConfigKeys == FALSE )
//  866     {
//  867       req.keySeqNum = tmpKey.keySeqNum;
//  868       req.key       = tmpKey.key;
//  869 
//  870       // check if using secure hop to to parent
//  871       if ( device->parentAddr == NLME_GetShortAddr() )
//  872       {
//  873         req.nwkSecure = FALSE;
//  874       }
//  875     }
//  876     else
//  877     {
//  878       // this is to send the all zero key when the NWK key has been preconfigured
//  879       req.key       = NULL;
//  880       req.keySeqNum = 0;
//  881     }
//  882   }
//  883 
//  884   status = APSME_TransportKeyReq( &req );
        ; Setup parameters for call to function APSME_TransportKeyReq
        MOV     A,#0x4
        LCALL   ?XSTACK_DISP0_8
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??APSME_TransportKeyReq?relay
        MOV     A,R1
        MOV     R6,A
//  885 
//  886   // clear copy of key in RAM before return
//  887   osal_memset( &tmpKey, 0x00, sizeof(nwkKeyDesc) );
        ; Setup parameters for call to function osal_memset
        MOV     R4,#0x11
        MOV     R5,#0x0
        MOV     R1,#0x0
        MOV     A,R4
        LCALL   ?XSTACK_DISP0_8
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??osal_memset?relay
//  888 
//  889   return status;
        MOV     A,R6
        MOV     R1,A
        MOV     A,#0x22
        LJMP    ?Subroutine3 & 0xFFFF
          CFI EndBlock cfiBlock70
//  890 }

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine38:
          CFI Block cfiCond71 Using cfiCommon0
          CFI Function ZDSecMgrEntryFree
          CFI Conditional ??CrossCallReturnLabel_83
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V7 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 20)
          CFI Block cfiCond72 Using cfiCommon0
          CFI (cfiCond72) Function ZDSecMgrSendNwkKey
          CFI (cfiCond72) Conditional ??CrossCallReturnLabel_84
          CFI (cfiCond72) R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond72) VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond72) V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond72) V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond72) V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond72) V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond72) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond72) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond72) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond72) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond72) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond72) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond72) CFA_SP SP+0
          CFI (cfiCond72) CFA_XSP16 add(XSP16, 46)
          CFI Block cfiCond73 Using cfiCommon0
          CFI (cfiCond73) Function ZDSecMgrDeviceJoin
          CFI (cfiCond73) Conditional ??CrossCallReturnLabel_85
          CFI (cfiCond73) R6 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond73) VB load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond73) V0 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond73) V1 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond73) V2 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond73) V3 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond73) V4 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond73) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond73) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond73) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond73) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond73) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond73) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond73) CFA_SP SP+0
          CFI (cfiCond73) CFA_XSP16 add(XSP16, 15)
          CFI Block cfiPicker74 Using cfiCommon1
          CFI (cfiPicker74) NoFunction
          CFI (cfiPicker74) Picker
        MOV     A,R6
        ADD     A,#0x2
        MOV     R0,A
        MOV     A,R7
          CFI EndBlock cfiCond71
          CFI EndBlock cfiCond72
          CFI EndBlock cfiCond73
          CFI EndBlock cfiPicker74
        REQUIRE ??Subroutine56_0
        ; // Fall through to label ??Subroutine56_0

        RSEG BANKED_CODE:CODE:NOROOT(0)
??Subroutine56_0:
          CFI Block cfiCond75 Using cfiCommon0
          CFI Function ZDSecMgrAppKeyReq
          CFI Conditional ??CrossCallReturnLabel_82
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 49)
          CFI Block cfiCond76 Using cfiCommon0
          CFI (cfiCond76) Function ZDSecMgrEntryFree
          CFI (cfiCond76) Conditional ??CrossCallReturnLabel_83
          CFI (cfiCond76) R6 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI (cfiCond76) VB load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond76) V0 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond76) V1 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond76) V2 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond76) V3 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond76) V4 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond76) V5 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond76) V6 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond76) V7 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond76) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond76) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond76) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond76) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond76) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond76) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond76) CFA_SP SP+0
          CFI (cfiCond76) CFA_XSP16 add(XSP16, 20)
          CFI Block cfiCond77 Using cfiCommon0
          CFI (cfiCond77) Function ZDSecMgrSendNwkKey
          CFI (cfiCond77) Conditional ??CrossCallReturnLabel_84
          CFI (cfiCond77) R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond77) VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond77) V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond77) V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond77) V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond77) V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond77) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond77) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond77) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond77) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond77) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond77) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond77) CFA_SP SP+0
          CFI (cfiCond77) CFA_XSP16 add(XSP16, 46)
          CFI Block cfiCond78 Using cfiCommon0
          CFI (cfiCond78) Function ZDSecMgrDeviceJoin
          CFI (cfiCond78) Conditional ??CrossCallReturnLabel_85
          CFI (cfiCond78) R6 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond78) VB load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond78) V0 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond78) V1 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond78) V2 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond78) V3 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond78) V4 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond78) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond78) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond78) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond78) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond78) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond78) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond78) CFA_SP SP+0
          CFI (cfiCond78) CFA_XSP16 add(XSP16, 15)
          CFI Block cfiPicker79 Using cfiCommon1
          CFI (cfiPicker79) NoFunction
          CFI (cfiPicker79) Picker
        ADDC    A,#0x0
        MOV     R1,A
        MOV     ?V0 + 0,R0
        MOV     ?V0 + 1,R1
        RET
          CFI EndBlock cfiCond75
          CFI EndBlock cfiCond76
          CFI EndBlock cfiCond77
          CFI EndBlock cfiCond78
          CFI EndBlock cfiPicker79

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine16:
          CFI Block cfiCond80 Using cfiCommon0
          CFI Function ZDSecMgrAppKeyReq
          CFI Conditional ??CrossCallReturnLabel_4
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 49)
          CFI Block cfiCond81 Using cfiCommon0
          CFI (cfiCond81) Function ZDSecMgrSendNwkKey
          CFI (cfiCond81) Conditional ??CrossCallReturnLabel_5
          CFI (cfiCond81) R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond81) VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond81) V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond81) V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond81) V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond81) V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond81) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond81) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond81) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond81) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond81) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond81) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond81) CFA_SP SP+0
          CFI (cfiCond81) CFA_XSP16 add(XSP16, 46)
          CFI Block cfiPicker82 Using cfiCommon1
          CFI (cfiPicker82) NoFunction
          CFI (cfiPicker82) Picker
        MOVX    @DPTR,A
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        LCALL   ?Subroutine46 & 0xFFFF
??CrossCallReturnLabel_175:
        MOV     A,#0x2
        RET
          CFI EndBlock cfiCond80
          CFI EndBlock cfiCond81
          CFI EndBlock cfiPicker82
//  891 
//  892 /******************************************************************************
//  893  * @fn          ZDSecMgrDeviceRemoveByExtAddr
//  894  *
//  895  * @brief       Remove device entry by its ext address.
//  896  *
//  897  * @param       pAddr - pointer to the extended address
//  898  *
//  899  * @return      ZStatus_t
//  900  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  901 ZStatus_t ZDSecMgrDeviceRemoveByExtAddr( uint8 *pAddr )
ZDSecMgrDeviceRemoveByExtAddr:
          CFI Block cfiBlock83 Using cfiCommon0
          CFI Function ZDSecMgrDeviceRemoveByExtAddr
        CODE
//  902 {
        FUNCALL ZDSecMgrDeviceRemoveByExtAddr, ZDSecMgrEntryLookupExt
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 11, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 11, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrDeviceRemoveByExtAddr, ZDSecMgrEntryFree
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 11, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 11, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x9
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 2
        MOV     A,#-0x2
        LCALL   ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 11)
//  903   ZDSecMgrEntry_t *pEntry;
//  904   uint8           retValue;
//  905 
//  906   retValue = (uint8)ZDSecMgrEntryLookupExt( pAddr, &pEntry );
        ; Setup parameters for call to function ZDSecMgrEntryLookupExt
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     R4,DPL
        MOV     R5,DPH
        LCALL   ??ZDSecMgrEntryLookupExt?relay
        MOV     A,R1
        MOV     R6,A
//  907 
//  908   if( retValue == ZSuccess )
        JNZ     ??ZDSecMgrDeviceRemoveByExtAddr_0
//  909   {
//  910     // remove device from entry data
//  911     ZDSecMgrEntryFree( pEntry );
        ; Setup parameters for call to function ZDSecMgrEntryFree
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        LCALL   ??Subroutine59_0 & 0xFFFF
//  912   }
??CrossCallReturnLabel_95:
        LCALL   ??ZDSecMgrEntryFree?relay
//  913 
//  914   return retValue;
??ZDSecMgrDeviceRemoveByExtAddr_0:
        MOV     A,R6
        MOV     R1,A
        LJMP    ?Subroutine7 & 0xFFFF
          CFI EndBlock cfiBlock83
//  915 }
//  916 
//  917 /******************************************************************************
//  918  * @fn          ZDSecMgrDeviceRemove
//  919  *
//  920  * @brief       Remove device from network.
//  921  *
//  922  * @param       device - [in] ZDSecMgrDevice_t, device info
//  923  *
//  924  * @return      none
//  925  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  926 void ZDSecMgrDeviceRemove( ZDSecMgrDevice_t* device )
ZDSecMgrDeviceRemove:
          CFI Block cfiBlock84 Using cfiCommon0
          CFI Function ZDSecMgrDeviceRemove
        CODE
//  927 {
        FUNCALL ZDSecMgrDeviceRemove, NLME_GetShortAddr
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 20, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 20, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrDeviceRemove, AssocGetWithExt
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 20, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 20, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrDeviceRemove, NLME_LeaveReq
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 20, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 20, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrDeviceRemove, NLME_GetShortAddr
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 20, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 20, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrDeviceRemove, NLME_LeaveReq
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 20, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 20, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrDeviceRemove, APSME_RemoveDeviceReq
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 20, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 20, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrDeviceRemove, APSME_RemoveDeviceReq
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 20, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 20, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0xa
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 10)
        ; Saved register size: 10
        ; Auto size: 10
        MOV     A,#-0xa
        LCALL   ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 20)
        MOV     A,R2
        MOV     R6,A
        MOV     A,R3
        MOV     R7,A
//  928   APSME_RemoveDeviceReq_t remDevReq;
//  929   NLME_LeaveReq_t         leaveReq;
//  930   associated_devices_t*   assoc;
//  931 
//  932   // check if parent, remove the device
//  933   if ( device->parentAddr == NLME_GetShortAddr() )
        ; Setup parameters for call to function NLME_GetShortAddr
        LCALL   ??NLME_GetShortAddr?relay
        MOV     ?V0 + 0,R2
        MOV     ?V0 + 1,R3
        MOV     DPL,R6
        MOV     DPH,R7
        INC     DPTR
        INC     DPTR
        LCALL   ??Subroutine58_0 & 0xFFFF
??CrossCallReturnLabel_105:
        MOV     A,R6
        ADD     A,#0x2
        MOV     R0,A
        MOV     A,R7
        ADDC    A,#0x0
        MOV     R1,A
        MOV     A,?V0 + 0
        XRL     A,R2
        JNZ     ??ZDSecMgrDeviceRemove_0
        MOV     A,?V0 + 1
        XRL     A,R3
??ZDSecMgrDeviceRemove_0:
        JZ      $+5
        LJMP    ??ZDSecMgrDeviceRemove_1 & 0xFFFF
//  934   {
//  935     // this is the parent of the device
//  936     leaveReq.extAddr        = device->extAddr;
        MOV     DPL,R0
        MOV     DPH,R1
        LCALL   ??Subroutine59_0 & 0xFFFF
??CrossCallReturnLabel_96:
        LCALL   ?Subroutine21 & 0xFFFF
//  937     leaveReq.removeChildren = FALSE;
??CrossCallReturnLabel_86:
        LCALL   ?XSTACK_DISP0_8
        CLR     A
        MOVX    @DPTR,A
//  938     leaveReq.rejoin         = FALSE;
        MOV     A,#0x3
        LCALL   ?XSTACK_DISP0_8
        CLR     A
        MOVX    @DPTR,A
//  939 
//  940     // find child association
//  941     assoc = AssocGetWithExt( device->extAddr );
        ; Setup parameters for call to function AssocGetWithExt
        MOV     DPL,R0
        MOV     DPH,R1
        LCALL   ??Subroutine59_0 & 0xFFFF
??CrossCallReturnLabel_97:
        LCALL   ??AssocGetWithExt?relay
        MOV     ?V0 + 0,R2
        MOV     ?V0 + 1,R3
        MOV     R0,?V0 + 0
        MOV     R1,?V0 + 1
//  942 
//  943     if ( ( assoc != NULL                            ) &&
//  944          ( assoc->nodeRelation >= CHILD_RFD         ) &&
//  945          ( assoc->nodeRelation <= CHILD_FFD_RX_IDLE )    )
        MOV     A,R0
        ORL     A,R1
        JZ      ??ZDSecMgrDeviceRemove_2
        MOV     DPL,R0
        MOV     DPH,R1
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        DEC     A
        CLR     C
        SUBB    A,#0x4
        JNC     ??ZDSecMgrDeviceRemove_2
//  946     {
//  947       // check if associated device is authenticated
//  948       if ( assoc->devStatus & DEV_SEC_AUTH_STATUS )
        MOV     DPL,R0
        MOV     DPH,R1
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        MOV     C,0xE0 /* A   */.3
        MOV     A,#0x4
        JC      ??ZDSecMgrDeviceRemove_3
//  949       {
//  950         leaveReq.silent = FALSE;
//  951       }
//  952       else
//  953       {
//  954         leaveReq.silent = TRUE;
        LCALL   ?XSTACK_DISP0_8
        MOV     A,#0x1
        SJMP    ??ZDSecMgrDeviceRemove_4
        ; Setup parameters for call to function NLME_LeaveReq
//  955       }
//  956 
//  957       NLME_LeaveReq( &leaveReq );
//  958     }
//  959     else if ( device->nwkAddr == NLME_GetShortAddr() )
??ZDSecMgrDeviceRemove_2:
        ; Setup parameters for call to function NLME_GetShortAddr
        LCALL   ??NLME_GetShortAddr?relay
        MOV     ?V0 + 0,R2
        MOV     ?V0 + 1,R3
        MOV     R0,?V0 + 0
        MOV     R1,?V0 + 1
        MOV     DPL,R6
        MOV     DPH,R7
        MOVX    A,@DPTR
        XRL     A,R0
        JNZ     ??ZDSecMgrDeviceRemove_5
        INC     DPTR
        MOVX    A,@DPTR
        XRL     A,R1
??ZDSecMgrDeviceRemove_5:
        JNZ     ??ZDSecMgrDeviceRemove_6
//  960     {
//  961       // this is when ZC wants that ZR removes itself from the network
//  962       leaveReq.extAddr = NULL;
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        CLR     A
        MOVX    @DPTR,A
        INC     DPTR
        MOVX    @DPTR,A
//  963       leaveReq.silent = FALSE;
        MOV     A,#0x4
??ZDSecMgrDeviceRemove_3:
        LCALL   ?XSTACK_DISP0_8
        CLR     A
//  964 
//  965       NLME_LeaveReq( &leaveReq );
//  966     }
//  967   }
??ZDSecMgrDeviceRemove_4:
        LCALL   ??Subroutine64_0 & 0xFFFF
??CrossCallReturnLabel_141:
        LCALL   ??NLME_LeaveReq?relay
        SJMP    ??ZDSecMgrDeviceRemove_6
//  968   else
//  969   {
//  970     // this is not the parent of the device
//  971     remDevReq.parentAddr   = device->parentAddr;
??ZDSecMgrDeviceRemove_1:
        MOV     A,#0x5
        LCALL   ?XSTACK_DISP0_8
        LCALL   ?Subroutine17 & 0xFFFF
//  972     remDevReq.childExtAddr = device->extAddr;
??CrossCallReturnLabel_7:
        MOV     A,#0x7
        LCALL   ?XSTACK_DISP0_8
        LCALL   ??Subroutine63_0 & 0xFFFF
//  973 
//  974 #if defined ( APP_TP2_TEST_MODE )
//  975     if ( guTxApsSecON == TRUE )
//  976     {
//  977       remDevReq.apsSecure = TRUE;
//  978     }
//  979     else
//  980     {
//  981       remDevReq.apsSecure = FALSE;
//  982     }
//  983 
//  984     APSME_RemoveDeviceReq( &remDevReq );
//  985 
//  986 #else
//  987     if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_SE_STANDARD )
//  988     {
//  989       // For ZG_GLOBAL_LINK_KEY the message has to be sent twice, one
//  990       // APS un-encrypted and one APS encrypted, to make sure that it can interoperate
//  991       // with legacy Coordinator devices which can only handle one or the other.
//  992       if ( zgApsLinkKeyType == ZG_GLOBAL_LINK_KEY )
??CrossCallReturnLabel_127:
        MOV     DPTR,#zgApsLinkKeyType
        MOVX    A,@DPTR
        XRL     A,#0x1
        JNZ     ??ZDSecMgrDeviceRemove_7
//  993       {
//  994         remDevReq.apsSecure = FALSE;
        MOV     A,#0x9
        LCALL   ?XSTACK_DISP0_8
        CLR     A
        MOVX    @DPTR,A
//  995 
//  996         APSME_RemoveDeviceReq( &remDevReq );
        ; Setup parameters for call to function APSME_RemoveDeviceReq
        MOV     A,#0x5
        LCALL   ?XSTACK_DISP0_8
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??APSME_RemoveDeviceReq?relay
//  997       }
//  998 
//  999       remDevReq.apsSecure = TRUE;
??ZDSecMgrDeviceRemove_7:
        MOV     A,#0x9
        LCALL   ?XSTACK_DISP0_8
        MOV     A,#0x1
        MOVX    @DPTR,A
// 1000 
// 1001       APSME_RemoveDeviceReq( &remDevReq );
        ; Setup parameters for call to function APSME_RemoveDeviceReq
        MOV     A,#0x5
        LCALL   ?XSTACK_DISP0_8
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??APSME_RemoveDeviceReq?relay
// 1002     }
// 1003     else
// 1004     {
// 1005       remDevReq.apsSecure = FALSE;
// 1006 
// 1007       APSME_RemoveDeviceReq( &remDevReq );
// 1008     }
// 1009 #endif
// 1010   }
// 1011 }
??ZDSecMgrDeviceRemove_6:
        MOV     A,#0xa
        LJMP    ??Subroutine72_0 & 0xFFFF
          CFI EndBlock cfiBlock84

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine21:
          CFI Block cfiCond85 Using cfiCommon0
          CFI Function ZDSecMgrDeviceRemove
          CFI Conditional ??CrossCallReturnLabel_86
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 20)
          CFI Block cfiCond86 Using cfiCommon0
          CFI (cfiCond86) Function ZDSecMgrAPSRemove
          CFI (cfiCond86) Conditional ??CrossCallReturnLabel_87
          CFI (cfiCond86) DPL0 Frame(CFA_SP, 4)
          CFI (cfiCond86) DPH0 Frame(CFA_SP, 5)
          CFI (cfiCond86) CFA_SP SP+-5
          CFI (cfiCond86) CFA_XSP16 add(XSP16, 8)
          CFI Block cfiPicker87 Using cfiCommon1
          CFI (cfiPicker87) NoFunction
          CFI (cfiPicker87) Picker
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
          CFI EndBlock cfiCond85
          CFI EndBlock cfiCond86
          CFI EndBlock cfiPicker87
        REQUIRE ??Subroutine57_0
        ; // Fall through to label ??Subroutine57_0

        RSEG BANKED_CODE:CODE:NOROOT(0)
??Subroutine57_0:
          CFI Block cfiCond88 Using cfiCommon0
          CFI Function ZDSecMgrRemoveDeviceInd
          CFI Conditional ??CrossCallReturnLabel_88
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 17)
          CFI Block cfiCond89 Using cfiCommon0
          CFI (cfiCond89) Function ZDSecMgrDeviceRemove
          CFI (cfiCond89) Conditional ??CrossCallReturnLabel_86
          CFI (cfiCond89) R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond89) VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond89) V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond89) V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond89) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond89) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond89) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond89) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond89) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond89) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond89) CFA_SP SP+0
          CFI (cfiCond89) CFA_XSP16 add(XSP16, 20)
          CFI Block cfiCond90 Using cfiCommon0
          CFI (cfiCond90) Function ZDSecMgrAPSRemove
          CFI (cfiCond90) Conditional ??CrossCallReturnLabel_87
          CFI (cfiCond90) DPL0 Frame(CFA_SP, 4)
          CFI (cfiCond90) DPH0 Frame(CFA_SP, 5)
          CFI (cfiCond90) CFA_SP SP+-5
          CFI (cfiCond90) CFA_XSP16 add(XSP16, 8)
          CFI Block cfiPicker91 Using cfiCommon1
          CFI (cfiPicker91) NoFunction
          CFI (cfiPicker91) Picker
        LCALL   ??Subroutine62_0 & 0xFFFF
??CrossCallReturnLabel_118:
        MOV     A,#0x2
        RET
          CFI EndBlock cfiCond88
          CFI EndBlock cfiCond89
          CFI EndBlock cfiCond90
          CFI EndBlock cfiPicker91

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine17:
          CFI Block cfiCond92 Using cfiCommon0
          CFI Function ZDSecMgrSendNwkKey
          CFI Conditional ??CrossCallReturnLabel_6
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 46)
          CFI Block cfiCond93 Using cfiCommon0
          CFI (cfiCond93) Function ZDSecMgrDeviceRemove
          CFI (cfiCond93) Conditional ??CrossCallReturnLabel_7
          CFI (cfiCond93) R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond93) VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond93) V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond93) V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond93) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond93) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond93) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond93) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond93) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond93) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond93) CFA_SP SP+0
          CFI (cfiCond93) CFA_XSP16 add(XSP16, 20)
          CFI Block cfiPicker94 Using cfiCommon1
          CFI (cfiPicker94) NoFunction
          CFI (cfiPicker94) Picker
        LCALL   ??Subroutine62_0 & 0xFFFF
??CrossCallReturnLabel_113:
        MOV     DPL,R0
        MOV     DPH,R1
        LCALL   ?Subroutine46 & 0xFFFF
??CrossCallReturnLabel_176:
        RET
          CFI EndBlock cfiCond92
          CFI EndBlock cfiCond93
          CFI EndBlock cfiPicker94
// 1012 
// 1013 /******************************************************************************
// 1014  * @fn          ZDSecMgrDeviceValidateRM (RESIDENTIAL MODE)
// 1015  *
// 1016  * @brief       Decide whether device is allowed.
// 1017  *
// 1018  * @param       device - [in] ZDSecMgrDevice_t, device info
// 1019  *
// 1020  * @return      ZStatus_t
// 1021  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 1022 ZStatus_t ZDSecMgrDeviceValidateRM( ZDSecMgrDevice_t* device )
ZDSecMgrDeviceValidateRM:
          CFI Block cfiBlock95 Using cfiCommon0
          CFI Function ZDSecMgrDeviceValidateRM
        CODE
// 1023 {
        PUSH    DPL
          CFI DPL0 Frame(CFA_SP, 4)
          CFI CFA_SP SP+-4
        PUSH    DPH
          CFI DPH0 Frame(CFA_SP, 5)
          CFI CFA_SP SP+-5
        ; Saved register size: 2
        ; Auto size: 0
// 1024   ZStatus_t status;
// 1025 
// 1026   status = ZSuccess;
        MOV     R1,#0x0
// 1027 
// 1028   (void)device;  // Intentionally unreferenced parameter
// 1029 
// 1030   // For test purpose, turning off the zgSecurePermitJoin flag will force
// 1031   // the trust center to reject any newly joining devices by sending
// 1032   // Remove-device to the parents.
// 1033   if ( zgSecurePermitJoin == FALSE )
        MOV     DPTR,#zgSecurePermitJoin
        MOVX    A,@DPTR
        JNZ     ??ZDSecMgrDeviceValidateRM_0
// 1034   {
// 1035     status = ZNwkUnknownDevice;
        MOV     R1,#-0x38
// 1036   }
// 1037 
// 1038 
// 1039 
// 1040 #if 0  // Taken out because the following functionality is only used for test
// 1041        // purpose. A more efficient (above) way is used. It can be put
// 1042        // back in if customers request for a white/black list feature.
// 1043        // ZDSecMgrStoredDeviceList[] is defined in ZDSecMgr.c
// 1044 
// 1045   // The following code processes the device black list (stored device list)
// 1046   // If the joining device is not part of the forbidden device list
// 1047   // Return ZSuccess. Otherwise, return ZNwkUnknownDevice. The trust center
// 1048   // will send Remove-device and ban the device from joining.
// 1049 
// 1050   uint8     index;
// 1051   uint8*    restricted;
// 1052 
// 1053   // Look through the stored device list - used for restricted devices
// 1054   for ( index = 0; index < ZDSECMGR_STORED_DEVICES; index++ )
// 1055   {
// 1056     restricted = ZDSecMgrStoredDeviceList[index];
// 1057 
// 1058     if ( AddrMgrExtAddrEqual( restricted, device->extAddr )  == TRUE )
// 1059     {
// 1060       // return as unknown device in regards to validation
// 1061       status = ZNwkUnknownDevice;
// 1062 
// 1063       // break from loop
// 1064       index = ZDSECMGR_STORED_DEVICES;
// 1065     }
// 1066   }
// 1067 
// 1068 #endif
// 1069 
// 1070   return status;
??ZDSecMgrDeviceValidateRM_0:
        LJMP    ??Subroutine61_0 & 0xFFFF
          CFI EndBlock cfiBlock95
// 1071 }
// 1072 
// 1073 /******************************************************************************
// 1074  * @fn          ZDSecMgrDeviceValidate
// 1075  *
// 1076  * @brief       Decide whether device is allowed.
// 1077  *
// 1078  * @param       device - [in] ZDSecMgrDevice_t, device info
// 1079  *
// 1080  * @return      ZStatus_t
// 1081  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 1082 ZStatus_t ZDSecMgrDeviceValidate( ZDSecMgrDevice_t* device )
ZDSecMgrDeviceValidate:
          CFI Block cfiBlock96 Using cfiCommon0
          CFI Function ZDSecMgrDeviceValidate
        CODE
// 1083 {
        FUNCALL ZDSecMgrDeviceValidate, ZDSecMgrDeviceValidateRM
        LOCFRAME ISTACK, 2, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 0, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 0, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        PUSH    DPL
          CFI DPL0 Frame(CFA_SP, 4)
          CFI CFA_SP SP+-4
        PUSH    DPH
          CFI DPH0 Frame(CFA_SP, 5)
          CFI CFA_SP SP+-5
        ; Saved register size: 2
        ; Auto size: 0
// 1084   ZStatus_t status;
// 1085 
// 1086   if ( ZDSecMgrPermitJoiningEnabled == TRUE )
        MOV     DPTR,#ZDSecMgrPermitJoiningEnabled
        MOVX    A,@DPTR
        XRL     A,#0x1
        JNZ     ??ZDSecMgrDeviceValidate_0
// 1087   {
// 1088     status = ZDSecMgrDeviceValidateRM( device );
        ; Setup parameters for call to function ZDSecMgrDeviceValidateRM
        LCALL   ??ZDSecMgrDeviceValidateRM?relay
        SJMP    ??ZDSecMgrDeviceValidate_1
// 1089   }
// 1090   else
// 1091   {
// 1092     status = ZNwkUnknownDevice;
??ZDSecMgrDeviceValidate_0:
        MOV     R1,#-0x38
// 1093   }
// 1094 
// 1095   return status;
??ZDSecMgrDeviceValidate_1:
        LJMP    ??Subroutine61_0 & 0xFFFF
          CFI EndBlock cfiBlock96
// 1096 }
// 1097 
// 1098 /******************************************************************************
// 1099  * @fn          ZDSecMgrDeviceJoin
// 1100  *
// 1101  * @brief       Try to join this device.
// 1102  *
// 1103  * @param       device - [in] ZDSecMgrDevice_t, device info
// 1104  *
// 1105  * @return      ZStatus_t
// 1106  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 1107 ZStatus_t ZDSecMgrDeviceJoin( ZDSecMgrDevice_t* device )
ZDSecMgrDeviceJoin:
          CFI Block cfiBlock97 Using cfiCommon0
          CFI Function ZDSecMgrDeviceJoin
        CODE
// 1108 {
        FUNCALL ZDSecMgrDeviceJoin, ZDSecMgrDeviceValidate
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 15, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 15, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrDeviceJoin, ZDSecMgrAddrStore
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 17, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 17, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrDeviceJoin, ZDSecMgrSendNwkKey
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 15, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 15, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrDeviceJoin, ZDSecMgrAddrClear
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 15, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 15, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrDeviceJoin, ZDSecMgrDeviceRemove
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 15, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 15, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0xd
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 13)
        ; Saved register size: 13
        ; Auto size: 2
        MOV     A,#-0x2
        LCALL   ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 15)
        MOV     A,R2
        MOV     R6,A
        MOV     A,R3
        MOV     R7,A
// 1109   ZStatus_t status;
// 1110   uint16    ami;
// 1111 
// 1112   // attempt to validate device
// 1113   status = ZDSecMgrDeviceValidate( device );
        ; Setup parameters for call to function ZDSecMgrDeviceValidate
        LCALL   ??ZDSecMgrDeviceValidate?relay
        MOV     A,R1
        MOV     ?V0 + 4,A
// 1114 
// 1115   if ( status == ZSuccess )
        JNZ     ??ZDSecMgrDeviceJoin_0
// 1116   {
// 1117     // Add the device to the address manager
// 1118     ZDSecMgrAddrStore( device->nwkAddr, device->extAddr, &ami );
        LCALL   ?Subroutine38 & 0xFFFF
??CrossCallReturnLabel_85:
        ; Setup parameters for call to function ZDSecMgrAddrStore
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     ?V0 + 2,DPL
        MOV     ?V0 + 3,DPH
        MOV     R0,#?V0 + 2
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 17)
        MOV     DPL,?V0 + 0
        MOV     DPH,R1
        MOVX    A,@DPTR
        MOV     R4,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R5,A
        MOV     DPL,R6
        MOV     DPH,R7
        LCALL   ??Subroutine59_0 & 0xFFFF
??CrossCallReturnLabel_98:
        LCALL   ??ZDSecMgrAddrStore?relay
        MOV     A,#0x2
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 15)
// 1119 
// 1120     // Only send the key to devices that have not been authenticated
// 1121     if ( ( device->devStatus & DEV_SEC_INIT_STATUS ) &&
// 1122          ( device->secure == FALSE ) )
        MOV     DPL,R6
        MOV     DPH,R7
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        MOV     C,0xE0 /* A   */.2
        JNC     ??ZDSecMgrDeviceJoin_1
        MOV     DPL,R6
        MOV     DPH,R7
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        JNZ     ??ZDSecMgrDeviceJoin_1
// 1123     {
// 1124       //send the nwk key data to the joining device
// 1125       status = ZDSecMgrSendNwkKey( device );
        ; Setup parameters for call to function ZDSecMgrSendNwkKey
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        LCALL   ??ZDSecMgrSendNwkKey?relay
        MOV     A,R1
        MOV     ?V0 + 4,A
// 1126     }
// 1127 
// 1128     if ( status != ZSuccess )
        JZ      ??ZDSecMgrDeviceJoin_1
// 1129     {
// 1130       ZDSecMgrAddrClear( device->extAddr );
        ; Setup parameters for call to function ZDSecMgrAddrClear
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        LCALL   ??Subroutine59_0 & 0xFFFF
// 1131     }
// 1132   }
??CrossCallReturnLabel_99:
        LCALL   ??ZDSecMgrAddrClear?relay
// 1133 
// 1134   if ( status != ZSuccess )
// 1135   {
// 1136     // not allowed or transport key failed, remove the device
// 1137     ZDSecMgrDeviceRemove( device );
??ZDSecMgrDeviceJoin_0:
        ; Setup parameters for call to function ZDSecMgrDeviceRemove
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        LCALL   ??ZDSecMgrDeviceRemove?relay
// 1138   }
// 1139 
// 1140   return status;
??ZDSecMgrDeviceJoin_1:
        MOV     R1,?V0 + 4
        MOV     A,#0x2
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 13)
        MOV     R7,#0x5
        LJMP    ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock97
// 1141 }
// 1142 
// 1143 /******************************************************************************
// 1144  * @fn          ZDSecMgrDeviceJoinDirect
// 1145  *
// 1146  * @brief       Try to join this device as a direct child.
// 1147  *
// 1148  * @param       device - [in] ZDSecMgrDevice_t, device info
// 1149  *
// 1150  * @return      ZStatus_t
// 1151  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 1152 ZStatus_t ZDSecMgrDeviceJoinDirect( ZDSecMgrDevice_t* device )
ZDSecMgrDeviceJoinDirect:
          CFI Block cfiBlock98 Using cfiCommon0
          CFI Function ZDSecMgrDeviceJoinDirect
        CODE
// 1153 {
        FUNCALL ZDSecMgrDeviceJoinDirect, ZDSecMgrDeviceJoin
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrDeviceJoinDirect, AssocGetWithShort
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrDeviceJoinDirect, ZDSecMgrAssocDeviceAuth
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x9
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 0
        MOV     A,R2
        MOV     R6,A
        MOV     A,R3
        MOV     R7,A
// 1154   ZStatus_t status;
// 1155 
// 1156   status = ZDSecMgrDeviceJoin( device );
        ; Setup parameters for call to function ZDSecMgrDeviceJoin
        LCALL   ??ZDSecMgrDeviceJoin?relay
        MOV     A,R1
        MOV     ?V0 + 0,A
// 1157 
// 1158   if ( status == ZSuccess )
        JNZ     ??ZDSecMgrDeviceJoinDirect_0
// 1159   {
// 1160     // set association status to authenticated
// 1161     ZDSecMgrAssocDeviceAuth( AssocGetWithShort( device->nwkAddr ) );
        ; Setup parameters for call to function ZDSecMgrAssocDeviceAuth
        ; Setup parameters for call to function AssocGetWithShort
        MOV     DPL,R6
        MOV     DPH,R7
        LCALL   ??Subroutine59_0 & 0xFFFF
// 1162   }
??CrossCallReturnLabel_100:
        LCALL   ??AssocGetWithShort?relay
        LCALL   ??ZDSecMgrAssocDeviceAuth?relay
// 1163 
// 1164   return status;
??ZDSecMgrDeviceJoinDirect_0:
        MOV     R1,?V0 + 0
        LJMP    ??Subroutine68_0 & 0xFFFF
          CFI EndBlock cfiBlock98
// 1165 }
// 1166 
// 1167 /******************************************************************************
// 1168  * @fn          ZDSecMgrDeviceJoinFwd
// 1169  *
// 1170  * @brief       Forward join to Trust Center.
// 1171  *
// 1172  * @param       device - [in] ZDSecMgrDevice_t, device info
// 1173  *
// 1174  * @return      ZStatus_t
// 1175  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 1176 ZStatus_t ZDSecMgrDeviceJoinFwd( ZDSecMgrDevice_t* device )
ZDSecMgrDeviceJoinFwd:
          CFI Block cfiBlock99 Using cfiCommon0
          CFI Function ZDSecMgrDeviceJoinFwd
        CODE
// 1177 {
        FUNCALL ZDSecMgrDeviceJoinFwd, AssocGetWithShort
        LOCFRAME ISTACK, 2, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 8, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 8, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrDeviceJoinFwd, ZDSecMgrAssocDeviceAuth
        LOCFRAME ISTACK, 2, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 8, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 8, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrDeviceJoinFwd, APSME_UpdateDeviceReq
        LOCFRAME ISTACK, 2, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 8, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 8, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrDeviceJoinFwd, APSME_UpdateDeviceReq
        LOCFRAME ISTACK, 2, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 8, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 8, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        PUSH    DPL
          CFI DPL0 Frame(CFA_SP, 4)
          CFI CFA_SP SP+-4
        PUSH    DPH
          CFI DPH0 Frame(CFA_SP, 5)
          CFI CFA_SP SP+-5
        ; Saved register size: 2
        ; Auto size: 8
        MOV     A,#-0x8
        LCALL   ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 8)
// 1178   ZStatus_t               status;
// 1179   APSME_UpdateDeviceReq_t req;
// 1180 
// 1181   // forward any joining device to the Trust Center -- the Trust Center will
// 1182   // decide if the device is allowed to join
// 1183   status = ZSuccess;
// 1184 
// 1185   // forward authorization to the Trust Center
// 1186   req.dstAddr    = APSME_TRUSTCENTER_NWKADDR;
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        CLR     A
        MOVX    @DPTR,A
        INC     DPTR
        LCALL   ?Subroutine43 & 0xFFFF
// 1187   req.devAddr    = device->nwkAddr;
??CrossCallReturnLabel_52:
        LCALL   ??Subroutine70_0 & 0xFFFF
??CrossCallReturnLabel_169:
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        LCALL   ?Subroutine14 & 0xFFFF
// 1188   req.devExtAddr = device->extAddr;
??CrossCallReturnLabel_0:
        LCALL   ?XSTACK_DISP0_8
        LCALL   ??Subroutine63_0 & 0xFFFF
// 1189 
// 1190   // set security status, option for router to reject if policy set
// 1191   if ( (device->devStatus & DEV_HIGH_SEC_STATUS) )
??CrossCallReturnLabel_128:
        MOV     A,R2
        ADD     A,#0x7
        MOV     DPL,A
        MOV     A,R3
        LCALL   ??Subroutine71_0 & 0xFFFF
??CrossCallReturnLabel_179:
        MOVX    A,@DPTR
        MOV     C,0xE0 /* A   */.7
        JNC     ??ZDSecMgrDeviceJoinFwd_0
// 1192   {
// 1193     if ( device->devStatus & DEV_REJOIN_STATUS )
        MOV     C,0xE0 /* A   */.6
        JNC     ??ZDSecMgrDeviceJoinFwd_1
// 1194     {
// 1195       if ( device->secure == TRUE )
        MOV     DPL,R2
        MOV     DPH,R3
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        XRL     A,#0x1
        JNZ     ??ZDSecMgrDeviceJoinFwd_2
// 1196       {
// 1197         req.status = APSME_UD_HIGH_SECURED_REJOIN;
        MOV     A,#0x6
        LCALL   ?XSTACK_DISP0_8
        MOV     A,#0x4
        SJMP    ??ZDSecMgrDeviceJoinFwd_3
// 1198       }
// 1199       else
// 1200       {
// 1201         req.status = APSME_UD_HIGH_UNSECURED_REJOIN;
??ZDSecMgrDeviceJoinFwd_2:
        MOV     A,#0x6
        LCALL   ?XSTACK_DISP0_8
        MOV     A,#0x7
        SJMP    ??ZDSecMgrDeviceJoinFwd_3
// 1202       }
// 1203     }
// 1204     else
// 1205     {
// 1206       req.status = APSME_UD_HIGH_UNSECURED_JOIN;
??ZDSecMgrDeviceJoinFwd_1:
        MOV     A,#0x6
        LCALL   ?XSTACK_DISP0_8
        MOV     A,#0x5
        SJMP    ??ZDSecMgrDeviceJoinFwd_3
// 1207     }
// 1208   }
// 1209   else
// 1210   {
// 1211     if ( device->devStatus & DEV_REJOIN_STATUS )
??ZDSecMgrDeviceJoinFwd_0:
        MOV     C,0xE0 /* A   */.6
        JNC     ??ZDSecMgrDeviceJoinFwd_4
// 1212     {
// 1213       if ( device->secure == TRUE )
        MOV     DPL,R2
        MOV     DPH,R3
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        XRL     A,#0x1
        JNZ     ??ZDSecMgrDeviceJoinFwd_5
// 1214       {
// 1215         req.status = APSME_UD_STANDARD_SECURED_REJOIN;
        MOV     A,#0x6
        LCALL   ?XSTACK_DISP0_8
        CLR     A
        SJMP    ??ZDSecMgrDeviceJoinFwd_3
// 1216       }
// 1217       else
// 1218       {
// 1219         req.status = APSME_UD_STANDARD_TRUST_CENTER_REJOIN;
??ZDSecMgrDeviceJoinFwd_5:
        MOV     A,#0x6
        LCALL   ?XSTACK_DISP0_8
        MOV     A,#0x3
        SJMP    ??ZDSecMgrDeviceJoinFwd_3
// 1220       }
// 1221     }
// 1222     else
// 1223     {
// 1224       req.status = APSME_UD_STANDARD_UNSECURED_JOIN;
??ZDSecMgrDeviceJoinFwd_4:
        MOV     A,#0x6
        LCALL   ?XSTACK_DISP0_8
        MOV     A,#0x1
// 1225     }
// 1226   }
??ZDSecMgrDeviceJoinFwd_3:
        LCALL   ?Subroutine43 & 0xFFFF
// 1227 
// 1228   // set association status to authenticated
// 1229   ZDSecMgrAssocDeviceAuth( AssocGetWithShort( device->nwkAddr ) );
??CrossCallReturnLabel_53:
        LCALL   ??Subroutine59_0 & 0xFFFF
??CrossCallReturnLabel_101:
        LCALL   ??AssocGetWithShort?relay
        LCALL   ??ZDSecMgrAssocDeviceAuth?relay
// 1230 
// 1231 #if defined ( APP_TP2_TEST_MODE )
// 1232   if ( guTxApsSecON == TRUE )
// 1233   {
// 1234     req.apsSecure = TRUE;
// 1235   }
// 1236   else
// 1237   {
// 1238     req.apsSecure = FALSE;
// 1239   }
// 1240 
// 1241   // send and APSME_UPDATE_DEVICE request to the trust center
// 1242   status = APSME_UpdateDeviceReq( &req );
// 1243 
// 1244 #else
// 1245   if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_SE_STANDARD )
// 1246   {
// 1247     // For ZG_GLOBAL_LINK_KEY the message has to be sent twice one
// 1248     // un-encrypted and one APS encrypted, to make sure that it can interoperate
// 1249     // with legacy Coordinator devices which can only handle one or the other.
// 1250     if ( zgApsLinkKeyType == ZG_GLOBAL_LINK_KEY )
        MOV     DPTR,#zgApsLinkKeyType
        MOVX    A,@DPTR
        XRL     A,#0x1
        JNZ     ??ZDSecMgrDeviceJoinFwd_6
// 1251     {
// 1252       req.apsSecure = FALSE;
        MOV     A,#0x7
        LCALL   ?XSTACK_DISP0_8
        CLR     A
        LCALL   ??Subroutine64_0 & 0xFFFF
// 1253 
// 1254       // send and APSME_UPDATE_DEVICE request to the trust center
// 1255       status = APSME_UpdateDeviceReq( &req );
// 1256     }
??CrossCallReturnLabel_142:
        LCALL   ??APSME_UpdateDeviceReq?relay
// 1257 
// 1258     // send the message APS encrypted
// 1259     req.apsSecure = TRUE;
??ZDSecMgrDeviceJoinFwd_6:
        MOV     A,#0x7
        LCALL   ?XSTACK_DISP0_8
        MOV     A,#0x1
        LCALL   ??Subroutine64_0 & 0xFFFF
// 1260 
// 1261     // send and APSME_UPDATE_DEVICE request to the trust center
// 1262     status = APSME_UpdateDeviceReq( &req );
// 1263   }
// 1264   else
// 1265   {
// 1266     req.apsSecure = FALSE;
// 1267 
// 1268     // send and APSME_UPDATE_DEVICE request to the trust center
// 1269     status = APSME_UpdateDeviceReq( &req );
// 1270   }
// 1271 #endif
// 1272 
// 1273   return status;
??CrossCallReturnLabel_143:
        LCALL   ??APSME_UpdateDeviceReq?relay
        SJMP    ?Subroutine4
          CFI EndBlock cfiBlock99
// 1274 }

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine43:
          CFI Block cfiCond100 Using cfiCommon0
          CFI Function ZDSecMgrEntryInit
          CFI Conditional ??CrossCallReturnLabel_51
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
          CFI Block cfiCond101 Using cfiCommon0
          CFI (cfiCond101) Function ZDSecMgrDeviceJoinFwd
          CFI (cfiCond101) Conditional ??CrossCallReturnLabel_52
          CFI (cfiCond101) DPL0 Frame(CFA_SP, 4)
          CFI (cfiCond101) DPH0 Frame(CFA_SP, 5)
          CFI (cfiCond101) CFA_SP SP+-5
          CFI (cfiCond101) CFA_XSP16 add(XSP16, 8)
          CFI Block cfiCond102 Using cfiCommon0
          CFI (cfiCond102) Function ZDSecMgrDeviceJoinFwd
          CFI (cfiCond102) Conditional ??CrossCallReturnLabel_53
          CFI (cfiCond102) DPL0 Frame(CFA_SP, 4)
          CFI (cfiCond102) DPH0 Frame(CFA_SP, 5)
          CFI (cfiCond102) CFA_SP SP+-5
          CFI (cfiCond102) CFA_XSP16 add(XSP16, 8)
          CFI Block cfiCond103 Using cfiCommon0
          CFI (cfiCond103) Function ZDSecMgrDeviceJoinFwd
          CFI (cfiCond103) Conditional ??CrossCallReturnLabel_54, ??CrossCallReturnLabel_0
          CFI (cfiCond103) DPL0 Frame(CFA_SP, 4)
          CFI (cfiCond103) DPH0 Frame(CFA_SP, 5)
          CFI (cfiCond103) CFA_SP SP+-5
          CFI (cfiCond103) CFA_XSP16 add(XSP16, 8)
          CFI Block cfiCond104 Using cfiCommon0
          CFI (cfiCond104) Function ZDSecMgrUpdateDeviceInd
          CFI (cfiCond104) Conditional ??CrossCallReturnLabel_54, ??CrossCallReturnLabel_1
          CFI (cfiCond104) DPL0 Frame(CFA_SP, 4)
          CFI (cfiCond104) DPH0 Frame(CFA_SP, 5)
          CFI (cfiCond104) CFA_SP SP+-5
          CFI (cfiCond104) CFA_XSP16 add(XSP16, 8)
          CFI Block cfiPicker105 Using cfiCommon1
          CFI (cfiPicker105) NoFunction
          CFI (cfiPicker105) Picker
        MOVX    @DPTR,A
        ; Setup parameters for call to function ZDSecMgrAssocDeviceAuth
        ; Setup parameters for call to function AssocGetWithShort
        MOV     DPL,R2
        MOV     DPH,R3
        RET
          CFI EndBlock cfiCond100
          CFI EndBlock cfiCond101
          CFI EndBlock cfiCond102
          CFI EndBlock cfiCond103
          CFI EndBlock cfiCond104
          CFI EndBlock cfiPicker105

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine22:
          CFI Block cfiCond106 Using cfiCommon0
          CFI Function APSME_LinkKeySet
          CFI Conditional ??CrossCallReturnLabel_108
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 23)
          CFI Block cfiCond107 Using cfiCommon0
          CFI (cfiCond107) Function APSME_LinkKeySet
          CFI (cfiCond107) Conditional ??CrossCallReturnLabel_109
          CFI (cfiCond107) R6 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond107) VB load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond107) V0 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond107) V1 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond107) V2 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond107) V3 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond107) V4 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond107) V5 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond107) V6 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond107) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond107) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond107) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond107) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond107) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond107) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond107) CFA_SP SP+0
          CFI (cfiCond107) CFA_XSP16 add(XSP16, 23)
          CFI Block cfiCond108 Using cfiCommon0
          CFI (cfiCond108) Function APSME_LinkKeyNVIdGet
          CFI (cfiCond108) Conditional ??CrossCallReturnLabel_110
          CFI (cfiCond108) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond108) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond108) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond108) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond108) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond108) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond108) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond108) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond108) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond108) CFA_SP SP+0
          CFI (cfiCond108) CFA_XSP16 add(XSP16, 11)
          CFI Block cfiPicker109 Using cfiCommon1
          CFI (cfiPicker109) NoFunction
          CFI (cfiPicker109) Picker
        LCALL   ?Subroutine52 & 0xFFFF
          CFI EndBlock cfiCond106
          CFI EndBlock cfiCond107
          CFI EndBlock cfiCond108
          CFI EndBlock cfiPicker109
??CrossCallReturnLabel_68:
        REQUIRE ??Subroutine58_0
        ; // Fall through to label ??Subroutine58_0

        RSEG BANKED_CODE:CODE:NOROOT(0)
??Subroutine58_0:
          CFI Block cfiCond110 Using cfiCommon0
          CFI Function ZDSecMgrDeviceRemove
          CFI Conditional ??CrossCallReturnLabel_105
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 20)
          CFI Block cfiCond111 Using cfiCommon0
          CFI (cfiCond111) Function APSME_KeyFwdToChild
          CFI (cfiCond111) Conditional ??CrossCallReturnLabel_106
          CFI (cfiCond111) DPL0 Frame(CFA_SP, 4)
          CFI (cfiCond111) DPH0 Frame(CFA_SP, 5)
          CFI (cfiCond111) CFA_SP SP+-5
          CFI Block cfiCond112 Using cfiCommon0
          CFI (cfiCond112) Function ZDSecMgrRestoreFromNV
          CFI (cfiCond112) Conditional ??CrossCallReturnLabel_107
          CFI (cfiCond112) R6 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI (cfiCond112) VB load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI (cfiCond112) V0 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI (cfiCond112) V1 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond112) V2 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond112) V3 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond112) V4 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond112) V5 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond112) V6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond112) V7 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond112) V8 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond112) V9 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond112) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond112) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond112) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond112) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond112) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond112) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond112) CFA_SP SP+0
          CFI (cfiCond112) CFA_XSP16 add(XSP16, 24)
          CFI Block cfiCond113 Using cfiCommon0
          CFI (cfiCond113) Function APSME_LinkKeySet
          CFI (cfiCond113) Conditional ??CrossCallReturnLabel_108
          CFI (cfiCond113) R6 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond113) VB load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond113) V0 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond113) V1 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond113) V2 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond113) V3 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond113) V4 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond113) V5 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond113) V6 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond113) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond113) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond113) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond113) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond113) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond113) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond113) CFA_SP SP+0
          CFI (cfiCond113) CFA_XSP16 add(XSP16, 23)
          CFI Block cfiCond114 Using cfiCommon0
          CFI (cfiCond114) Function APSME_LinkKeySet
          CFI (cfiCond114) Conditional ??CrossCallReturnLabel_109
          CFI (cfiCond114) R6 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond114) VB load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond114) V0 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond114) V1 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond114) V2 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond114) V3 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond114) V4 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond114) V5 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond114) V6 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond114) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond114) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond114) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond114) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond114) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond114) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond114) CFA_SP SP+0
          CFI (cfiCond114) CFA_XSP16 add(XSP16, 23)
          CFI Block cfiCond115 Using cfiCommon0
          CFI (cfiCond115) Function APSME_LinkKeyNVIdGet
          CFI (cfiCond115) Conditional ??CrossCallReturnLabel_110
          CFI (cfiCond115) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond115) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond115) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond115) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond115) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond115) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond115) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond115) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond115) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond115) CFA_SP SP+0
          CFI (cfiCond115) CFA_XSP16 add(XSP16, 11)
          CFI Block cfiPicker116 Using cfiCommon1
          CFI (cfiPicker116) NoFunction
          CFI (cfiPicker116) Picker
        INC     DPTR
        INC     DPTR
          CFI EndBlock cfiCond110
          CFI EndBlock cfiCond111
          CFI EndBlock cfiCond112
          CFI EndBlock cfiCond113
          CFI EndBlock cfiCond114
          CFI EndBlock cfiCond115
          CFI EndBlock cfiPicker116
        REQUIRE ??Subroutine59_0
        ; // Fall through to label ??Subroutine59_0

        RSEG BANKED_CODE:CODE:NOROOT(0)
??Subroutine59_0:
          CFI Block cfiCond117 Using cfiCommon0
          CFI Function ZDSecMgrEntryLookupExt
          CFI Conditional ??CrossCallReturnLabel_89
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 11)
          CFI Block cfiCond118 Using cfiCommon0
          CFI (cfiCond118) Function ZDSecMgrEntryFree
          CFI (cfiCond118) Conditional ??CrossCallReturnLabel_90
          CFI (cfiCond118) R6 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI (cfiCond118) VB load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond118) V0 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond118) V1 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond118) V2 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond118) V3 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond118) V4 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond118) V5 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond118) V6 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond118) V7 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond118) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond118) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond118) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond118) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond118) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond118) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond118) CFA_SP SP+0
          CFI (cfiCond118) CFA_XSP16 add(XSP16, 20)
          CFI Block cfiCond119 Using cfiCommon0
          CFI (cfiCond119) Function ZDSecMgrEntryFree
          CFI (cfiCond119) Conditional ??CrossCallReturnLabel_91
          CFI (cfiCond119) R6 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI (cfiCond119) VB load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond119) V0 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond119) V1 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond119) V2 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond119) V3 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond119) V4 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond119) V5 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond119) V6 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond119) V7 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond119) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond119) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond119) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond119) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond119) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond119) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond119) CFA_SP SP+0
          CFI (cfiCond119) CFA_XSP16 add(XSP16, 24)
          CFI Block cfiCond120 Using cfiCommon0
          CFI (cfiCond120) Function ZDSecMgrEntryFree
          CFI (cfiCond120) Conditional ??CrossCallReturnLabel_92
          CFI (cfiCond120) R6 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI (cfiCond120) VB load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond120) V0 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond120) V1 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond120) V2 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond120) V3 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond120) V4 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond120) V5 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond120) V6 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond120) V7 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond120) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond120) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond120) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond120) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond120) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond120) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond120) CFA_SP SP+0
          CFI (cfiCond120) CFA_XSP16 add(XSP16, 20)
          CFI Block cfiCond121 Using cfiCommon0
          CFI (cfiCond121) Function ZDSecMgrAppKeyGet
          CFI (cfiCond121) Conditional ??CrossCallReturnLabel_93
          CFI (cfiCond121) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond121) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond121) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond121) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond121) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond121) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond121) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond121) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond121) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond121) CFA_SP SP+0
          CFI (cfiCond121) CFA_XSP16 add(XSP16, 9)
          CFI Block cfiCond122 Using cfiCommon0
          CFI (cfiCond122) Function ZDSecMgrAppKeyReq
          CFI (cfiCond122) Conditional ??CrossCallReturnLabel_94
          CFI (cfiCond122) R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond122) VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond122) V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond122) V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond122) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond122) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond122) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond122) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond122) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond122) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond122) CFA_SP SP+0
          CFI (cfiCond122) CFA_XSP16 add(XSP16, 49)
          CFI Block cfiCond123 Using cfiCommon0
          CFI (cfiCond123) Function ZDSecMgrDeviceRemoveByExtAddr
          CFI (cfiCond123) Conditional ??CrossCallReturnLabel_95
          CFI (cfiCond123) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond123) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond123) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond123) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond123) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond123) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond123) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond123) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond123) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond123) CFA_SP SP+0
          CFI (cfiCond123) CFA_XSP16 add(XSP16, 11)
          CFI Block cfiCond124 Using cfiCommon0
          CFI (cfiCond124) Function ZDSecMgrDeviceRemove
          CFI (cfiCond124) Conditional ??CrossCallReturnLabel_96
          CFI (cfiCond124) R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond124) VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond124) V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond124) V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond124) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond124) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond124) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond124) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond124) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond124) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond124) CFA_SP SP+0
          CFI (cfiCond124) CFA_XSP16 add(XSP16, 20)
          CFI Block cfiCond125 Using cfiCommon0
          CFI (cfiCond125) Function ZDSecMgrDeviceRemove
          CFI (cfiCond125) Conditional ??CrossCallReturnLabel_97
          CFI (cfiCond125) R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond125) VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond125) V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond125) V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond125) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond125) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond125) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond125) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond125) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond125) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond125) CFA_SP SP+0
          CFI (cfiCond125) CFA_XSP16 add(XSP16, 20)
          CFI Block cfiCond126 Using cfiCommon0
          CFI (cfiCond126) Function ZDSecMgrDeviceJoin
          CFI (cfiCond126) Conditional ??CrossCallReturnLabel_98
          CFI (cfiCond126) R6 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond126) VB load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond126) V0 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond126) V1 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond126) V2 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond126) V3 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond126) V4 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond126) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond126) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond126) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond126) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond126) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond126) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond126) CFA_SP SP+0
          CFI (cfiCond126) CFA_XSP16 add(XSP16, 17)
          CFI Block cfiCond127 Using cfiCommon0
          CFI (cfiCond127) Function ZDSecMgrDeviceJoin
          CFI (cfiCond127) Conditional ??CrossCallReturnLabel_99
          CFI (cfiCond127) R6 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond127) VB load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond127) V0 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond127) V1 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond127) V2 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond127) V3 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond127) V4 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond127) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond127) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond127) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond127) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond127) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond127) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond127) CFA_SP SP+0
          CFI (cfiCond127) CFA_XSP16 add(XSP16, 15)
          CFI Block cfiCond128 Using cfiCommon0
          CFI (cfiCond128) Function ZDSecMgrDeviceJoinDirect
          CFI (cfiCond128) Conditional ??CrossCallReturnLabel_100
          CFI (cfiCond128) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond128) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond128) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond128) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond128) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond128) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond128) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond128) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond128) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond128) CFA_SP SP+0
          CFI (cfiCond128) CFA_XSP16 add(XSP16, 9)
          CFI Block cfiCond129 Using cfiCommon0
          CFI (cfiCond129) Function ZDSecMgrDeviceJoinFwd
          CFI (cfiCond129) Conditional ??CrossCallReturnLabel_101
          CFI (cfiCond129) DPL0 Frame(CFA_SP, 4)
          CFI (cfiCond129) DPH0 Frame(CFA_SP, 5)
          CFI (cfiCond129) CFA_SP SP+-5
          CFI (cfiCond129) CFA_XSP16 add(XSP16, 8)
          CFI Block cfiCond130 Using cfiCommon0
          CFI (cfiCond130) Function ZDSecMgrTransportKeyInd
          CFI (cfiCond130) Conditional ??CrossCallReturnLabel_102
          CFI (cfiCond130) R6 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond130) VB load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond130) V0 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond130) V1 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond130) V2 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond130) V3 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond130) V4 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond130) V5 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond130) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond130) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond130) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond130) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond130) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond130) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond130) CFA_SP SP+0
          CFI (cfiCond130) CFA_XSP16 add(XSP16, 34)
          CFI Block cfiCond131 Using cfiCommon0
          CFI (cfiCond131) Function APSME_IsLinkKeyValid
          CFI (cfiCond131) Conditional ??CrossCallReturnLabel_103
          CFI (cfiCond131) R6 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond131) VB load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond131) V0 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond131) V1 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond131) V2 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond131) V3 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond131) V4 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond131) V5 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond131) V6 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond131) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond131) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond131) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond131) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond131) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond131) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond131) CFA_SP SP+0
          CFI (cfiCond131) CFA_XSP16 add(XSP16, 37)
          CFI Block cfiCond132 Using cfiCommon0
          CFI (cfiCond132) Function ZDSecMgrAddLinkKey
          CFI (cfiCond132) Conditional ??CrossCallReturnLabel_104
          CFI (cfiCond132) R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond132) VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond132) V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond132) V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond132) V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond132) V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond132) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond132) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond132) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond132) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond132) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond132) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond132) CFA_SP SP+0
          CFI (cfiCond132) CFA_XSP16 add(XSP16, 16)
          CFI Block cfiCond133 Using cfiCommon0
          CFI (cfiCond133) Function ZDSecMgrDeviceRemove
          CFI (cfiCond133) Conditional ??CrossCallReturnLabel_105
          CFI (cfiCond133) R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond133) VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond133) V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond133) V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond133) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond133) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond133) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond133) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond133) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond133) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond133) CFA_SP SP+0
          CFI (cfiCond133) CFA_XSP16 add(XSP16, 20)
          CFI Block cfiCond134 Using cfiCommon0
          CFI (cfiCond134) Function APSME_KeyFwdToChild
          CFI (cfiCond134) Conditional ??CrossCallReturnLabel_106
          CFI (cfiCond134) DPL0 Frame(CFA_SP, 4)
          CFI (cfiCond134) DPH0 Frame(CFA_SP, 5)
          CFI (cfiCond134) CFA_SP SP+-5
          CFI Block cfiCond135 Using cfiCommon0
          CFI (cfiCond135) Function ZDSecMgrRestoreFromNV
          CFI (cfiCond135) Conditional ??CrossCallReturnLabel_107
          CFI (cfiCond135) R6 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI (cfiCond135) VB load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI (cfiCond135) V0 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI (cfiCond135) V1 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond135) V2 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond135) V3 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond135) V4 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond135) V5 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond135) V6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond135) V7 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond135) V8 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond135) V9 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond135) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond135) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond135) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond135) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond135) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond135) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond135) CFA_SP SP+0
          CFI (cfiCond135) CFA_XSP16 add(XSP16, 24)
          CFI Block cfiCond136 Using cfiCommon0
          CFI (cfiCond136) Function APSME_LinkKeySet
          CFI (cfiCond136) Conditional ??CrossCallReturnLabel_108
          CFI (cfiCond136) R6 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond136) VB load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond136) V0 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond136) V1 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond136) V2 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond136) V3 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond136) V4 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond136) V5 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond136) V6 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond136) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond136) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond136) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond136) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond136) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond136) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond136) CFA_SP SP+0
          CFI (cfiCond136) CFA_XSP16 add(XSP16, 23)
          CFI Block cfiCond137 Using cfiCommon0
          CFI (cfiCond137) Function APSME_LinkKeySet
          CFI (cfiCond137) Conditional ??CrossCallReturnLabel_109
          CFI (cfiCond137) R6 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond137) VB load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond137) V0 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond137) V1 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond137) V2 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond137) V3 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond137) V4 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond137) V5 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond137) V6 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond137) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond137) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond137) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond137) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond137) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond137) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond137) CFA_SP SP+0
          CFI (cfiCond137) CFA_XSP16 add(XSP16, 23)
          CFI Block cfiCond138 Using cfiCommon0
          CFI (cfiCond138) Function APSME_LinkKeyNVIdGet
          CFI (cfiCond138) Conditional ??CrossCallReturnLabel_110
          CFI (cfiCond138) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond138) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond138) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond138) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond138) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond138) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond138) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond138) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond138) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond138) CFA_SP SP+0
          CFI (cfiCond138) CFA_XSP16 add(XSP16, 11)
          CFI Block cfiPicker139 Using cfiCommon1
          CFI (cfiPicker139) NoFunction
          CFI (cfiPicker139) Picker
        MOVX    A,@DPTR
        MOV     R2,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R3,A
        RET
          CFI EndBlock cfiCond117
          CFI EndBlock cfiCond118
          CFI EndBlock cfiCond119
          CFI EndBlock cfiCond120
          CFI EndBlock cfiCond121
          CFI EndBlock cfiCond122
          CFI EndBlock cfiCond123
          CFI EndBlock cfiCond124
          CFI EndBlock cfiCond125
          CFI EndBlock cfiCond126
          CFI EndBlock cfiCond127
          CFI EndBlock cfiCond128
          CFI EndBlock cfiCond129
          CFI EndBlock cfiCond130
          CFI EndBlock cfiCond131
          CFI EndBlock cfiCond132
          CFI EndBlock cfiCond133
          CFI EndBlock cfiCond134
          CFI EndBlock cfiCond135
          CFI EndBlock cfiCond136
          CFI EndBlock cfiCond137
          CFI EndBlock cfiCond138
          CFI EndBlock cfiPicker139
// 1275 
// 1276 /******************************************************************************
// 1277  * @fn          ZDSecMgrDeviceNew
// 1278  *
// 1279  * @brief       Process a new device.
// 1280  *
// 1281  * @param       device - [in] ZDSecMgrDevice_t, device info
// 1282  *
// 1283  * @return      ZStatus_t
// 1284  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 1285 ZStatus_t ZDSecMgrDeviceNew( ZDSecMgrDevice_t* joiner )
ZDSecMgrDeviceNew:
          CFI Block cfiBlock140 Using cfiCommon0
          CFI Function ZDSecMgrDeviceNew
        CODE
// 1286 {
        FUNCALL ZDSecMgrDeviceNew, APSME_IsDistributedSecurity
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrDeviceNew, ZDSecMgrDeviceJoinDirect
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrDeviceNew, ZDSecMgrDeviceJoinFwd
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x9
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 0
        MOV     A,R2
        MOV     R6,A
        MOV     A,R3
        MOV     R7,A
// 1287   ZStatus_t status;
// 1288 
// 1289   if ( ( ( ZG_BUILD_COORDINATOR_TYPE ) && ( ZG_DEVICE_COORDINATOR_TYPE ) )
// 1290       || ( ( ZG_BUILD_RTR_TYPE ) && APSME_IsDistributedSecurity() ) )
        ; Setup parameters for call to function APSME_IsDistributedSecurity
        LCALL   ??APSME_IsDistributedSecurity?relay
        MOV     A,R1
        JZ      ??ZDSecMgrDeviceNew_0
// 1291   {
// 1292     // try to join this device
// 1293     status = ZDSecMgrDeviceJoinDirect( joiner );
        ; Setup parameters for call to function ZDSecMgrDeviceJoinDirect
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        LCALL   ??ZDSecMgrDeviceJoinDirect?relay
        SJMP    ??ZDSecMgrDeviceNew_1
// 1294   }
// 1295   else
// 1296   {
// 1297     status = ZDSecMgrDeviceJoinFwd( joiner );
??ZDSecMgrDeviceNew_0:
        ; Setup parameters for call to function ZDSecMgrDeviceJoinFwd
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        LCALL   ??ZDSecMgrDeviceJoinFwd?relay
// 1298   }
// 1299 
// 1300   return status;
??ZDSecMgrDeviceNew_1:
        LJMP    ??Subroutine68_0 & 0xFFFF
          CFI EndBlock cfiBlock140
// 1301 }
// 1302 
// 1303 /******************************************************************************
// 1304  * @fn          ZDSecMgrAssocDeviceAuth
// 1305  *
// 1306  * @brief       Set associated device status to authenticated
// 1307  *
// 1308  * @param       assoc - [in, out] associated_devices_t
// 1309  *
// 1310  * @return      none
// 1311  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 1312 void ZDSecMgrAssocDeviceAuth( associated_devices_t* assoc )
ZDSecMgrAssocDeviceAuth:
          CFI Block cfiBlock141 Using cfiCommon0
          CFI Function ZDSecMgrAssocDeviceAuth
        CODE
// 1313 {
        PUSH    DPL
          CFI DPL0 Frame(CFA_SP, 4)
          CFI CFA_SP SP+-4
        PUSH    DPH
          CFI DPH0 Frame(CFA_SP, 5)
          CFI CFA_SP SP+-5
        ; Saved register size: 2
        ; Auto size: 0
// 1314   if ( assoc != NULL )
        MOV     A,R2
        ORL     A,R3
        JZ      ??ZDSecMgrAssocDeviceAuth_0
// 1315   {
// 1316     assoc->devStatus |= DEV_SEC_AUTH_STATUS;
        MOV     DPL,R2
        MOV     DPH,R3
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        SETB    0xE0 /* A   */.3
        MOVX    @DPTR,A
// 1317   }
// 1318 }
??ZDSecMgrAssocDeviceAuth_0:
        SJMP    ??Subroutine61_0
          CFI EndBlock cfiBlock141
// 1319 
// 1320 /******************************************************************************
// 1321  * @fn          ZDSecMgrAuthNwkKey
// 1322  *
// 1323  * @brief       Handle next step in authentication process
// 1324  *
// 1325  * @param       none
// 1326  *
// 1327  * @return      none
// 1328  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 1329 void ZDSecMgrAuthNwkKey()
ZDSecMgrAuthNwkKey:
          CFI Block cfiBlock142 Using cfiCommon0
          CFI Function ZDSecMgrAuthNwkKey
        CODE
// 1330 {
        FUNCALL ZDSecMgrAuthNwkKey, osal_set_event
        LOCFRAME ISTACK, 2, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 0, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 0, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        PUSH    DPL
          CFI DPL0 Frame(CFA_SP, 4)
          CFI CFA_SP SP+-4
        PUSH    DPH
          CFI DPH0 Frame(CFA_SP, 5)
          CFI CFA_SP SP+-5
        ; Saved register size: 2
        ; Auto size: 0
// 1331   if ( devState == DEV_END_DEVICE_UNAUTH )
        MOV     DPTR,#devState
        MOVX    A,@DPTR
        XRL     A,#0x5
        JNZ     ??ZDSecMgrAuthNwkKey_0
// 1332   {
// 1333     // inform ZDO that device has been authenticated
// 1334     osal_set_event ( ZDAppTaskID, ZDO_DEVICE_AUTH );
        ; Setup parameters for call to function osal_set_event
        MOV     R2,#-0x80
        MOV     R3,#0x0
        MOV     DPTR,#ZDAppTaskID
        MOVX    A,@DPTR
        MOV     R1,A
        LCALL   ??osal_set_event?relay
// 1335   }
// 1336 }
??ZDSecMgrAuthNwkKey_0:
        SJMP    ??Subroutine61_0
          CFI EndBlock cfiBlock142

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine4:
          CFI Block cfiBlock143 Using cfiCommon0
          CFI NoFunction
          CFI CFA_SP SP+-5
          CFI CFA_XSP16 add(XSP16, 8)
          CFI DPL0 Frame(CFA_SP, 4)
          CFI DPH0 Frame(CFA_SP, 5)
        MOV     A,#0x8
          CFI EndBlock cfiBlock143
        REQUIRE ??Subroutine60_0
        ; // Fall through to label ??Subroutine60_0

        RSEG BANKED_CODE:CODE:NOROOT(0)
??Subroutine60_0:
          CFI Block cfiBlock144 Using cfiCommon0
          CFI NoFunction
          CFI CFA_SP SP+-5
          CFI CFA_XSP16 add(XSP16, 4)
          CFI DPL0 Frame(CFA_SP, 4)
          CFI DPH0 Frame(CFA_SP, 5)
          CFI Invalid
        LCALL   ?DEALLOC_XSTACK8
          CFI EndBlock cfiBlock144
        REQUIRE ??Subroutine61_0
        ; // Fall through to label ??Subroutine61_0

        RSEG BANKED_CODE:CODE:NOROOT(0)
??Subroutine61_0:
          CFI Block cfiBlock145 Using cfiCommon0
          CFI NoFunction
          CFI CFA_SP SP+-5
          CFI DPL0 Frame(CFA_SP, 4)
          CFI DPH0 Frame(CFA_SP, 5)
        POP     DPH
          CFI CFA_SP SP+-4
          CFI DPH0 SameValue
        POP     DPL
          CFI CFA_SP SP+-3
          CFI DPL0 SameValue
        LJMP    ?BRET
          CFI EndBlock cfiBlock145
// 1337 
// 1338 /******************************************************************************
// 1339  * PUBLIC FUNCTIONS
// 1340  */
// 1341 /******************************************************************************
// 1342  * @fn          ZDSecMgrInit
// 1343  *
// 1344  * @brief       Initialize ZigBee Device Security Manager.
// 1345  *
// 1346  * @param       state - device initialization state
// 1347  *
// 1348  * @return      none
// 1349  */
// 1350 #if ( ADDRMGR_CALLBACK_ENABLED == 1 )
// 1351 void ZDSecMgrAddrMgrCB( uint8 update, AddrMgrEntry_t* newEntry, AddrMgrEntry_t* oldEntry );
// 1352 void ZDSecMgrAddrMgrCB( uint8           update,
// 1353                         AddrMgrEntry_t* newEntry,
// 1354                         AddrMgrEntry_t* oldEntry )
// 1355 {
// 1356   (void)update;
// 1357   (void)newEntry;
// 1358   (void)oldEntry;
// 1359 }
// 1360 #endif // ( ADDRMGR_CALLBACK_ENABLED == 1 )
// 1361 

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 1362 void ZDSecMgrInit(uint8 state)
ZDSecMgrInit:
          CFI Block cfiBlock146 Using cfiCommon0
          CFI Function ZDSecMgrInit
        CODE
// 1363 {
        FUNCALL ZDSecMgrInit, ZDSecMgrEntryInit
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrInit, APSME_IsDistributedSecurity
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrInit, SSP_Init
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrInit, APSME_SecurityCM_RD
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x9
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 0
// 1364   if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_SE_STANDARD )
// 1365   {
// 1366     // initialize sub modules
// 1367     ZDSecMgrEntryInit(state);
        ; Setup parameters for call to function ZDSecMgrEntryInit
        LCALL   ??ZDSecMgrEntryInit?relay
// 1368 
// 1369     if ( ( ZG_BUILD_COORDINATOR_TYPE ) && ( ZG_DEVICE_COORDINATOR_TYPE ) )
// 1370     {
// 1371       APSME_SetRequest( apsTrustCenterAddress, 0, NLME_GetExtAddr() );
// 1372     }
// 1373 
// 1374     // register with Address Manager
// 1375 #if ( ADDRMGR_CALLBACK_ENABLED == 1 )
// 1376     AddrMgrRegister( ADDRMGR_REG_SECURITY, ZDSecMgrAddrMgrCB );
// 1377 #endif
// 1378   }
// 1379 
// 1380   if ( ZG_SECURE_ENABLED )
// 1381   {
// 1382     if ( ( ( ZG_BUILD_COORDINATOR_TYPE ) && ( ZG_DEVICE_COORDINATOR_TYPE ) )
// 1383          || ( ( ZG_BUILD_RTR_TYPE ) && APSME_IsDistributedSecurity() ) )
        ; Setup parameters for call to function APSME_IsDistributedSecurity
        LCALL   ??APSME_IsDistributedSecurity?relay
        MOV     A,R1
        JZ      ??ZDSecMgrInit_0
// 1384     {
// 1385       // setup joining permissions
// 1386       ZDSecMgrPermitJoiningEnabled = TRUE;
        MOV     DPTR,#ZDSecMgrPermitJoiningEnabled
        MOV     A,#0x1
        MOVX    @DPTR,A
// 1387       ZDSecMgrPermitJoiningTimed   = FALSE;
        MOV     DPTR,#ZDSecMgrPermitJoiningTimed
        CLR     A
        MOVX    @DPTR,A
// 1388     }
// 1389   }
// 1390 
// 1391   // configure security based on security mode and type of device
// 1392   ZDSecMgrConfig();
??ZDSecMgrInit_0:
        ; Setup parameters for call to function SSP_Init
        LCALL   ??SSP_Init?relay
        ; Setup parameters for call to function APSME_SecurityCM_RD
        LCALL   ??APSME_SecurityCM_RD?relay
// 1393 }
        LJMP    ??Subroutine68_0 & 0xFFFF
          CFI EndBlock cfiBlock146
// 1394 
// 1395 /******************************************************************************
// 1396  * @fn          ZDSecMgrConfig
// 1397  *
// 1398  * @brief       Configure ZigBee Device Security Manager.
// 1399  *
// 1400  * @param       none
// 1401  *
// 1402  * @return      none
// 1403  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 1404 void ZDSecMgrConfig( void )
ZDSecMgrConfig:
          CFI Block cfiBlock147 Using cfiCommon0
          CFI Function ZDSecMgrConfig
        CODE
// 1405 {
        FUNCALL ZDSecMgrConfig, SSP_Init
        LOCFRAME ISTACK, 2, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 0, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 0, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrConfig, APSME_SecurityCM_RD
        LOCFRAME ISTACK, 2, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 0, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 0, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        PUSH    DPL
          CFI DPL0 Frame(CFA_SP, 4)
          CFI CFA_SP SP+-4
        PUSH    DPH
          CFI DPH0 Frame(CFA_SP, 5)
          CFI CFA_SP SP+-5
        ; Saved register size: 2
        ; Auto size: 0
// 1406   if ( ZG_SECURE_ENABLED )
// 1407   {
// 1408     SSP_Init();
        ; Setup parameters for call to function SSP_Init
        LCALL   ??SSP_Init?relay
// 1409 
// 1410     if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_SE_STANDARD )
// 1411     {
// 1412       if ( ( ZG_BUILD_COORDINATOR_TYPE ) && ( ZG_DEVICE_COORDINATOR_TYPE ) )
// 1413       {
// 1414         // COMMERCIAL MODE - COORDINATOR DEVICE
// 1415         APSME_SecurityCM_CD();
// 1416       }
// 1417       else if ( ZSTACK_ROUTER_BUILD )
// 1418       {
// 1419         // COMMERCIAL MODE - ROUTER DEVICE
// 1420         APSME_SecurityCM_RD();
        ; Setup parameters for call to function APSME_SecurityCM_RD
        LCALL   ??APSME_SecurityCM_RD?relay
// 1421       }
// 1422       else
// 1423       {
// 1424         // COMMERCIAL MODE - END DEVICE
// 1425         APSME_SecurityCM_ED();
// 1426       }
// 1427     }
// 1428     else // ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_RESIDENTIAL )
// 1429     {
// 1430       if ( ( ZG_BUILD_COORDINATOR_TYPE ) && ( ZG_DEVICE_COORDINATOR_TYPE ) )
// 1431       {
// 1432         // RESIDENTIAL MODE - COORDINATOR DEVICE
// 1433         APSME_SecurityRM_CD();
// 1434       }
// 1435       else if ( ZSTACK_ROUTER_BUILD )
// 1436       {
// 1437         // RESIDENTIAL MODE - ROUTER DEVICE
// 1438         APSME_SecurityRM_RD();
// 1439       }
// 1440       else
// 1441       {
// 1442         // RESIDENTIAL MODE - END DEVICE
// 1443         APSME_SecurityRM_ED();
// 1444       }
// 1445     }
// 1446   }
// 1447   else
// 1448   {
// 1449     // NO SECURITY
// 1450     APSME_SecurityNM();
// 1451   }
// 1452 }
        SJMP    ??Subroutine61_0
          CFI EndBlock cfiBlock147
// 1453 
// 1454 /******************************************************************************
// 1455  * @fn          ZDSecMgrPermitJoining
// 1456  *
// 1457  * @brief       Process request to change joining permissions.
// 1458  *
// 1459  * @param       duration - [in] timed duration for join in seconds
// 1460  *                         - 0x00 not allowed
// 1461  *                         - 0xFF allowed without timeout
// 1462  *
// 1463  * @return      uint8 - success(TRUE:FALSE)
// 1464  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 1465 uint8 ZDSecMgrPermitJoining( uint8 duration )
ZDSecMgrPermitJoining:
          CFI Block cfiBlock148 Using cfiCommon0
          CFI Function ZDSecMgrPermitJoining
        CODE
// 1466 {
        PUSH    DPL
          CFI DPL0 Frame(CFA_SP, 4)
          CFI CFA_SP SP+-4
        PUSH    DPH
          CFI DPH0 Frame(CFA_SP, 5)
          CFI CFA_SP SP+-5
        ; Saved register size: 2
        ; Auto size: 0
        MOV     A,R1
        MOV     R0,A
// 1467   uint8 accept;
// 1468 
// 1469   ZDSecMgrPermitJoiningTimed = FALSE;
        MOV     DPTR,#ZDSecMgrPermitJoiningTimed
        CLR     A
        MOVX    @DPTR,A
// 1470 
// 1471   if ( duration > 0 )
        MOV     A,R0
        MOV     DPTR,#ZDSecMgrPermitJoiningEnabled
        JZ      ??ZDSecMgrPermitJoining_0
// 1472   {
// 1473     ZDSecMgrPermitJoiningEnabled = TRUE;
        MOV     A,#0x1
        MOVX    @DPTR,A
// 1474 
// 1475     if ( duration != 0xFF )
        MOV     A,#-0x1
        XRL     A,R0
        JZ      ??ZDSecMgrPermitJoining_1
// 1476     {
// 1477       ZDSecMgrPermitJoiningTimed = TRUE;
        MOV     DPTR,#ZDSecMgrPermitJoiningTimed
        MOV     A,#0x1
        SJMP    ??ZDSecMgrPermitJoining_2
// 1478     }
// 1479   }
// 1480   else
// 1481   {
// 1482     ZDSecMgrPermitJoiningEnabled = FALSE;
??ZDSecMgrPermitJoining_0:
        CLR     A
??ZDSecMgrPermitJoining_2:
        MOVX    @DPTR,A
// 1483   }
// 1484 
// 1485   accept = TRUE;
// 1486 
// 1487   return accept;
??ZDSecMgrPermitJoining_1:
        MOV     R1,#0x1
        SJMP    ??Subroutine61_0
          CFI EndBlock cfiBlock148
// 1488 }
// 1489 
// 1490 /******************************************************************************
// 1491  * @fn          ZDSecMgrPermitJoiningTimeout
// 1492  *
// 1493  * @brief       Process permit joining timeout
// 1494  *
// 1495  * @param       none
// 1496  *
// 1497  * @return      none
// 1498  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 1499 void ZDSecMgrPermitJoiningTimeout( void )
ZDSecMgrPermitJoiningTimeout:
          CFI Block cfiBlock149 Using cfiCommon0
          CFI Function ZDSecMgrPermitJoiningTimeout
        CODE
// 1500 {
        PUSH    DPL
          CFI DPL0 Frame(CFA_SP, 4)
          CFI CFA_SP SP+-4
        PUSH    DPH
          CFI DPH0 Frame(CFA_SP, 5)
          CFI CFA_SP SP+-5
        ; Saved register size: 2
        ; Auto size: 0
// 1501   if ( ZDSecMgrPermitJoiningTimed == TRUE )
        MOV     DPTR,#ZDSecMgrPermitJoiningTimed
        MOVX    A,@DPTR
        XRL     A,#0x1
        JNZ     ??ZDSecMgrPermitJoiningTimeout_0
// 1502   {
// 1503     ZDSecMgrPermitJoiningEnabled = FALSE;
        MOV     DPTR,#ZDSecMgrPermitJoiningEnabled
        CLR     A
        MOVX    @DPTR,A
// 1504     ZDSecMgrPermitJoiningTimed   = FALSE;
        MOV     DPTR,#ZDSecMgrPermitJoiningTimed
        MOVX    @DPTR,A
// 1505   }
// 1506 }
??ZDSecMgrPermitJoiningTimeout_0:
        SJMP    ??Subroutine61_0
          CFI EndBlock cfiBlock149
// 1507 
// 1508 /******************************************************************************
// 1509  * @fn          ZDSecMgrNewDeviceEvent
// 1510  *
// 1511  * @brief       Process a the new device event, if found reset new device
// 1512  *              event/timer.
// 1513  *
// 1514  * @param       ShortAddr - of New Device to process
// 1515  *
// 1516  * @return      uint8 - found(TRUE:FALSE)
// 1517  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 1518 uint8 ZDSecMgrNewDeviceEvent( uint16 ShortAddr )
ZDSecMgrNewDeviceEvent:
          CFI Block cfiBlock150 Using cfiCommon0
          CFI Function ZDSecMgrNewDeviceEvent
        CODE
// 1519 {
        FUNCALL ZDSecMgrNewDeviceEvent, AssocGetWithShort
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 33, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 33, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrNewDeviceEvent, ZDSecMgrAssocDeviceAuth
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 33, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 33, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrNewDeviceEvent, AddrMgrEntryGet
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 33, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 33, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrNewDeviceEvent, NLME_GetShortAddr
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 33, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 33, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrNewDeviceEvent, ZDSecMgrDeviceNew
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 33, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 33, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrNewDeviceEvent, ZDSecMgrAddrClear
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 33, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 33, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrNewDeviceEvent, AssocRemove
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 33, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 33, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0xc
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 12)
        ; Saved register size: 12
        ; Auto size: 21
        MOV     A,#-0x15
        LCALL   ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 33)
// 1520   uint8                 found;
// 1521   ZDSecMgrDevice_t      device;
// 1522   AddrMgrEntry_t        addrEntry;
// 1523   associated_devices_t* assoc;
// 1524   ZStatus_t             status;
// 1525 
// 1526   // initialize return results
// 1527   found = FALSE;
        MOV     ?V0 + 0,#0x0
// 1528 
// 1529   assoc = AssocGetWithShort( ShortAddr );
        ; Setup parameters for call to function AssocGetWithShort
        LCALL   ??AssocGetWithShort?relay
        MOV     ?V0 + 2,R2
        MOV     ?V0 + 3,R3
        MOV     R6,?V0 + 2
        MOV     R7,?V0 + 3
// 1530 
// 1531   if ( assoc != NULL )
        MOV     A,R6
        ORL     A,R7
        JNZ     $+5
        LJMP    ??ZDSecMgrNewDeviceEvent_0 & 0xFFFF
// 1532   {
// 1533     // device found
// 1534     found = TRUE;
        MOV     ?V0 + 0,#0x1
// 1535 
// 1536     // check for preconfigured security
// 1537     if ( zgPreConfigKeys == TRUE )
        MOV     DPTR,#zgPreConfigKeys
        MOVX    A,@DPTR
        XRL     A,#0x1
        JNZ     ??ZDSecMgrNewDeviceEvent_1
// 1538     {
// 1539       // set association status to authenticated
// 1540       ZDSecMgrAssocDeviceAuth( assoc );
        ; Setup parameters for call to function ZDSecMgrAssocDeviceAuth
        LCALL   ??ZDSecMgrAssocDeviceAuth?relay
// 1541     }
// 1542 
// 1543     // set up device info
// 1544     addrEntry.user  = ADDRMGR_USER_DEFAULT;
??ZDSecMgrNewDeviceEvent_1:
        MOV     A,#0x8
        LCALL   ?XSTACK_DISP0_8
        CLR     A
        MOVX    @DPTR,A
// 1545     addrEntry.index = assoc->addrIdx;
        MOV     DPL,R6
        MOV     DPH,R7
        INC     DPTR
        INC     DPTR
        LCALL   ??Subroutine70_0 & 0xFFFF
??CrossCallReturnLabel_170:
        MOV     A,#0x13
        LCALL   ?XSTACK_DISP0_8
        LCALL   ??Subroutine63_0 & 0xFFFF
// 1546     AddrMgrEntryGet( &addrEntry );
??CrossCallReturnLabel_129:
        ; Setup parameters for call to function AddrMgrEntryGet
        MOV     A,#0x8
        LCALL   ?XSTACK_DISP0_8
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??AddrMgrEntryGet?relay
// 1547 
// 1548     device.nwkAddr    = assoc->shortAddr;
        MOV     DPL,R6
        MOV     DPH,R7
        LCALL   ?Subroutine26 & 0xFFFF
??CrossCallReturnLabel_18:
        LCALL   ??Subroutine63_0 & 0xFFFF
// 1549     device.extAddr    = addrEntry.extAddr;
??CrossCallReturnLabel_130:
        MOV     A,#0xb
        LCALL   ?XSTACK_DISP0_8
        MOV     R0,DPL
        MOV     R1,DPH
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        LCALL   ??Subroutine63_0 & 0xFFFF
// 1550     device.parentAddr = NLME_GetShortAddr();
??CrossCallReturnLabel_131:
        ; Setup parameters for call to function NLME_GetShortAddr
        LCALL   ??NLME_GetShortAddr?relay
        MOV     A,#0x4
        LCALL   ?XSTACK_DISP0_8
        LCALL   ??Subroutine62_0 & 0xFFFF
// 1551 
// 1552     // the new device performed Secured Rejoin
// 1553     if ( ( assoc->devStatus & DEV_SECURED_JOIN ) &&
// 1554          ( assoc->devStatus & DEV_REJOIN_STATUS ) )
??CrossCallReturnLabel_111:
        MOV     A,R6
        ADD     A,#0x5
        MOV     R0,A
        MOV     A,R7
        LCALL   ?Subroutine39 & 0xFFFF
??CrossCallReturnLabel_45:
        ANL     A,#0x60
        XRL     A,#0x60
        JNZ     ??ZDSecMgrNewDeviceEvent_2
// 1555     {
// 1556       device.secure     = TRUE;
        MOV     A,#0x6
        LCALL   ?XSTACK_DISP0_8
        MOV     A,#0x1
        SJMP    ??ZDSecMgrNewDeviceEvent_3
// 1557     }
// 1558     else
// 1559     {
// 1560       device.secure     = FALSE;
??ZDSecMgrNewDeviceEvent_2:
        MOV     A,#0x6
        LCALL   ?XSTACK_DISP0_8
        CLR     A
??ZDSecMgrNewDeviceEvent_3:
        MOVX    @DPTR,A
// 1561     }
// 1562     device.devStatus  = assoc->devStatus;
        MOV     DPL,R6
        MOV     DPH,R7
        MOVX    A,@DPTR
        PUSH    A
          CFI CFA_SP SP+-1
        MOV     A,#0x7
        LCALL   ?XSTACK_DISP0_8
        POP     A
          CFI CFA_SP SP+0
        LCALL   ??Subroutine64_0 & 0xFFFF
// 1563 
// 1564     // process new device
// 1565     status = ZDSecMgrDeviceNew( &device );
// 1566 
// 1567     if ( status == ZSuccess )
??CrossCallReturnLabel_144:
        LCALL   ??ZDSecMgrDeviceNew?relay
        MOV     A,R1
        JNZ     ??ZDSecMgrNewDeviceEvent_4
// 1568     {
// 1569       assoc->devStatus &= ~DEV_SEC_INIT_STATUS;
        MOV     DPL,R6
        MOV     DPH,R7
        MOVX    A,@DPTR
        CLR     0xE0 /* A   */.2
        MOVX    @DPTR,A
        SJMP    ??ZDSecMgrNewDeviceEvent_0
// 1570     }
// 1571     else
// 1572     {
// 1573       // Clear SECURITY bit from Address Manager
// 1574       ZDSecMgrAddrClear( addrEntry.extAddr );
??ZDSecMgrNewDeviceEvent_4:
        ; Setup parameters for call to function ZDSecMgrAddrClear
        MOV     A,#0xb
        LCALL   ?XSTACK_DISP0_8
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??ZDSecMgrAddrClear?relay
// 1575 
// 1576       // Remove the Association completely
// 1577       AssocRemove( addrEntry.extAddr );
        ; Setup parameters for call to function AssocRemove
        MOV     A,#0xb
        LCALL   ?XSTACK_DISP0_8
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??AssocRemove?relay
// 1578     }
// 1579   }
// 1580 
// 1581   return found;
??ZDSecMgrNewDeviceEvent_0:
        MOV     R1,?V0 + 0
        MOV     A,#0x15
        LJMP    ?Subroutine3 & 0xFFFF
          CFI EndBlock cfiBlock150
// 1582 }

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine42:
          CFI Block cfiCond151 Using cfiCommon0
          CFI Function ZDSecMgrEntryLookupExtGetIndex
          CFI Conditional ??CrossCallReturnLabel_115
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 12)
          CFI Block cfiCond152 Using cfiCommon0
          CFI (cfiCond152) Function APSME_TCLinkKeySync
          CFI (cfiCond152) Conditional ??CrossCallReturnLabel_116
          CFI (cfiCond152) R6 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI (cfiCond152) VB load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI (cfiCond152) V0 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI (cfiCond152) V1 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond152) V2 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond152) V3 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond152) V4 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond152) V5 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond152) V6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond152) V7 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond152) V8 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond152) V9 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond152) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond152) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond152) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond152) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond152) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond152) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond152) CFA_SP SP+0
          CFI (cfiCond152) CFA_XSP16 add(XSP16, 50)
          CFI Block cfiCond153 Using cfiCommon0
          CFI (cfiCond153) Function APSME_TCLinkKeySync
          CFI (cfiCond153) Conditional ??CrossCallReturnLabel_117
          CFI (cfiCond153) R6 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI (cfiCond153) VB load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI (cfiCond153) V0 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI (cfiCond153) V1 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond153) V2 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond153) V3 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond153) V4 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond153) V5 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond153) V6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond153) V7 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond153) V8 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond153) V9 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond153) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond153) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond153) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond153) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond153) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond153) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond153) CFA_SP SP+0
          CFI (cfiCond153) CFA_XSP16 add(XSP16, 50)
          CFI Block cfiPicker154 Using cfiCommon1
          CFI (cfiPicker154) NoFunction
          CFI (cfiPicker154) Picker
        MOV     DPL,R6
        MOV     DPH,R7
          CFI EndBlock cfiCond151
          CFI EndBlock cfiCond152
          CFI EndBlock cfiCond153
          CFI EndBlock cfiPicker154
        REQUIRE ??Subroutine62_0
        ; // Fall through to label ??Subroutine62_0

        RSEG BANKED_CODE:CODE:NOROOT(0)
??Subroutine62_0:
          CFI Block cfiCond155 Using cfiCommon0
          CFI Function ZDSecMgrAddrStore
          CFI Conditional ??CrossCallReturnLabel_114, ??CrossCallReturnLabel_8
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 22)
          CFI Block cfiCond156 Using cfiCommon0
          CFI (cfiCond156) Function ZDSecMgrExtAddrStore
          CFI (cfiCond156) Conditional ??CrossCallReturnLabel_114, ??CrossCallReturnLabel_9
          CFI (cfiCond156) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond156) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond156) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond156) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond156) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond156) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond156) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond156) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond156) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond156) CFA_SP SP+0
          CFI (cfiCond156) CFA_XSP16 add(XSP16, 22)
          CFI Block cfiCond157 Using cfiCommon0
          CFI (cfiCond157) Function ZDSecMgrSetupPartner
          CFI (cfiCond157) Conditional ??CrossCallReturnLabel_114, ??CrossCallReturnLabel_10
          CFI (cfiCond157) R6 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond157) VB load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond157) V0 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond157) V1 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond157) V2 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond157) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond157) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond157) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond157) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond157) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond157) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond157) CFA_SP SP+0
          CFI (cfiCond157) CFA_XSP16 add(XSP16, 24)
          CFI Block cfiCond158 Using cfiCommon0
          CFI (cfiCond158) Function ZDSecMgrDeviceRemove
          CFI (cfiCond158) Conditional ??CrossCallReturnLabel_118, ??CrossCallReturnLabel_86
          CFI (cfiCond158) R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond158) VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond158) V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond158) V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond158) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond158) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond158) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond158) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond158) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond158) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond158) CFA_SP SP+0
          CFI (cfiCond158) CFA_XSP16 add(XSP16, 20)
          CFI Block cfiCond159 Using cfiCommon0
          CFI (cfiCond159) Function ZDSecMgrAPSRemove
          CFI (cfiCond159) Conditional ??CrossCallReturnLabel_118, ??CrossCallReturnLabel_87
          CFI (cfiCond159) DPL0 Frame(CFA_SP, 4)
          CFI (cfiCond159) DPH0 Frame(CFA_SP, 5)
          CFI (cfiCond159) CFA_SP SP+-5
          CFI (cfiCond159) CFA_XSP16 add(XSP16, 8)
          CFI Block cfiCond160 Using cfiCommon0
          CFI (cfiCond160) Function ZDSecMgrRemoveDeviceInd
          CFI (cfiCond160) Conditional ??CrossCallReturnLabel_118, ??CrossCallReturnLabel_88
          CFI (cfiCond160) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond160) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond160) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond160) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond160) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond160) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond160) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond160) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond160) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond160) CFA_SP SP+0
          CFI (cfiCond160) CFA_XSP16 add(XSP16, 17)
          CFI Block cfiCond161 Using cfiCommon0
          CFI (cfiCond161) Function ZDSecMgrSendNwkKey
          CFI (cfiCond161) Conditional ??CrossCallReturnLabel_113, ??CrossCallReturnLabel_6
          CFI (cfiCond161) R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond161) VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond161) V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond161) V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond161) V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond161) V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond161) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond161) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond161) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond161) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond161) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond161) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond161) CFA_SP SP+0
          CFI (cfiCond161) CFA_XSP16 add(XSP16, 46)
          CFI Block cfiCond162 Using cfiCommon0
          CFI (cfiCond162) Function ZDSecMgrDeviceRemove
          CFI (cfiCond162) Conditional ??CrossCallReturnLabel_113, ??CrossCallReturnLabel_7
          CFI (cfiCond162) R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond162) VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond162) V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond162) V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond162) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond162) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond162) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond162) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond162) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond162) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond162) CFA_SP SP+0
          CFI (cfiCond162) CFA_XSP16 add(XSP16, 20)
          CFI Block cfiCond163 Using cfiCommon0
          CFI (cfiCond163) Function ZDSecMgrNewDeviceEvent
          CFI (cfiCond163) Conditional ??CrossCallReturnLabel_111
          CFI (cfiCond163) R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond163) VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond163) V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond163) V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond163) V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond163) V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond163) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond163) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond163) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond163) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond163) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond163) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond163) CFA_SP SP+0
          CFI (cfiCond163) CFA_XSP16 add(XSP16, 33)
          CFI Block cfiCond164 Using cfiCommon0
          CFI (cfiCond164) Function APSME_TCLinkKeyLoad
          CFI (cfiCond164) Conditional ??CrossCallReturnLabel_112
          CFI (cfiCond164) R6 load(1, XDATA, add(CFA_XSP16, literal(-20)))
          CFI (cfiCond164) VB load(1, XDATA, add(CFA_XSP16, literal(-19)))
          CFI (cfiCond164) V0 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI (cfiCond164) V1 load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI (cfiCond164) V2 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI (cfiCond164) V3 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond164) V4 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond164) V5 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond164) V6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond164) V7 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond164) V8 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond164) V9 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond164) V10 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond164) V11 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond164) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond164) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond164) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond164) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond164) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond164) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond164) CFA_SP SP+0
          CFI (cfiCond164) CFA_XSP16 add(XSP16, 65)
          CFI Block cfiCond165 Using cfiCommon0
          CFI (cfiCond165) Function ZDSecMgrEntryLookupExtGetIndex
          CFI (cfiCond165) Conditional ??CrossCallReturnLabel_115
          CFI (cfiCond165) R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond165) VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond165) V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond165) V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond165) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond165) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond165) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond165) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond165) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond165) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond165) CFA_SP SP+0
          CFI (cfiCond165) CFA_XSP16 add(XSP16, 12)
          CFI Block cfiCond166 Using cfiCommon0
          CFI (cfiCond166) Function APSME_TCLinkKeySync
          CFI (cfiCond166) Conditional ??CrossCallReturnLabel_116
          CFI (cfiCond166) R6 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI (cfiCond166) VB load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI (cfiCond166) V0 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI (cfiCond166) V1 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond166) V2 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond166) V3 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond166) V4 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond166) V5 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond166) V6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond166) V7 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond166) V8 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond166) V9 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond166) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond166) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond166) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond166) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond166) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond166) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond166) CFA_SP SP+0
          CFI (cfiCond166) CFA_XSP16 add(XSP16, 50)
          CFI Block cfiCond167 Using cfiCommon0
          CFI (cfiCond167) Function APSME_TCLinkKeySync
          CFI (cfiCond167) Conditional ??CrossCallReturnLabel_117
          CFI (cfiCond167) R6 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI (cfiCond167) VB load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI (cfiCond167) V0 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI (cfiCond167) V1 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond167) V2 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond167) V3 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond167) V4 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond167) V5 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond167) V6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond167) V7 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond167) V8 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond167) V9 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond167) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond167) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond167) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond167) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond167) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond167) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond167) CFA_SP SP+0
          CFI (cfiCond167) CFA_XSP16 add(XSP16, 50)
          CFI Block cfiPicker168 Using cfiCommon1
          CFI (cfiPicker168) NoFunction
          CFI (cfiPicker168) Picker
        MOV     A,R2
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R3
        MOVX    @DPTR,A
        RET
          CFI EndBlock cfiCond155
          CFI EndBlock cfiCond156
          CFI EndBlock cfiCond157
          CFI EndBlock cfiCond158
          CFI EndBlock cfiCond159
          CFI EndBlock cfiCond160
          CFI EndBlock cfiCond161
          CFI EndBlock cfiCond162
          CFI EndBlock cfiCond163
          CFI EndBlock cfiCond164
          CFI EndBlock cfiCond165
          CFI EndBlock cfiCond166
          CFI EndBlock cfiCond167
          CFI EndBlock cfiPicker168

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine20:
          CFI Block cfiCond169 Using cfiCommon0
          CFI Function ZDSecMgrTransportKeyInd
          CFI Conditional ??CrossCallReturnLabel_136
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 34)
          CFI Block cfiCond170 Using cfiCommon0
          CFI (cfiCond170) Function ZDSecMgrAddLinkKey
          CFI (cfiCond170) Conditional ??CrossCallReturnLabel_137
          CFI (cfiCond170) R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond170) VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond170) V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond170) V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond170) V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond170) V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond170) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond170) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond170) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond170) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond170) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond170) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond170) CFA_SP SP+0
          CFI (cfiCond170) CFA_XSP16 add(XSP16, 16)
          CFI Block cfiPicker171 Using cfiCommon1
          CFI (cfiPicker171) NoFunction
          CFI (cfiPicker171) Picker
        LCALL   ?Subroutine45 & 0xFFFF
??CrossCallReturnLabel_55:
        LCALL   ?Subroutine48 & 0xFFFF
          CFI EndBlock cfiCond169
          CFI EndBlock cfiCond170
          CFI EndBlock cfiPicker171
??CrossCallReturnLabel_60:
        REQUIRE ??Subroutine63_0
        ; // Fall through to label ??Subroutine63_0

        RSEG BANKED_CODE:CODE:NOROOT(0)
??Subroutine63_0:
          CFI Block cfiCond172 Using cfiCommon0
          CFI Function ZDSecMgrAddrClear
          CFI Conditional ??CrossCallReturnLabel_119
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 24)
          CFI Block cfiCond173 Using cfiCommon0
          CFI (cfiCond173) Function ZDSecMgrAppKeyReq
          CFI (cfiCond173) Conditional ??CrossCallReturnLabel_120
          CFI (cfiCond173) R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond173) VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond173) V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond173) V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond173) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond173) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond173) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond173) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond173) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond173) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond173) CFA_SP SP+0
          CFI (cfiCond173) CFA_XSP16 add(XSP16, 49)
          CFI Block cfiCond174 Using cfiCommon0
          CFI (cfiCond174) Function ZDSecMgrAppKeyReq
          CFI (cfiCond174) Conditional ??CrossCallReturnLabel_121
          CFI (cfiCond174) R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond174) VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond174) V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond174) V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond174) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond174) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond174) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond174) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond174) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond174) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond174) CFA_SP SP+0
          CFI (cfiCond174) CFA_XSP16 add(XSP16, 49)
          CFI Block cfiCond175 Using cfiCommon0
          CFI (cfiCond175) Function ZDSecMgrAppKeyReq
          CFI (cfiCond175) Conditional ??CrossCallReturnLabel_122
          CFI (cfiCond175) R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond175) VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond175) V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond175) V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond175) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond175) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond175) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond175) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond175) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond175) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond175) CFA_SP SP+0
          CFI (cfiCond175) CFA_XSP16 add(XSP16, 49)
          CFI Block cfiCond176 Using cfiCommon0
          CFI (cfiCond176) Function ZDSecMgrAppKeyReq
          CFI (cfiCond176) Conditional ??CrossCallReturnLabel_123
          CFI (cfiCond176) R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond176) VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond176) V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond176) V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond176) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond176) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond176) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond176) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond176) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond176) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond176) CFA_SP SP+0
          CFI (cfiCond176) CFA_XSP16 add(XSP16, 49)
          CFI Block cfiCond177 Using cfiCommon0
          CFI (cfiCond177) Function ZDSecMgrSendNwkKey
          CFI (cfiCond177) Conditional ??CrossCallReturnLabel_124
          CFI (cfiCond177) R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond177) VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond177) V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond177) V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond177) V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond177) V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond177) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond177) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond177) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond177) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond177) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond177) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond177) CFA_SP SP+0
          CFI (cfiCond177) CFA_XSP16 add(XSP16, 46)
          CFI Block cfiCond178 Using cfiCommon0
          CFI (cfiCond178) Function ZDSecMgrSendNwkKey
          CFI (cfiCond178) Conditional ??CrossCallReturnLabel_125
          CFI (cfiCond178) R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond178) VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond178) V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond178) V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond178) V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond178) V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond178) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond178) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond178) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond178) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond178) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond178) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond178) CFA_SP SP+0
          CFI (cfiCond178) CFA_XSP16 add(XSP16, 46)
          CFI Block cfiCond179 Using cfiCommon0
          CFI (cfiCond179) Function ZDSecMgrSendNwkKey
          CFI (cfiCond179) Conditional ??CrossCallReturnLabel_126
          CFI (cfiCond179) R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond179) VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond179) V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond179) V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond179) V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond179) V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond179) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond179) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond179) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond179) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond179) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond179) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond179) CFA_SP SP+0
          CFI (cfiCond179) CFA_XSP16 add(XSP16, 46)
          CFI Block cfiCond180 Using cfiCommon0
          CFI (cfiCond180) Function ZDSecMgrDeviceRemove
          CFI (cfiCond180) Conditional ??CrossCallReturnLabel_127
          CFI (cfiCond180) R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond180) VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond180) V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond180) V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond180) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond180) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond180) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond180) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond180) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond180) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond180) CFA_SP SP+0
          CFI (cfiCond180) CFA_XSP16 add(XSP16, 20)
          CFI Block cfiCond181 Using cfiCommon0
          CFI (cfiCond181) Function ZDSecMgrDeviceJoinFwd
          CFI (cfiCond181) Conditional ??CrossCallReturnLabel_128
          CFI (cfiCond181) DPL0 Frame(CFA_SP, 4)
          CFI (cfiCond181) DPH0 Frame(CFA_SP, 5)
          CFI (cfiCond181) CFA_SP SP+-5
          CFI (cfiCond181) CFA_XSP16 add(XSP16, 8)
          CFI Block cfiCond182 Using cfiCommon0
          CFI (cfiCond182) Function ZDSecMgrNewDeviceEvent
          CFI (cfiCond182) Conditional ??CrossCallReturnLabel_129
          CFI (cfiCond182) R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond182) VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond182) V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond182) V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond182) V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond182) V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond182) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond182) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond182) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond182) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond182) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond182) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond182) CFA_SP SP+0
          CFI (cfiCond182) CFA_XSP16 add(XSP16, 33)
          CFI Block cfiCond183 Using cfiCommon0
          CFI (cfiCond183) Function ZDSecMgrNewDeviceEvent
          CFI (cfiCond183) Conditional ??CrossCallReturnLabel_130
          CFI (cfiCond183) R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond183) VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond183) V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond183) V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond183) V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond183) V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond183) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond183) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond183) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond183) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond183) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond183) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond183) CFA_SP SP+0
          CFI (cfiCond183) CFA_XSP16 add(XSP16, 33)
          CFI Block cfiCond184 Using cfiCommon0
          CFI (cfiCond184) Function ZDSecMgrNewDeviceEvent
          CFI (cfiCond184) Conditional ??CrossCallReturnLabel_131
          CFI (cfiCond184) R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond184) VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond184) V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond184) V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond184) V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond184) V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond184) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond184) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond184) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond184) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond184) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond184) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond184) CFA_SP SP+0
          CFI (cfiCond184) CFA_XSP16 add(XSP16, 33)
          CFI Block cfiCond185 Using cfiCommon0
          CFI (cfiCond185) Function ZDSecMgrUpdateDeviceInd
          CFI (cfiCond185) Conditional ??CrossCallReturnLabel_132
          CFI (cfiCond185) DPL0 Frame(CFA_SP, 4)
          CFI (cfiCond185) DPH0 Frame(CFA_SP, 5)
          CFI (cfiCond185) CFA_SP SP+-5
          CFI (cfiCond185) CFA_XSP16 add(XSP16, 8)
          CFI Block cfiCond186 Using cfiCommon0
          CFI (cfiCond186) Function ZDSecMgrUpdateDeviceInd
          CFI (cfiCond186) Conditional ??CrossCallReturnLabel_133
          CFI (cfiCond186) DPL0 Frame(CFA_SP, 4)
          CFI (cfiCond186) DPH0 Frame(CFA_SP, 5)
          CFI (cfiCond186) CFA_SP SP+-5
          CFI (cfiCond186) CFA_XSP16 add(XSP16, 8)
          CFI Block cfiCond187 Using cfiCommon0
          CFI (cfiCond187) Function APSME_LinkKeySet
          CFI (cfiCond187) Conditional ??CrossCallReturnLabel_134
          CFI (cfiCond187) R6 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond187) VB load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond187) V0 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond187) V1 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond187) V2 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond187) V3 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond187) V4 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond187) V5 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond187) V6 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond187) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond187) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond187) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond187) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond187) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond187) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond187) CFA_SP SP+0
          CFI (cfiCond187) CFA_XSP16 add(XSP16, 19)
          CFI Block cfiCond188 Using cfiCommon0
          CFI (cfiCond188) Function APSME_TCLinkKeyLoad
          CFI (cfiCond188) Conditional ??CrossCallReturnLabel_135
          CFI (cfiCond188) R6 load(1, XDATA, add(CFA_XSP16, literal(-20)))
          CFI (cfiCond188) VB load(1, XDATA, add(CFA_XSP16, literal(-19)))
          CFI (cfiCond188) V0 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI (cfiCond188) V1 load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI (cfiCond188) V2 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI (cfiCond188) V3 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond188) V4 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond188) V5 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond188) V6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond188) V7 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond188) V8 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond188) V9 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond188) V10 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond188) V11 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond188) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond188) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond188) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond188) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond188) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond188) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond188) CFA_SP SP+0
          CFI (cfiCond188) CFA_XSP16 add(XSP16, 65)
          CFI Block cfiCond189 Using cfiCommon0
          CFI (cfiCond189) Function ZDSecMgrTransportKeyInd
          CFI (cfiCond189) Conditional ??CrossCallReturnLabel_136
          CFI (cfiCond189) R6 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond189) VB load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond189) V0 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond189) V1 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond189) V2 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond189) V3 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond189) V4 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond189) V5 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond189) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond189) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond189) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond189) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond189) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond189) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond189) CFA_SP SP+0
          CFI (cfiCond189) CFA_XSP16 add(XSP16, 34)
          CFI Block cfiCond190 Using cfiCommon0
          CFI (cfiCond190) Function ZDSecMgrAddLinkKey
          CFI (cfiCond190) Conditional ??CrossCallReturnLabel_137
          CFI (cfiCond190) R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond190) VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond190) V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond190) V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond190) V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond190) V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond190) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond190) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond190) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond190) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond190) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond190) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond190) CFA_SP SP+0
          CFI (cfiCond190) CFA_XSP16 add(XSP16, 16)
          CFI Block cfiPicker191 Using cfiCommon1
          CFI (cfiPicker191) NoFunction
          CFI (cfiPicker191) Picker
        MOV     A,R0
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R1
        MOVX    @DPTR,A
        RET
          CFI EndBlock cfiCond172
          CFI EndBlock cfiCond173
          CFI EndBlock cfiCond174
          CFI EndBlock cfiCond175
          CFI EndBlock cfiCond176
          CFI EndBlock cfiCond177
          CFI EndBlock cfiCond178
          CFI EndBlock cfiCond179
          CFI EndBlock cfiCond180
          CFI EndBlock cfiCond181
          CFI EndBlock cfiCond182
          CFI EndBlock cfiCond183
          CFI EndBlock cfiCond184
          CFI EndBlock cfiCond185
          CFI EndBlock cfiCond186
          CFI EndBlock cfiCond187
          CFI EndBlock cfiCond188
          CFI EndBlock cfiCond189
          CFI EndBlock cfiCond190
          CFI EndBlock cfiPicker191
// 1583 
// 1584 /******************************************************************************
// 1585  * @fn          ZDSecMgrTCExtAddrCheck
// 1586  *
// 1587  * @brief       Verifies if received ext. address matches TC ext. address.
// 1588  *
// 1589  * @param       extAddr - Extended address to be verified.
// 1590  *
// 1591  * @return      TRUE - extended address matches
// 1592  *              FALSE - otherwise
// 1593  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 1594 uint8 ZDSecMgrTCExtAddrCheck( uint8* extAddr )
ZDSecMgrTCExtAddrCheck:
          CFI Block cfiBlock192 Using cfiCommon0
          CFI Function ZDSecMgrTCExtAddrCheck
        CODE
// 1595 {
        FUNCALL ZDSecMgrTCExtAddrCheck, APSME_GetRequest
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 17, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 17, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrTCExtAddrCheck, sAddrExtCmp
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 17, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 17, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x9
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 8
        MOV     A,#-0x8
        LCALL   ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 17)
        MOV     A,R2
        MOV     R6,A
        MOV     A,R3
        MOV     R7,A
// 1596   uint8  lookup[Z_EXTADDR_LEN];
// 1597   APSME_GetRequest( apsTrustCenterAddress, 0, lookup );
        ; Setup parameters for call to function APSME_GetRequest
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     R4,DPL
        MOV     R5,DPH
        MOV     R2,#0x0
        MOV     R3,#0x0
        MOV     R1,#-0x55
        LCALL   ??APSME_GetRequest?relay
// 1598   return osal_ExtAddrEqual( extAddr, lookup );
        ; Setup parameters for call to function sAddrExtCmp
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     R4,DPL
        MOV     R5,DPH
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        LCALL   ??sAddrExtCmp?relay
          CFI EndBlock cfiBlock192
        REQUIRE ?Subroutine8
        ; // Fall through to label ?Subroutine8
// 1599 }

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine8:
          CFI Block cfiBlock193 Using cfiCommon0
          CFI NoFunction
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 17)
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        MOV     A,#0x8
        LJMP    ??Subroutine67_0 & 0xFFFF
          CFI EndBlock cfiBlock193
// 1600 
// 1601 /******************************************************************************
// 1602  * @fn          ZDSecMgrTCDataLoad
// 1603  *
// 1604  * @brief       Stores the address of TC into address manager.
// 1605  *
// 1606  * @param       extAddr - Extended address to be verified.
// 1607  *
// 1608  * @return      none
// 1609  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 1610 void ZDSecMgrTCDataLoad( uint8* extAddr )
ZDSecMgrTCDataLoad:
          CFI Block cfiBlock194 Using cfiCommon0
          CFI Function ZDSecMgrTCDataLoad
        CODE
// 1611 {
        FUNCALL ZDSecMgrTCDataLoad, sAddrExtCpy
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 25, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 25, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrTCDataLoad, APSME_IsDistributedSecurity
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 25, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 25, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrTCDataLoad, AddrMgrEntryLookupExt
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 25, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 25, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrTCDataLoad, ZDSecMgrAddrStore
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 27, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 27, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0xa
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 10)
        ; Saved register size: 10
        ; Auto size: 15
        MOV     A,#-0xf
        LCALL   ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 25)
        MOV     A,R2
        MOV     R6,A
        MOV     A,R3
        MOV     R7,A
// 1612   uint16 ami;
// 1613   AddrMgrEntry_t entry;
// 1614 
// 1615   // lookup using TC short address
// 1616   entry.user    = ADDRMGR_USER_DEFAULT;
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        CLR     A
        MOVX    @DPTR,A
// 1617   osal_cpyExtAddr( entry.extAddr, extAddr );
        ; Setup parameters for call to function sAddrExtCpy
        MOV     A,R6
        MOV     R4,A
        MOV     A,R7
        MOV     R5,A
        MOV     A,#0x5
        LCALL   ?XSTACK_DISP0_8
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??sAddrExtCpy?relay
// 1618 
// 1619   // Verify if TC address has been added to Address Manager
// 1620   if ( !APSME_IsDistributedSecurity() && ( AddrMgrEntryLookupExt( &entry ) != TRUE ) )
        ; Setup parameters for call to function APSME_IsDistributedSecurity
        LCALL   ??APSME_IsDistributedSecurity?relay
        MOV     A,R1
        JNZ     ??ZDSecMgrTCDataLoad_0
        ; Setup parameters for call to function AddrMgrEntryLookupExt
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??AddrMgrEntryLookupExt?relay
        MOV     A,R1
        XRL     A,#0x1
        JZ      ??ZDSecMgrTCDataLoad_0
// 1621   {
// 1622     ZDSecMgrAddrStore( APSME_TRUSTCENTER_NWKADDR, extAddr, &ami );
        ; Setup parameters for call to function ZDSecMgrAddrStore
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     ?V0 + 0,DPL
        MOV     ?V0 + 1,DPH
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 27)
        MOV     A,R6
        MOV     R4,A
        MOV     A,R7
        MOV     R5,A
        MOV     R2,#0x0
        MOV     R3,#0x0
        LCALL   ??ZDSecMgrAddrStore?relay
        MOV     A,#0x2
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 25)
// 1623   }
// 1624 }
??ZDSecMgrTCDataLoad_0:
        MOV     A,#0xf
        LJMP    ??Subroutine72_0 & 0xFFFF
          CFI EndBlock cfiBlock194
// 1625 
// 1626 /******************************************************************************
// 1627  * @fn          ZDSecMgrTransportKeyInd
// 1628  *
// 1629  * @brief       Process the ZDO_TransportKeyInd_t message.
// 1630  *
// 1631  * @param       ind - [in] ZDO_TransportKeyInd_t indication
// 1632  *
// 1633  * @return      none
// 1634  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 1635 void ZDSecMgrTransportKeyInd( ZDO_TransportKeyInd_t* ind )
ZDSecMgrTransportKeyInd:
          CFI Block cfiBlock195 Using cfiCommon0
          CFI Function ZDSecMgrTransportKeyInd
        CODE
// 1636 {
        FUNCALL ZDSecMgrTransportKeyInd, ZDSecMgrUpdateTCAddress
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 34, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 34, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrTransportKeyInd, osal_isbufset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 34, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 34, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrTransportKeyInd, ZDSecMgrTCDataLoad
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 34, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 34, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrTransportKeyInd, ZDSecMgrReadKeyFromNv
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 34, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 34, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrTransportKeyInd, SSP_UpdateNwkKey
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 34, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 34, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrTransportKeyInd, SSP_SwitchNwkKey
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 34, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 34, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrTransportKeyInd, osal_memset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 34, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 34, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrTransportKeyInd, SSP_UpdateNwkKey
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 34, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 34, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrTransportKeyInd, SSP_SwitchNwkKey
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 34, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 34, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrTransportKeyInd, ZDSecMgrAuthNwkKey
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 34, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 34, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrTransportKeyInd, ZDSecMgrExtAddrLookup
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 34, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 34, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrTransportKeyInd, ZDSecMgrAddrStore
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 36, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 36, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrTransportKeyInd, ZDP_NwkAddrReq
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 34, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 34, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrTransportKeyInd, ZDSecMgrEntryLookupAMI
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 34, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 34, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrTransportKeyInd, ZDSecMgrEntryNew
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 34, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 34, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrTransportKeyInd, APSME_LinkKeySet
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 34, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 34, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrTransportKeyInd, ZDSecMgrWriteNV
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 34, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 34, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0xe
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 14)
        ; Saved register size: 14
        ; Auto size: 20
        MOV     A,#-0x14
        LCALL   ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 34)
        MOV     ?V0 + 2,R2
        MOV     ?V0 + 3,R3
// 1637   uint8 index;
// 1638   uint8 zgPreConfigKey[SEC_KEY_LEN];
// 1639 
// 1640   ZDSecMgrUpdateTCAddress( ind->srcExtAddr );
        MOV     A,R2
        ADD     A,#0x16
        MOV     R6,A
        MOV     A,R3
        ADDC    A,#0x0
        MOV     R7,A
        ; Setup parameters for call to function ZDSecMgrUpdateTCAddress
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        LCALL   ??ZDSecMgrUpdateTCAddress?relay
// 1641   // check for distributed security
// 1642   if ( ( ZG_BUILD_RTR_TYPE ) && osal_isbufset( ind->srcExtAddr, 0xFF, Z_EXTADDR_LEN ) )
        ; Setup parameters for call to function osal_isbufset
        MOV     R4,#0x8
        MOV     R1,#-0x1
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        LCALL   ??osal_isbufset?relay
        MOV     A,R1
        JZ      ??ZDSecMgrTransportKeyInd_0
// 1643   {
// 1644     ZDSecMgrPermitJoiningEnabled = TRUE;
        MOV     DPTR,#ZDSecMgrPermitJoiningEnabled
        MOV     A,#0x1
        MOVX    @DPTR,A
// 1645   }
// 1646 
// 1647   // load Trust Center data if needed
// 1648   ZDSecMgrTCDataLoad( ind->srcExtAddr );
??ZDSecMgrTransportKeyInd_0:
        ; Setup parameters for call to function ZDSecMgrTCDataLoad
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        LCALL   ??ZDSecMgrTCDataLoad?relay
// 1649 
// 1650   if ( ( ind->keyType == KEY_TYPE_NWK ) ||
// 1651        ( ind->keyType == 6            ) )
        MOV     DPL,?V0 + 2
        MOV     DPH,?V0 + 3
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R0,A
        MOV     A,?V0 + 2
        ADD     A,#0x6
        MOV     ?V0 + 0,A
        MOV     A,?V0 + 3
        ADDC    A,#0x0
        MOV     ?V0 + 1,A
        MOV     A,#0x1
        XRL     A,R0
        JZ      ??ZDSecMgrTransportKeyInd_1
        MOV     A,#0x6
        XRL     A,R0
        JZ      $+5
        LJMP    ??ZDSecMgrTransportKeyInd_2 & 0xFFFF
// 1652   {
// 1653     // check for dummy NWK key (all zeros)
// 1654     for ( index = 0;
??ZDSecMgrTransportKeyInd_1:
        MOV     R0,#0x0
??ZDSecMgrTransportKeyInd_3:
        MOV     ?V0 + 4,R0
        MOV     A,?V0 + 2
        ADD     A,?V0 + 4
        MOV     DPL,A
        MOV     A,?V0 + 3
        LCALL   ??Subroutine71_0 & 0xFFFF
??CrossCallReturnLabel_180:
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        JNZ     ??ZDSecMgrTransportKeyInd_4
// 1655           ( (index < SEC_KEY_LEN) && (ind->key[index] == 0) );
// 1656           index++ );
        INC     R0
        MOV     A,R0
        CLR     C
        SUBB    A,#0x10
        JC      ??ZDSecMgrTransportKeyInd_3
// 1657 
// 1658     if ( index == SEC_KEY_LEN )
??ZDSecMgrTransportKeyInd_4:
        MOV     A,#0x10
        XRL     A,R0
        JNZ     ??ZDSecMgrTransportKeyInd_5
// 1659     {
// 1660       // load preconfigured key - once!!
// 1661       if ( !_NIB.nwkKeyLoaded )
        MOV     DPTR,#_NIB + 61
        MOVX    A,@DPTR
        JNZ     ??ZDSecMgrTransportKeyInd_6
// 1662       {
// 1663         ZDSecMgrReadKeyFromNv(ZCD_NV_PRECFGKEY, zgPreConfigKey);
        ; Setup parameters for call to function ZDSecMgrReadKeyFromNv
        MOV     A,#0x4
        LCALL   ?XSTACK_DISP0_8
        MOV     R4,DPL
        MOV     R5,DPH
        MOV     R2,#0x62
        MOV     R3,#0x0
        LCALL   ??ZDSecMgrReadKeyFromNv?relay
// 1664         SSP_UpdateNwkKey( zgPreConfigKey, 0 );
        ; Setup parameters for call to function SSP_UpdateNwkKey
        MOV     R1,#0x0
        MOV     A,#0x4
        LCALL   ?XSTACK_DISP0_8
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??SSP_UpdateNwkKey?relay
// 1665         SSP_SwitchNwkKey( 0 );
        ; Setup parameters for call to function SSP_SwitchNwkKey
        MOV     R1,#0x0
        LCALL   ??SSP_SwitchNwkKey?relay
// 1666 
// 1667         // clear local copy of key
// 1668         osal_memset(zgPreConfigKey, 0x00, SEC_KEY_LEN);
        ; Setup parameters for call to function osal_memset
        MOV     R4,#0x10
        MOV     R5,#0x0
        MOV     R1,#0x0
        MOV     A,#0x4
        LCALL   ?XSTACK_DISP0_8
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??osal_memset?relay
        SJMP    ??ZDSecMgrTransportKeyInd_6
// 1669       }
// 1670     }
// 1671     else
// 1672     {
// 1673       SSP_UpdateNwkKey( ind->key, ind->keySeqNum );
??ZDSecMgrTransportKeyInd_5:
        MOV     A,?V0 + 2
        ADD     A,#0x5
        MOV     R0,A
        MOV     A,?V0 + 3
        LCALL   ?Subroutine39 & 0xFFFF
??CrossCallReturnLabel_46:
        MOV     R1,A
        MOV     R2,?V0 + 0
        MOV     R3,?V0 + 1
        LCALL   ??SSP_UpdateNwkKey?relay
// 1674       if ( !_NIB.nwkKeyLoaded )
        MOV     DPTR,#_NIB + 61
        MOVX    A,@DPTR
        JNZ     ??ZDSecMgrTransportKeyInd_6
// 1675       {
// 1676         SSP_SwitchNwkKey( ind->keySeqNum );
        ; Setup parameters for call to function SSP_SwitchNwkKey
        MOV     DPL,R6
        MOV     DPH,R7
        MOVX    A,@DPTR
        MOV     R1,A
        LCALL   ??SSP_SwitchNwkKey?relay
// 1677       }
// 1678     }
// 1679 
// 1680     // handle next step in authentication process
// 1681     ZDSecMgrAuthNwkKey();
??ZDSecMgrTransportKeyInd_6:
        ; Setup parameters for call to function ZDSecMgrAuthNwkKey
        LCALL   ??ZDSecMgrAuthNwkKey?relay
        LJMP    ??ZDSecMgrTransportKeyInd_7 & 0xFFFF
// 1682   }
// 1683   else if ( ind->keyType == KEY_TYPE_TC_LINK )
??ZDSecMgrTransportKeyInd_2:
        MOV     A,#0x4
        XRL     A,R0
        JNZ     $+5
        LJMP    ??ZDSecMgrTransportKeyInd_7 & 0xFFFF
// 1684   {
// 1685     // This should not happen because TCLK should not be Tx
// 1686   }
// 1687   else if ( ind->keyType == KEY_TYPE_APP_LINK )
        MOV     A,#0x3
        XRL     A,R0
        JZ      $+5
        LJMP    ??ZDSecMgrTransportKeyInd_7 & 0xFFFF
// 1688   {
// 1689     if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_SE_STANDARD )
// 1690     {
// 1691       uint16           ami;
// 1692       ZDSecMgrEntry_t* entry;
// 1693 
// 1694       // get the address index
// 1695       if ( ZDSecMgrExtAddrLookup( ind->srcExtAddr, &ami ) != ZSuccess )
        ; Setup parameters for call to function ZDSecMgrExtAddrLookup
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        MOV     R4,DPL
        MOV     R5,DPH
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        LCALL   ??ZDSecMgrExtAddrLookup?relay
        MOV     A,R1
        JZ      ??ZDSecMgrTransportKeyInd_8
// 1696       {
// 1697         // store new EXT address
// 1698         ZDSecMgrAddrStore( INVALID_NODE_ADDR, ind->srcExtAddr, &ami );
        ; Setup parameters for call to function ZDSecMgrAddrStore
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        MOV     ?V0 + 2,DPL
        MOV     ?V0 + 3,DPH
        MOV     R0,#?V0 + 2
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 36)
        MOV     A,R6
        MOV     R4,A
        MOV     A,R7
        MOV     R5,A
        MOV     R2,#-0x2
        MOV     R3,#-0x1
        LCALL   ??ZDSecMgrAddrStore?relay
        MOV     A,#0x2
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 34)
// 1699         ZDP_NwkAddrReq( ind->srcExtAddr, ZDP_ADDR_REQTYPE_SINGLE, 0, 0 );
        ; Setup parameters for call to function ZDP_NwkAddrReq
        MOV     R5,#0x0
        MOV     R4,#0x0
        MOV     R1,#0x0
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        LCALL   ??ZDP_NwkAddrReq?relay
// 1700       }
// 1701 
// 1702       ZDSecMgrEntryLookupAMI( ami, &entry );
??ZDSecMgrTransportKeyInd_8:
        ; Setup parameters for call to function ZDSecMgrEntryLookupAMI
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     R4,DPL
        MOV     R5,DPH
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        LCALL   ??Subroutine59_0 & 0xFFFF
??CrossCallReturnLabel_102:
        LCALL   ??ZDSecMgrEntryLookupAMI?relay
// 1703 
// 1704       if ( entry == NULL )
        LCALL   ?Subroutine23 & 0xFFFF
??CrossCallReturnLabel_159:
        JNZ     ??CrossCallReturnLabel_136
// 1705       {
// 1706         // get new entry
// 1707         if ( ZDSecMgrEntryNew( &entry ) == ZSuccess )
        ; Setup parameters for call to function ZDSecMgrEntryNew
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??ZDSecMgrEntryNew?relay
        MOV     A,R1
        JNZ     ??CrossCallReturnLabel_136
// 1708         {
// 1709           // finish setting up entry
// 1710           entry->ami = ami;
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        LCALL   ?Subroutine20 & 0xFFFF
// 1711         }
// 1712       }
// 1713 
// 1714       ZDSecMgrLinkKeySet( ind->srcExtAddr, ind->key );
??CrossCallReturnLabel_136:
        ; Setup parameters for call to function APSME_LinkKeySet
        MOV     R4,?V0 + 0
        MOV     R5,?V0 + 1
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        LCALL   ??APSME_LinkKeySet?relay
// 1715 
// 1716 #if defined NV_RESTORE
// 1717       ZDSecMgrWriteNV();  // Write the control record for the new established link key to NV.
        ; Setup parameters for call to function ZDSecMgrWriteNV
        LCALL   ??ZDSecMgrWriteNV?relay
// 1718 #endif
// 1719     }
// 1720   }
// 1721 }
??ZDSecMgrTransportKeyInd_7:
        MOV     A,#0x14
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 14)
        MOV     R7,#0x6
        LJMP    ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock195

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine39:
          CFI Block cfiCond196 Using cfiCommon0
          CFI Function ZDSecMgrNewDeviceEvent
          CFI Conditional ??CrossCallReturnLabel_45
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 33)
          CFI Block cfiCond197 Using cfiCommon0
          CFI (cfiCond197) Function ZDSecMgrTransportKeyInd
          CFI (cfiCond197) Conditional ??CrossCallReturnLabel_46
          CFI (cfiCond197) R6 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond197) VB load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond197) V0 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond197) V1 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond197) V2 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond197) V3 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond197) V4 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond197) V5 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond197) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond197) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond197) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond197) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond197) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond197) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond197) CFA_SP SP+0
          CFI (cfiCond197) CFA_XSP16 add(XSP16, 34)
          CFI Block cfiPicker198 Using cfiCommon1
          CFI (cfiPicker198) NoFunction
          CFI (cfiPicker198) Picker
        ADDC    A,#0x0
        MOV     R1,A
        MOV     A,R0
        MOV     R6,A
        MOV     A,R1
        MOV     R7,A
        ; Setup parameters for call to function SSP_UpdateNwkKey
        MOV     DPL,R6
        MOV     DPH,R7
        MOVX    A,@DPTR
        RET
          CFI EndBlock cfiCond196
          CFI EndBlock cfiCond197
          CFI EndBlock cfiPicker198
// 1722 
// 1723 /******************************************************************************
// 1724  * @fn          ZDSecMgrUpdateDeviceInd
// 1725  *
// 1726  * @brief       Process the ZDO_UpdateDeviceInd_t message.
// 1727  *
// 1728  * @param       ind - [in] ZDO_UpdateDeviceInd_t indication
// 1729  *
// 1730  * @return      none
// 1731  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 1732 void ZDSecMgrUpdateDeviceInd( ZDO_UpdateDeviceInd_t* ind )
ZDSecMgrUpdateDeviceInd:
          CFI Block cfiBlock199 Using cfiCommon0
          CFI Function ZDSecMgrUpdateDeviceInd
        CODE
// 1733 {
        FUNCALL ZDSecMgrUpdateDeviceInd, ZDSecMgrDeviceJoin
        LOCFRAME ISTACK, 2, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 8, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 8, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        PUSH    DPL
          CFI DPL0 Frame(CFA_SP, 4)
          CFI CFA_SP SP+-4
        PUSH    DPH
          CFI DPH0 Frame(CFA_SP, 5)
          CFI CFA_SP SP+-5
        ; Saved register size: 2
        ; Auto size: 8
        MOV     A,#-0x8
        LCALL   ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 8)
// 1734   ZDSecMgrDevice_t device;
// 1735 
// 1736   device.nwkAddr    = ind->devAddr;
        MOV     A,R2
        ADD     A,#0xc
        MOV     DPL,A
        MOV     A,R3
        LCALL   ??Subroutine71_0 & 0xFFFF
??CrossCallReturnLabel_181:
        LCALL   ?Subroutine26 & 0xFFFF
??CrossCallReturnLabel_19:
        LCALL   ??Subroutine63_0 & 0xFFFF
// 1737   device.extAddr    = ind->devExtAddr;
??CrossCallReturnLabel_132:
        MOV     A,R2
        ADD     A,#0x4
        MOV     R0,A
        MOV     A,R3
        ADDC    A,#0x0
        MOV     R1,A
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        LCALL   ?Subroutine14 & 0xFFFF
// 1738   device.parentAddr = ind->srcAddr;
??CrossCallReturnLabel_1:
        LCALL   ?XSTACK_DISP0_8
        LCALL   ??Subroutine63_0 & 0xFFFF
// 1739   device.devStatus  = DEV_SEC_INIT_STATUS;
??CrossCallReturnLabel_133:
        MOV     A,#0x7
        LCALL   ?XSTACK_DISP0_8
        MOV     A,#0x4
        MOVX    @DPTR,A
// 1740   device.secure     = FALSE;
        MOV     A,#0x6
        LCALL   ?XSTACK_DISP0_8
        CLR     A
        MOVX    @DPTR,A
// 1741 
// 1742   // Trust Center should identify the type of JOIN/REJOIN and
// 1743   // Transport the NWK key accordingly, it will only be transported for:
// 1744   //              APSME_UD_STANDARD_UNSECURED_JOIN
// 1745   //   OR         APSME_UD_STANDARD_TRUST_CENTER_REJOIN
// 1746   if ( ind->status != APSME_UD_DEVICE_LEFT )
        MOV     A,R2
        ADD     A,#0xe
        MOV     DPL,A
        MOV     A,R3
        LCALL   ??Subroutine71_0 & 0xFFFF
??CrossCallReturnLabel_182:
        MOVX    A,@DPTR
        MOV     R0,A
        MOV     A,#0x2
        XRL     A,R0
        JZ      ??ZDSecMgrUpdateDeviceInd_0
// 1747   {
// 1748     if ( ind->status == APSME_UD_STANDARD_SECURED_REJOIN )
        MOV     A,R0
        JNZ     ??ZDSecMgrUpdateDeviceInd_1
// 1749     {
// 1750       device.devStatus &= ~DEV_SEC_INIT_STATUS;
// 1751       device.devStatus |=  DEV_SEC_AUTH_STATUS;
        MOV     A,#0x7
        LCALL   ?XSTACK_DISP0_8
        MOV     A,#0x8
        MOVX    @DPTR,A
// 1752       device.secure = TRUE;
        MOV     A,#0x6
        LCALL   ?XSTACK_DISP0_8
        MOV     A,#0x1
        MOVX    @DPTR,A
// 1753     }
// 1754 
// 1755     ZDSecMgrDeviceJoin( &device );
??ZDSecMgrUpdateDeviceInd_1:
        ; Setup parameters for call to function ZDSecMgrDeviceJoin
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??ZDSecMgrDeviceJoin?relay
// 1756   }
// 1757 }
??ZDSecMgrUpdateDeviceInd_0:
        LJMP    ?Subroutine4 & 0xFFFF
          CFI EndBlock cfiBlock199

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine26:
          CFI Block cfiCond200 Using cfiCommon0
          CFI Function ZDSecMgrNewDeviceEvent
          CFI Conditional ??CrossCallReturnLabel_18
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 33)
          CFI Block cfiCond201 Using cfiCommon0
          CFI (cfiCond201) Function ZDSecMgrUpdateDeviceInd
          CFI (cfiCond201) Conditional ??CrossCallReturnLabel_19
          CFI (cfiCond201) DPL0 Frame(CFA_SP, 4)
          CFI (cfiCond201) DPH0 Frame(CFA_SP, 5)
          CFI (cfiCond201) CFA_SP SP+-5
          CFI (cfiCond201) CFA_XSP16 add(XSP16, 8)
          CFI Block cfiPicker202 Using cfiCommon1
          CFI (cfiPicker202) NoFunction
          CFI (cfiPicker202) Picker
        LCALL   ?Subroutine45 & 0xFFFF
??CrossCallReturnLabel_56:
        RET
          CFI EndBlock cfiCond200
          CFI EndBlock cfiCond201
          CFI EndBlock cfiPicker202

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine45:
          CFI Block cfiCond203 Using cfiCommon0
          CFI Function ZDSecMgrTransportKeyInd
          CFI Conditional ??CrossCallReturnLabel_55, ??CrossCallReturnLabel_136
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 34)
          CFI Block cfiCond204 Using cfiCommon0
          CFI (cfiCond204) Function ZDSecMgrAddLinkKey
          CFI (cfiCond204) Conditional ??CrossCallReturnLabel_55, ??CrossCallReturnLabel_137
          CFI (cfiCond204) R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond204) VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond204) V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond204) V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond204) V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond204) V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond204) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond204) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond204) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond204) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond204) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond204) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond204) CFA_SP SP+0
          CFI (cfiCond204) CFA_XSP16 add(XSP16, 16)
          CFI Block cfiCond205 Using cfiCommon0
          CFI (cfiCond205) Function ZDSecMgrNewDeviceEvent
          CFI (cfiCond205) Conditional ??CrossCallReturnLabel_56, ??CrossCallReturnLabel_18
          CFI (cfiCond205) R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond205) VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond205) V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond205) V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond205) V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond205) V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond205) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond205) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond205) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond205) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond205) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond205) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond205) CFA_SP SP+0
          CFI (cfiCond205) CFA_XSP16 add(XSP16, 33)
          CFI Block cfiCond206 Using cfiCommon0
          CFI (cfiCond206) Function ZDSecMgrUpdateDeviceInd
          CFI (cfiCond206) Conditional ??CrossCallReturnLabel_56, ??CrossCallReturnLabel_19
          CFI (cfiCond206) DPL0 Frame(CFA_SP, 4)
          CFI (cfiCond206) DPH0 Frame(CFA_SP, 5)
          CFI (cfiCond206) CFA_SP SP+-5
          CFI (cfiCond206) CFA_XSP16 add(XSP16, 8)
          CFI Block cfiPicker207 Using cfiCommon1
          CFI (cfiPicker207) NoFunction
          CFI (cfiPicker207) Picker
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R1,A
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        RET
          CFI EndBlock cfiCond203
          CFI EndBlock cfiCond204
          CFI EndBlock cfiCond205
          CFI EndBlock cfiCond206
          CFI EndBlock cfiPicker207

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine14:
          CFI Block cfiCond208 Using cfiCommon0
          CFI Function ZDSecMgrDeviceJoinFwd
          CFI Conditional ??CrossCallReturnLabel_0
          CFI DPL0 Frame(CFA_SP, 4)
          CFI DPH0 Frame(CFA_SP, 5)
          CFI CFA_SP SP+-5
          CFI CFA_XSP16 add(XSP16, 8)
          CFI Block cfiCond209 Using cfiCommon0
          CFI (cfiCond209) Function ZDSecMgrUpdateDeviceInd
          CFI (cfiCond209) Conditional ??CrossCallReturnLabel_1
          CFI (cfiCond209) DPL0 Frame(CFA_SP, 4)
          CFI (cfiCond209) DPH0 Frame(CFA_SP, 5)
          CFI (cfiCond209) CFA_SP SP+-5
          CFI (cfiCond209) CFA_XSP16 add(XSP16, 8)
          CFI Block cfiPicker210 Using cfiCommon1
          CFI (cfiPicker210) NoFunction
          CFI (cfiPicker210) Picker
        MOV     A,R0
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R1
        LCALL   ?Subroutine43 & 0xFFFF
??CrossCallReturnLabel_54:
        INC     DPTR
        INC     DPTR
        LCALL   ?Subroutine46 & 0xFFFF
??CrossCallReturnLabel_174:
        MOV     A,#0x4
        RET
          CFI EndBlock cfiCond208
          CFI EndBlock cfiCond209
          CFI EndBlock cfiPicker210
// 1758 
// 1759 /******************************************************************************
// 1760  * @fn          ZDSecMgrRemoveDeviceInd
// 1761  *
// 1762  * @brief       Process the ZDO_RemoveDeviceInd_t message.
// 1763  *
// 1764  * @param       ind - [in] ZDO_RemoveDeviceInd_t indication
// 1765  *
// 1766  * @return      none
// 1767  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 1768 void ZDSecMgrRemoveDeviceInd( ZDO_RemoveDeviceInd_t* ind )
ZDSecMgrRemoveDeviceInd:
          CFI Block cfiBlock211 Using cfiCommon0
          CFI Function ZDSecMgrRemoveDeviceInd
        CODE
// 1769 {
        FUNCALL ZDSecMgrRemoveDeviceInd, APSME_LookupNwkAddr
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 17, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 17, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrRemoveDeviceInd, NLME_GetShortAddr
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 17, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 17, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrRemoveDeviceInd, ZDSecMgrDeviceRemove
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 17, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 17, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x9
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 8
        MOV     A,#-0x8
        LCALL   ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 17)
// 1770   ZDSecMgrDevice_t device;
// 1771 
// 1772   // only accept from Trust Center
// 1773   if ( ind->srcAddr == APSME_TRUSTCENTER_NWKADDR )
        MOV     DPL,R2
        MOV     DPH,R3
        INC     DPTR
        INC     DPTR
        LCALL   ??Subroutine69_0 & 0xFFFF
??CrossCallReturnLabel_157:
        JNZ     ??ZDSecMgrRemoveDeviceInd_0
// 1774   {
// 1775     // look up NWK address
// 1776     if ( APSME_LookupNwkAddr( ind->childExtAddr, &device.nwkAddr ) == TRUE )
        MOV     A,R2
        ADD     A,#0x4
        LCALL   ?Subroutine36 & 0xFFFF
??CrossCallReturnLabel_44:
        LCALL   ??APSME_LookupNwkAddr?relay
        MOV     A,R1
        XRL     A,#0x1
        JNZ     ??ZDSecMgrRemoveDeviceInd_0
// 1777     {
// 1778       device.parentAddr = NLME_GetShortAddr();
        ; Setup parameters for call to function NLME_GetShortAddr
        LCALL   ??NLME_GetShortAddr?relay
        MOV     A,#0x4
        LCALL   ?XSTACK_DISP0_8
        LCALL   ??Subroutine57_0 & 0xFFFF
// 1779       device.extAddr    = ind->childExtAddr;
// 1780 
// 1781       // remove device
// 1782       ZDSecMgrDeviceRemove( &device );
// 1783     }
// 1784   }
??CrossCallReturnLabel_88:
        LCALL   ?XSTACK_DISP0_8
        MOV     A,R6
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R7
        LCALL   ??Subroutine64_0 & 0xFFFF
??CrossCallReturnLabel_145:
        LCALL   ??ZDSecMgrDeviceRemove?relay
// 1785 }
??ZDSecMgrRemoveDeviceInd_0:
        LJMP    ?Subroutine8 & 0xFFFF
          CFI EndBlock cfiBlock211

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine36:
          CFI Block cfiCond212 Using cfiCommon0
          CFI Function ZDSecMgrAppKeyReq
          CFI Conditional ??CrossCallReturnLabel_43
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 49)
          CFI Block cfiCond213 Using cfiCommon0
          CFI (cfiCond213) Function ZDSecMgrRemoveDeviceInd
          CFI (cfiCond213) Conditional ??CrossCallReturnLabel_44
          CFI (cfiCond213) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond213) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond213) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond213) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond213) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond213) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond213) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond213) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond213) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond213) CFA_SP SP+0
          CFI (cfiCond213) CFA_XSP16 add(XSP16, 17)
          CFI Block cfiPicker214 Using cfiCommon1
          CFI (cfiPicker214) NoFunction
          CFI (cfiPicker214) Picker
        MOV     R6,A
        MOV     A,R3
        ADDC    A,#0x0
        MOV     R7,A
        ; Setup parameters for call to function APSME_LookupNwkAddr
        ; Setup parameters for call to function APSME_LookupNwkAddr
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     R4,DPL
        MOV     R5,DPH
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        RET
          CFI EndBlock cfiCond212
          CFI EndBlock cfiCond213
          CFI EndBlock cfiPicker214

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine10:
          CFI Block cfiCond215 Using cfiCommon0
          CFI Function ZDSecMgrEntryLookup
          CFI Conditional ??CrossCallReturnLabel_138
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 22)
          CFI Block cfiCond216 Using cfiCommon0
          CFI (cfiCond216) Function ZDSecMgrRequestAppKey
          CFI (cfiCond216) Conditional ??CrossCallReturnLabel_139
          CFI (cfiCond216) DPL0 Frame(CFA_SP, 4)
          CFI (cfiCond216) DPH0 Frame(CFA_SP, 5)
          CFI (cfiCond216) CFA_SP SP+-5
          CFI (cfiCond216) CFA_XSP16 add(XSP16, 4)
          CFI Block cfiPicker217 Using cfiCommon1
          CFI (cfiPicker217) NoFunction
          CFI (cfiPicker217) Picker
        MOV     A,R2
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R3
          CFI EndBlock cfiCond215
          CFI EndBlock cfiCond216
          CFI EndBlock cfiPicker217
        REQUIRE ??Subroutine64_0
        ; // Fall through to label ??Subroutine64_0

        RSEG BANKED_CODE:CODE:NOROOT(0)
??Subroutine64_0:
          CFI Block cfiCond218 Using cfiCommon0
          CFI Function ZDSecMgrSendNwkKey
          CFI Conditional ??CrossCallReturnLabel_140
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 46)
          CFI Block cfiCond219 Using cfiCommon0
          CFI (cfiCond219) Function ZDSecMgrDeviceRemove
          CFI (cfiCond219) Conditional ??CrossCallReturnLabel_141
          CFI (cfiCond219) R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond219) VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond219) V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond219) V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond219) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond219) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond219) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond219) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond219) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond219) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond219) CFA_SP SP+0
          CFI (cfiCond219) CFA_XSP16 add(XSP16, 20)
          CFI Block cfiCond220 Using cfiCommon0
          CFI (cfiCond220) Function ZDSecMgrDeviceJoinFwd
          CFI (cfiCond220) Conditional ??CrossCallReturnLabel_142
          CFI (cfiCond220) DPL0 Frame(CFA_SP, 4)
          CFI (cfiCond220) DPH0 Frame(CFA_SP, 5)
          CFI (cfiCond220) CFA_SP SP+-5
          CFI (cfiCond220) CFA_XSP16 add(XSP16, 8)
          CFI Block cfiCond221 Using cfiCommon0
          CFI (cfiCond221) Function ZDSecMgrDeviceJoinFwd
          CFI (cfiCond221) Conditional ??CrossCallReturnLabel_143
          CFI (cfiCond221) DPL0 Frame(CFA_SP, 4)
          CFI (cfiCond221) DPH0 Frame(CFA_SP, 5)
          CFI (cfiCond221) CFA_SP SP+-5
          CFI (cfiCond221) CFA_XSP16 add(XSP16, 8)
          CFI Block cfiCond222 Using cfiCommon0
          CFI (cfiCond222) Function ZDSecMgrNewDeviceEvent
          CFI (cfiCond222) Conditional ??CrossCallReturnLabel_144
          CFI (cfiCond222) R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond222) VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond222) V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond222) V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond222) V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond222) V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond222) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond222) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond222) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond222) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond222) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond222) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond222) CFA_SP SP+0
          CFI (cfiCond222) CFA_XSP16 add(XSP16, 33)
          CFI Block cfiCond223 Using cfiCommon0
          CFI (cfiCond223) Function ZDSecMgrRemoveDeviceInd
          CFI (cfiCond223) Conditional ??CrossCallReturnLabel_145
          CFI (cfiCond223) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond223) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond223) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond223) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond223) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond223) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond223) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond223) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond223) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond223) CFA_SP SP+0
          CFI (cfiCond223) CFA_XSP16 add(XSP16, 17)
          CFI Block cfiCond224 Using cfiCommon0
          CFI (cfiCond224) Function ZDSecMgrAPSRemove
          CFI (cfiCond224) Conditional ??CrossCallReturnLabel_146
          CFI (cfiCond224) DPL0 Frame(CFA_SP, 4)
          CFI (cfiCond224) DPH0 Frame(CFA_SP, 5)
          CFI (cfiCond224) CFA_SP SP+-5
          CFI (cfiCond224) CFA_XSP16 add(XSP16, 8)
          CFI Block cfiCond225 Using cfiCommon0
          CFI (cfiCond225) Function ZDSecMgrEntryLookup
          CFI (cfiCond225) Conditional ??CrossCallReturnLabel_138
          CFI (cfiCond225) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond225) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond225) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond225) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond225) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond225) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond225) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond225) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond225) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond225) CFA_SP SP+0
          CFI (cfiCond225) CFA_XSP16 add(XSP16, 22)
          CFI Block cfiCond226 Using cfiCommon0
          CFI (cfiCond226) Function ZDSecMgrRequestAppKey
          CFI (cfiCond226) Conditional ??CrossCallReturnLabel_139
          CFI (cfiCond226) DPL0 Frame(CFA_SP, 4)
          CFI (cfiCond226) DPH0 Frame(CFA_SP, 5)
          CFI (cfiCond226) CFA_SP SP+-5
          CFI (cfiCond226) CFA_XSP16 add(XSP16, 4)
          CFI Block cfiPicker227 Using cfiCommon1
          CFI (cfiPicker227) NoFunction
          CFI (cfiPicker227) Picker
        MOVX    @DPTR,A
        ; Setup parameters for call to function AddrMgrEntryLookupNwk
        ; Setup parameters for call to function APSME_RequestKeyReq
        ; Setup parameters for call to function NLME_LeaveReq
        ; Setup parameters for call to function APSME_UpdateDeviceReq
        ; Setup parameters for call to function APSME_UpdateDeviceReq
        ; Setup parameters for call to function ZDSecMgrDeviceNew
        ; Setup parameters for call to function ZDSecMgrDeviceRemove
        ; Setup parameters for call to function ZDSecMgrDeviceRemove
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     R2,DPL
        MOV     R3,DPH
        RET
          CFI EndBlock cfiCond218
          CFI EndBlock cfiCond219
          CFI EndBlock cfiCond220
          CFI EndBlock cfiCond221
          CFI EndBlock cfiCond222
          CFI EndBlock cfiCond223
          CFI EndBlock cfiCond224
          CFI EndBlock cfiCond225
          CFI EndBlock cfiCond226
          CFI EndBlock cfiPicker227
// 1786 
// 1787 /******************************************************************************
// 1788  * @fn          ZDSecMgrRequestKeyInd
// 1789  *
// 1790  * @brief       Process the ZDO_RequestKeyInd_t message.
// 1791  *
// 1792  * @param       ind - [in] ZDO_RequestKeyInd_t indication
// 1793  *
// 1794  * @return      none
// 1795  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 1796 void ZDSecMgrRequestKeyInd( ZDO_RequestKeyInd_t* ind )
ZDSecMgrRequestKeyInd:
          CFI Block cfiBlock228 Using cfiCommon0
          CFI Function ZDSecMgrRequestKeyInd
        CODE
// 1797 {
        FUNCALL ZDSecMgrRequestKeyInd, ZDSecMgrAppKeyReq
        LOCFRAME ISTACK, 2, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 0, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 0, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        PUSH    DPL
          CFI DPL0 Frame(CFA_SP, 4)
          CFI CFA_SP SP+-4
        PUSH    DPH
          CFI DPH0 Frame(CFA_SP, 5)
          CFI CFA_SP SP+-5
        ; Saved register size: 2
        ; Auto size: 0
// 1798   if ( ind->keyType == KEY_TYPE_NWK )
        MOV     DPL,R2
        MOV     DPH,R3
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R0,A
        MOV     A,#0x1
        XRL     A,R0
        JZ      ??ZDSecMgrRequestKeyInd_0
// 1799   {
// 1800   }
// 1801   else if ( ind->keyType == KEY_TYPE_APP_MASTER )
        MOV     A,#0x2
        XRL     A,R0
        JNZ     ??ZDSecMgrRequestKeyInd_0
// 1802   {
// 1803     ZDSecMgrAppKeyReq( ind );
        ; Setup parameters for call to function ZDSecMgrAppKeyReq
        LCALL   ??ZDSecMgrAppKeyReq?relay
// 1804   }
// 1805   else if ( ind->keyType == KEY_TYPE_TC_LINK )
// 1806   {
// 1807   }
// 1808   //else ignore
// 1809 }
??ZDSecMgrRequestKeyInd_0:
        LJMP    ??Subroutine61_0 & 0xFFFF
          CFI EndBlock cfiBlock228
// 1810 
// 1811 /******************************************************************************
// 1812  * @fn          ZDSecMgrSwitchKeyInd
// 1813  *
// 1814  * @brief       Process the ZDO_SwitchKeyInd_t message.
// 1815  *
// 1816  * @param       ind - [in] ZDO_SwitchKeyInd_t indication
// 1817  *
// 1818  * @return      none
// 1819  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 1820 void ZDSecMgrSwitchKeyInd( ZDO_SwitchKeyInd_t* ind )
ZDSecMgrSwitchKeyInd:
          CFI Block cfiBlock229 Using cfiCommon0
          CFI Function ZDSecMgrSwitchKeyInd
        CODE
// 1821 {
        FUNCALL ZDSecMgrSwitchKeyInd, SSP_SwitchNwkKey
        LOCFRAME ISTACK, 2, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 0, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 0, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrSwitchKeyInd, ZDApp_NVUpdate
        LOCFRAME ISTACK, 2, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 0, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 0, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        PUSH    DPL
          CFI DPL0 Frame(CFA_SP, 4)
          CFI CFA_SP SP+-4
        PUSH    DPH
          CFI DPH0 Frame(CFA_SP, 5)
          CFI CFA_SP SP+-5
        ; Saved register size: 2
        ; Auto size: 0
// 1822   SSP_SwitchNwkKey( ind->keySeqNum );
        ; Setup parameters for call to function SSP_SwitchNwkKey
        MOV     DPL,R2
        MOV     DPH,R3
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R1,A
        LCALL   ??SSP_SwitchNwkKey?relay
// 1823 
// 1824   // Save if nv
// 1825   ZDApp_NVUpdate();
        ; Setup parameters for call to function ZDApp_NVUpdate
        LCALL   ??ZDApp_NVUpdate?relay
// 1826 }
        LJMP    ??Subroutine61_0 & 0xFFFF
          CFI EndBlock cfiBlock229
// 1827 
// 1828 #if ( ZG_BUILD_COORDINATOR_TYPE )
// 1829 /******************************************************************************
// 1830  * @fn          ZDSecMgrUpdateNwkKey
// 1831  *
// 1832  * @brief       Load a new NWK key and trigger a network update to the dstAddr.
// 1833  *
// 1834  * @param       key       - [in] new NWK key
// 1835  * @param       keySeqNum - [in] new NWK key sequence number
// 1836  *
// 1837  * @return      ZStatus_t
// 1838  */
// 1839 ZStatus_t ZDSecMgrUpdateNwkKey( uint8* key, uint8 keySeqNum, uint16 dstAddr )
// 1840 {
// 1841   ZStatus_t               status;
// 1842   APSME_TransportKeyReq_t req;
// 1843 
// 1844   // initialize common elements of local variables
// 1845   req.keyType   = KEY_TYPE_NWK;
// 1846 
// 1847   req.dstAddr   = dstAddr;
// 1848   req.keySeqNum = keySeqNum;
// 1849   req.key       = key;
// 1850   req.extAddr   = NULL;
// 1851   req.nwkSecure = TRUE;
// 1852   req.tunnel    = NULL;
// 1853 
// 1854   if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_SE_STANDARD )
// 1855   {
// 1856     // Broadcast transport NWK key
// 1857     if (( dstAddr == NWK_BROADCAST_SHORTADDR_DEVALL ) ||
// 1858         ( dstAddr == NWK_BROADCAST_SHORTADDR_DEVZCZR) ||
// 1859         ( dstAddr == NWK_BROADCAST_SHORTADDR_DEVRXON))
// 1860     {
// 1861       req.apsSecure = FALSE;
// 1862       status = APSME_TransportKeyReq( &req );
// 1863     }
// 1864     else
// 1865     {
// 1866       AddrMgrEntry_t          addrEntry;
// 1867 
// 1868       addrEntry.user = ADDRMGR_USER_SECURITY;
// 1869       addrEntry.nwkAddr = dstAddr;
// 1870 
// 1871       status = ZFailure;
// 1872 
// 1873       if ( AddrMgrEntryLookupNwk( &addrEntry ) == TRUE )
// 1874       {
// 1875         req.extAddr = addrEntry.extAddr;
// 1876         req.apsSecure = TRUE;
// 1877         status = APSME_TransportKeyReq( &req );
// 1878       }
// 1879     }
// 1880   }
// 1881   else // ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_RESIDENTIAL )
// 1882   {
// 1883     req.apsSecure = FALSE;
// 1884     status = APSME_TransportKeyReq( &req );
// 1885   }
// 1886 
// 1887   SSP_UpdateNwkKey( key, keySeqNum );
// 1888 
// 1889   // Save if nv
// 1890   ZDApp_NVUpdate();
// 1891 
// 1892   return status;
// 1893 }
// 1894 #endif // ( ZG_BUILD_COORDINATOR_TYPE )
// 1895 
// 1896 #if ( ZG_BUILD_COORDINATOR_TYPE )
// 1897 /******************************************************************************
// 1898  * @fn          ZDSecMgrSwitchNwkKey
// 1899  *
// 1900  * @brief       Causes the NWK key to switch via a network command to the dstAddr.
// 1901  *
// 1902  * @param       keySeqNum - [in] new NWK key sequence number
// 1903  *
// 1904  * @return      ZStatus_t
// 1905  */
// 1906 ZStatus_t ZDSecMgrSwitchNwkKey( uint8 keySeqNum, uint16 dstAddr )
// 1907 {
// 1908   ZStatus_t            status;
// 1909   APSME_SwitchKeyReq_t req;
// 1910 
// 1911   // initialize common elements of local variables
// 1912   req.dstAddr = dstAddr;
// 1913   req.keySeqNum = keySeqNum;
// 1914 
// 1915   if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_SE_STANDARD )
// 1916   {
// 1917     // Broadcast switch NWK key
// 1918     if (( dstAddr == NWK_BROADCAST_SHORTADDR_DEVALL ) ||
// 1919         ( dstAddr == NWK_BROADCAST_SHORTADDR_DEVZCZR) ||
// 1920         ( dstAddr == NWK_BROADCAST_SHORTADDR_DEVRXON))
// 1921     {
// 1922       req.apsSecure = FALSE;
// 1923       status = APSME_SwitchKeyReq( &req );
// 1924     }
// 1925     else
// 1926     {
// 1927       AddrMgrEntry_t          addrEntry;
// 1928 
// 1929       addrEntry.user = ADDRMGR_USER_SECURITY;
// 1930       addrEntry.nwkAddr = dstAddr;
// 1931 
// 1932       status = ZFailure;
// 1933 
// 1934       if ( AddrMgrEntryLookupNwk( &addrEntry ) == TRUE )
// 1935       {
// 1936         req.dstAddr = addrEntry.nwkAddr;
// 1937         req.apsSecure = TRUE;
// 1938         status = APSME_SwitchKeyReq( &req );
// 1939       }
// 1940     }
// 1941   }
// 1942   else // ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_RESIDENTIAL )
// 1943   {
// 1944     req.apsSecure = FALSE;
// 1945     status = APSME_SwitchKeyReq( &req );
// 1946   }
// 1947 
// 1948   SSP_SwitchNwkKey( keySeqNum );
// 1949 
// 1950   // Save if nv
// 1951   ZDApp_NVUpdate();
// 1952 
// 1953   return status;
// 1954 }
// 1955 #endif // ( ZG_BUILD_COORDINATOR_TYPE )
// 1956 
// 1957 /******************************************************************************
// 1958  * @fn          ZDSecMgrRequestAppKey
// 1959  *
// 1960  * @brief       Request an application key with partner.
// 1961  *
// 1962  * @param       partExtAddr - [in] partner extended address
// 1963  *
// 1964  * @return      ZStatus_t
// 1965  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 1966 ZStatus_t ZDSecMgrRequestAppKey( uint8 *partExtAddr )
ZDSecMgrRequestAppKey:
          CFI Block cfiBlock230 Using cfiCommon0
          CFI Function ZDSecMgrRequestAppKey
        CODE
// 1967 {
        FUNCALL ZDSecMgrRequestAppKey, APSME_RequestKeyReq
        LOCFRAME ISTACK, 2, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 4, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 4, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        PUSH    DPL
          CFI DPL0 Frame(CFA_SP, 4)
          CFI CFA_SP SP+-4
        PUSH    DPH
          CFI DPH0 Frame(CFA_SP, 5)
          CFI CFA_SP SP+-5
        ; Saved register size: 2
        ; Auto size: 4
        MOV     A,#-0x4
        LCALL   ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 4)
// 1968   ZStatus_t status;
// 1969   APSME_RequestKeyReq_t req;
// 1970 
// 1971   req.dstAddr = 0;
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        CLR     A
        MOVX    @DPTR,A
// 1972   req.keyType = KEY_TYPE_APP_MASTER;
        INC     A
        LCALL   ?XSTACK_DISP0_8
        MOV     A,#0x2
        MOVX    @DPTR,A
// 1973 
// 1974   req.partExtAddr = partExtAddr;
        LCALL   ?XSTACK_DISP0_8
        LCALL   ?Subroutine10 & 0xFFFF
// 1975   status = APSME_RequestKeyReq( &req );
// 1976 
// 1977   return status;
??CrossCallReturnLabel_139:
        LCALL   ??APSME_RequestKeyReq?relay
        MOV     A,#0x4
        LJMP    ??Subroutine60_0 & 0xFFFF
          CFI EndBlock cfiBlock230
// 1978 }
// 1979 
// 1980 #if ( ZG_BUILD_JOINING_TYPE )
// 1981 /******************************************************************************
// 1982  * @fn          ZDSecMgrSetupPartner
// 1983  *
// 1984  * @brief       Setup for application key partner.
// 1985  *
// 1986  * @param       partNwkAddr - [in] partner network address
// 1987  *
// 1988  * @return      ZStatus_t
// 1989  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 1990 ZStatus_t ZDSecMgrSetupPartner( uint16 partNwkAddr, uint8* partExtAddr )
ZDSecMgrSetupPartner:
          CFI Block cfiBlock231 Using cfiCommon0
          CFI Function ZDSecMgrSetupPartner
        CODE
// 1991 {
        FUNCALL ZDSecMgrSetupPartner, AddrMgrExtAddrSet
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 24, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 24, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrSetupPartner, AddrMgrEntryUpdate
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 24, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 24, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrSetupPartner, ZDP_NwkAddrReq
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 24, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 24, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrSetupPartner, AddrMgrExtAddrValid
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 24, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 24, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrSetupPartner, ZDP_IEEEAddrReq
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 24, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 24, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0xb
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 11)
        ; Saved register size: 11
        ; Auto size: 13
        MOV     A,#-0xd
        LCALL   ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 24)
        MOV     ?V0 + 0,R2
        MOV     ?V0 + 1,R3
        MOV     A,R4
        MOV     R6,A
        MOV     A,R5
        MOV     R7,A
// 1992   AddrMgrEntry_t entry;
// 1993   ZStatus_t      status;
// 1994 
// 1995   status = ZFailure;
        MOV     ?V0 + 2,#0x1
// 1996 
// 1997   // update the address manager
// 1998   entry.user    = ADDRMGR_USER_SECURITY;
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     A,#0x2
        MOVX    @DPTR,A
// 1999   entry.nwkAddr = partNwkAddr;
        DEC     A
        LCALL   ?XSTACK_DISP0_8
        LCALL   ?Subroutine18 & 0xFFFF
// 2000   AddrMgrExtAddrSet( entry.extAddr, partExtAddr );
??CrossCallReturnLabel_10:
        LCALL   ?XSTACK_DISP0_8
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??AddrMgrExtAddrSet?relay
// 2001 
// 2002   if ( AddrMgrEntryUpdate( &entry ) == TRUE )
        ; Setup parameters for call to function AddrMgrEntryUpdate
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??AddrMgrEntryUpdate?relay
        MOV     A,R1
        XRL     A,#0x1
        JNZ     ??ZDSecMgrSetupPartner_0
// 2003   {
// 2004     status = ZSuccess;
        MOV     ?V0 + 2,#0x0
// 2005 
// 2006     // check for address discovery
// 2007     if ( partNwkAddr == INVALID_NODE_ADDR )
        MOV     A,#-0x2
        XRL     A,?V0 + 0
        JNZ     ??ZDSecMgrSetupPartner_1
        MOV     A,#-0x1
        XRL     A,?V0 + 1
??ZDSecMgrSetupPartner_1:
        JNZ     ??ZDSecMgrSetupPartner_2
// 2008     {
// 2009       status = ZDP_NwkAddrReq( partExtAddr, ZDP_ADDR_REQTYPE_SINGLE, 0, 0 );
        ; Setup parameters for call to function ZDP_NwkAddrReq
        MOV     R5,#0x0
        MOV     R4,#0x0
        MOV     R1,#0x0
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        LCALL   ??ZDP_NwkAddrReq?relay
        SJMP    ??ZDSecMgrSetupPartner_3
// 2010     }
// 2011     else if ( !AddrMgrExtAddrValid( partExtAddr ) )
??ZDSecMgrSetupPartner_2:
        ; Setup parameters for call to function AddrMgrExtAddrValid
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        LCALL   ??AddrMgrExtAddrValid?relay
        MOV     A,R1
        JNZ     ??ZDSecMgrSetupPartner_0
// 2012     {
// 2013       status = ZDP_IEEEAddrReq( partNwkAddr, ZDP_ADDR_REQTYPE_SINGLE, 0, 0 );
        ; Setup parameters for call to function ZDP_IEEEAddrReq
        MOV     R5,#0x0
        MOV     R4,#0x0
        MOV     R1,#0x0
        MOV     R2,?V0 + 0
        MOV     R3,?V0 + 1
        LCALL   ??ZDP_IEEEAddrReq?relay
??ZDSecMgrSetupPartner_3:
        MOV     A,R1
        MOV     ?V0 + 2,A
// 2014     }
// 2015   }
// 2016 
// 2017   return status;
??ZDSecMgrSetupPartner_0:
        MOV     R1,?V0 + 2
        MOV     A,#0xd
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 11)
        MOV     R7,#0x3
        LJMP    ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock231
// 2018 }
// 2019 #endif // ( ZG_BUILD_JOINING_TYPE )
// 2020 
// 2021 #if ( ZG_BUILD_COORDINATOR_TYPE )
// 2022 /******************************************************************************
// 2023  * @fn          ZDSecMgrAppKeyTypeSet
// 2024  *
// 2025  * @brief       Set application key type.
// 2026  *
// 2027  * @param       keyType - [in] application key type (KEY_TYPE_APP_MASTER@2 or
// 2028  *                                                   KEY_TYPE_APP_LINK@3
// 2029  *
// 2030  * @return      ZStatus_t
// 2031  */
// 2032 ZStatus_t ZDSecMgrAppKeyTypeSet( uint8 keyType )
// 2033 {
// 2034   if ( keyType == KEY_TYPE_APP_LINK )
// 2035   {
// 2036     ZDSecMgrAppKeyType = KEY_TYPE_APP_LINK;
// 2037   }
// 2038   else
// 2039   {
// 2040     ZDSecMgrAppKeyType = KEY_TYPE_APP_MASTER;
// 2041   }
// 2042 
// 2043   return ZSuccess;
// 2044 }
// 2045 #endif
// 2046 
// 2047 /******************************************************************************
// 2048  * ZigBee Device Security Manager - Stub Implementations
// 2049  */
// 2050 
// 2051 
// 2052 /******************************************************************************
// 2053  * @fn          ZDSecMgrLinkKeySet (stubs APSME_LinkKeySet)
// 2054  *
// 2055  * @brief       Set <APSME_LinkKeyData_t> for specified NWK address.
// 2056  *
// 2057  * @param       extAddr - [in] EXT address
// 2058  * @param       data    - [in] APSME_LinkKeyData_t
// 2059  *
// 2060  * @return      ZStatus_t
// 2061  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 2062 ZStatus_t ZDSecMgrLinkKeySet( uint8* extAddr, uint8* key )
APSME_LinkKeySet:
          CFI Block cfiBlock232 Using cfiCommon0
          CFI Function APSME_LinkKeySet
        CODE
// 2063 {
        FUNCALL APSME_LinkKeySet, ZDSecMgrEntryLookupExtGetIndex
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 21, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 21, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_LinkKeySet, osal_mem_alloc
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 19, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 19, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_LinkKeySet, osal_nv_read
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 23, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 23, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_LinkKeySet, osal_memcpy
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 22, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 22, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_LinkKeySet, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 23, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 23, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_LinkKeySet, osal_memset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 19, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 19, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_LinkKeySet, osal_mem_free
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 19, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 19, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0xf
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 15)
        ; Saved register size: 15
        ; Auto size: 4
        MOV     A,#-0x4
        LCALL   ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 19)
        MOV     A,R4
        MOV     R6,A
        MOV     A,R5
        MOV     R7,A
// 2064   ZStatus_t status;
// 2065   ZDSecMgrEntry_t* entry;
// 2066   APSME_LinkKeyData_t *pApsLinkKey = NULL;
// 2067   uint16 Index;
// 2068 
// 2069   // lookup entry index for specified EXT address
// 2070   status = ZDSecMgrEntryLookupExtGetIndex( extAddr, &entry, &Index );
        ; Setup parameters for call to function ZDSecMgrEntryLookupExtGetIndex
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        MOV     ?V0 + 0,DPL
        MOV     ?V0 + 1,DPH
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 21)
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        MOV     R4,DPL
        MOV     R5,DPH
        LCALL   ??ZDSecMgrEntryLookupExtGetIndex?relay
        MOV     A,#0x2
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 19)
        MOV     A,R1
        MOV     ?V0 + 0,A
// 2071 
// 2072   if ( status == ZSuccess )
        JZ      $+5
        LJMP    ??CrossCallReturnLabel_149 & 0xFFFF
// 2073   {
// 2074     // point to NV item
// 2075     entry->keyNvId = ZCD_NV_APS_LINK_KEY_DATA_START + Index;
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        MOVX    A,@DPTR
        ADD     A,#0x1
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        ADDC    A,#0x2
        MOV     R1,A
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        LCALL   ?Subroutine48 & 0xFFFF
??CrossCallReturnLabel_59:
        INC     DPTR
        INC     DPTR
        LCALL   ??Subroutine63_0 & 0xFFFF
// 2076 
// 2077     pApsLinkKey = (APSME_LinkKeyData_t *)osal_mem_alloc(sizeof(APSME_LinkKeyData_t));
??CrossCallReturnLabel_134:
        ; Setup parameters for call to function osal_mem_alloc
        MOV     R2,#0x18
        MOV     R3,#0x0
        LCALL   ??osal_mem_alloc?relay
        MOV     ?V0 + 2,R2
        MOV     ?V0 + 3,R3
// 2078 
// 2079     if (pApsLinkKey != NULL)
        MOV     A,R2
        ORL     A,?V0 + 3
        JNZ     $+5
        LJMP    ??CrossCallReturnLabel_149 & 0xFFFF
// 2080     {
// 2081       // read the key form NV, keyNvId must be ZCD_NV_APS_LINK_KEY_DATA_START based
// 2082       osal_nv_read( entry->keyNvId, 0,
// 2083                    sizeof(APSME_LinkKeyData_t), pApsLinkKey );
        ; Setup parameters for call to function osal_nv_read
        MOV     R0,#?V0 + 2
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 21)
        MOV     ?V0 + 4,#0x18
        MOV     ?V0 + 5,#0x0
        MOV     R0,#?V0 + 4
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 23)
        MOV     R4,#0x0
        MOV     R5,#0x0
        MOV     A,#0x4
        LCALL   ?XSTACK_DISP0_8
        LCALL   ?Subroutine22 & 0xFFFF
??CrossCallReturnLabel_108:
        LCALL   ??osal_nv_read?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 19)
// 2084 
// 2085       // set new values of the key
// 2086       osal_memcpy( pApsLinkKey->key, key, SEC_KEY_LEN );
        ; Setup parameters for call to function osal_memcpy
        MOV     ?V0 + 4,R6
        MOV     ?V0 + 5,R7
        MOV     ?V0 + 6,#0x0
        MOV     R0,#?V0 + 4
        LCALL   ?PUSH_XSTACK_I_THREE
          CFI CFA_XSP16 add(XSP16, 22)
        MOV     R4,#0x10
        MOV     R5,#0x0
        MOV     R2,?V0 + 2
        MOV     R3,?V0 + 3
        LCALL   ??osal_memcpy?relay
        MOV     A,#0x3
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 19)
// 2087       pApsLinkKey->rxFrmCntr = 0;
        MOV     A,?V0 + 2
        ADD     A,#0x14
        LCALL   ?Subroutine13 & 0xFFFF
// 2088       pApsLinkKey->txFrmCntr = 0;
??CrossCallReturnLabel_150:
        MOV     A,?V0 + 2
        ADD     A,#0x10
        LCALL   ?Subroutine13 & 0xFFFF
// 2089 
// 2090       osal_nv_write( entry->keyNvId, 0,
// 2091                     sizeof(APSME_LinkKeyData_t), pApsLinkKey );
??CrossCallReturnLabel_151:
        ; Setup parameters for call to function osal_nv_write
        MOV     R0,#?V0 + 2
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 21)
        MOV     ?V0 + 4,#0x18
        MOV     ?V0 + 5,#0x0
        MOV     R0,#?V0 + 4
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 23)
        MOV     R4,#0x0
        MOV     R5,#0x0
        MOV     A,#0x4
        LCALL   ?XSTACK_DISP0_8
        LCALL   ?Subroutine22 & 0xFFFF
??CrossCallReturnLabel_109:
        LCALL   ??osal_nv_write?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 19)
// 2092 
// 2093       // clear copy of key in RAM
// 2094       osal_memset(pApsLinkKey, 0x00, sizeof(APSME_LinkKeyData_t));
        ; Setup parameters for call to function osal_memset
        MOV     R4,#0x18
        MOV     R5,#0x0
        MOV     R1,#0x0
        MOV     R2,?V0 + 2
        MOV     R3,?V0 + 3
        LCALL   ??osal_memset?relay
// 2095 
// 2096       osal_mem_free(pApsLinkKey);
        ; Setup parameters for call to function osal_mem_free
        MOV     R2,?V0 + 2
        MOV     R3,?V0 + 3
        LCALL   ??osal_mem_free?relay
        LCALL   ?Subroutine47 & 0xFFFF
??CrossCallReturnLabel_57:
        LCALL   ?Subroutine29 & 0xFFFF
??CrossCallReturnLabel_26:
        MOV     B,#0x9
        MUL     AB
        MOV     R0,A
        MOV     R2,B
        MOV     B,#0x9
        MOV     A,R1
        MUL     AB
        ADD     A,R2
        MOV     R1,A
        MOV     A,#ApsLinkKeyFrmCntr & 0xff
        ADD     A,R0
        MOV     R2,A
        MOV     A,#(ApsLinkKeyFrmCntr >> 8) & 0xff
        ADDC    A,R1
        MOV     R3,A
        MOV     A,R2
        ADD     A,#-0x9
        MOV     DPL,A
        MOV     A,R3
        ADDC    A,#-0x13
        LCALL   ??Subroutine65_0 & 0xFFFF
// 2097 
// 2098       // set initial values for counters in RAM
// 2099       ApsLinkKeyFrmCntr[entry->keyNvId - ZCD_NV_APS_LINK_KEY_DATA_START].txFrmCntr = 0;
// 2100       ApsLinkKeyFrmCntr[entry->keyNvId - ZCD_NV_APS_LINK_KEY_DATA_START].rxFrmCntr = 0;
??CrossCallReturnLabel_148:
        MOV     A,R2
        ADD     A,#-0x5
        MOV     DPL,A
        MOV     A,R3
        ADDC    A,#-0x13
        LCALL   ??Subroutine65_0 & 0xFFFF
// 2101     }
// 2102   }
// 2103 
// 2104   return status;
??CrossCallReturnLabel_149:
        MOV     R1,?V0 + 0
        MOV     A,#0x4
          CFI EndBlock cfiBlock232
        REQUIRE ?Subroutine5
        ; // Fall through to label ?Subroutine5
// 2105 }

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine5:
          CFI Block cfiBlock233 Using cfiCommon0
          CFI NoFunction
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 19)
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI Invalid
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 15)
          CFI Valid
        MOV     R7,#0x7
        LJMP    ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock233

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine48:
          CFI Block cfiCond234 Using cfiCommon0
          CFI Function ZDSecMgrTransportKeyInd
          CFI Conditional ??CrossCallReturnLabel_60, ??CrossCallReturnLabel_136
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 34)
          CFI Block cfiCond235 Using cfiCommon0
          CFI (cfiCond235) Function ZDSecMgrAddLinkKey
          CFI (cfiCond235) Conditional ??CrossCallReturnLabel_60, ??CrossCallReturnLabel_137
          CFI (cfiCond235) R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond235) VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond235) V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond235) V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond235) V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond235) V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond235) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond235) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond235) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond235) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond235) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond235) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond235) CFA_SP SP+0
          CFI (cfiCond235) CFA_XSP16 add(XSP16, 16)
          CFI Block cfiCond236 Using cfiCommon0
          CFI (cfiCond236) Function APSME_LinkKeySet
          CFI (cfiCond236) Conditional ??CrossCallReturnLabel_59
          CFI (cfiCond236) R6 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond236) VB load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond236) V0 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond236) V1 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond236) V2 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond236) V3 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond236) V4 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond236) V5 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond236) V6 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond236) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond236) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond236) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond236) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond236) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond236) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond236) CFA_SP SP+0
          CFI (cfiCond236) CFA_XSP16 add(XSP16, 19)
          CFI Block cfiPicker237 Using cfiCommon1
          CFI (cfiPicker237) NoFunction
          CFI (cfiPicker237) Picker
        MOVX    A,@DPTR
        MOV     R2,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPH,A
        MOV     DPL,R2
        RET
          CFI EndBlock cfiCond234
          CFI EndBlock cfiCond235
          CFI EndBlock cfiCond236
          CFI EndBlock cfiPicker237

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine29:
          CFI Block cfiCond238 Using cfiCommon0
          CFI Function ZDSecMgrAppKeyGet
          CFI Conditional ??CrossCallReturnLabel_24
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
          CFI Block cfiCond239 Using cfiCommon0
          CFI (cfiCond239) Function ZDSecMgrAppKeyGet
          CFI (cfiCond239) Conditional ??CrossCallReturnLabel_25
          CFI (cfiCond239) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond239) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond239) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond239) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond239) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond239) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond239) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond239) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond239) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond239) CFA_SP SP+0
          CFI (cfiCond239) CFA_XSP16 add(XSP16, 9)
          CFI Block cfiCond240 Using cfiCommon0
          CFI (cfiCond240) Function APSME_LinkKeySet
          CFI (cfiCond240) Conditional ??CrossCallReturnLabel_26
          CFI (cfiCond240) R6 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond240) VB load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond240) V0 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond240) V1 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond240) V2 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond240) V3 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond240) V4 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond240) V5 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond240) V6 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond240) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond240) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond240) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond240) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond240) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond240) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond240) CFA_SP SP+0
          CFI (cfiCond240) CFA_XSP16 add(XSP16, 19)
          CFI Block cfiPicker241 Using cfiCommon1
          CFI (cfiPicker241) NoFunction
          CFI (cfiPicker241) Picker
        LCALL   ?Subroutine44 & 0xFFFF
??CrossCallReturnLabel_164:
        RET
          CFI EndBlock cfiCond238
          CFI EndBlock cfiCond239
          CFI EndBlock cfiCond240
          CFI EndBlock cfiPicker241

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine44:
          CFI Block cfiCond242 Using cfiCommon0
          CFI Function ZDSecMgrAddrStore
          CFI Conditional ??CrossCallReturnLabel_163, ??CrossCallReturnLabel_14
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 22)
          CFI Block cfiCond243 Using cfiCommon0
          CFI (cfiCond243) Function ZDSecMgrExtAddrStore
          CFI (cfiCond243) Conditional ??CrossCallReturnLabel_163, ??CrossCallReturnLabel_15
          CFI (cfiCond243) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond243) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond243) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond243) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond243) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond243) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond243) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond243) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond243) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond243) CFA_SP SP+0
          CFI (cfiCond243) CFA_XSP16 add(XSP16, 22)
          CFI Block cfiCond244 Using cfiCommon0
          CFI (cfiCond244) Function ZDSecMgrEntryLookup
          CFI (cfiCond244) Conditional ??CrossCallReturnLabel_165, ??CrossCallReturnLabel_77
          CFI (cfiCond244) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond244) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond244) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond244) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond244) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond244) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond244) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond244) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond244) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond244) CFA_SP SP+0
          CFI (cfiCond244) CFA_XSP16 add(XSP16, 22)
          CFI Block cfiCond245 Using cfiCommon0
          CFI (cfiCond245) Function ZDSecMgrEntryLookupAMI
          CFI (cfiCond245) Conditional ??CrossCallReturnLabel_165, ??CrossCallReturnLabel_78
          CFI (cfiCond245) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond245) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond245) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond245) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond245) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond245) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond245) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond245) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond245) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond245) CFA_SP SP+0
          CFI (cfiCond245) CFA_XSP16 add(XSP16, 9)
          CFI Block cfiCond246 Using cfiCommon0
          CFI (cfiCond246) Function ZDSecMgrEntryNew
          CFI (cfiCond246) Conditional ??CrossCallReturnLabel_165, ??CrossCallReturnLabel_79
          CFI (cfiCond246) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond246) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond246) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond246) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond246) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond246) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond246) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond246) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond246) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond246) CFA_SP SP+0
          CFI (cfiCond246) CFA_XSP16 add(XSP16, 9)
          CFI Block cfiCond247 Using cfiCommon0
          CFI (cfiCond247) Function ZDSecMgrWriteNV
          CFI (cfiCond247) Conditional ??CrossCallReturnLabel_165, ??CrossCallReturnLabel_80
          CFI (cfiCond247) R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond247) VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond247) V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond247) V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond247) V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond247) V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond247) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond247) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond247) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond247) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond247) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond247) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond247) CFA_SP SP+0
          CFI (cfiCond247) CFA_XSP16 add(XSP16, 14)
          CFI Block cfiCond248 Using cfiCommon0
          CFI (cfiCond248) Function ZDSecMgrEntryInit
          CFI (cfiCond248) Conditional ??CrossCallReturnLabel_165, ??CrossCallReturnLabel_81
          CFI (cfiCond248) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond248) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond248) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond248) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond248) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond248) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond248) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond248) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond248) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond248) CFA_SP SP+0
          CFI (cfiCond248) CFA_XSP16 add(XSP16, 9)
          CFI Block cfiCond249 Using cfiCommon0
          CFI (cfiCond249) Function ZDSecMgrAppKeyGet
          CFI (cfiCond249) Conditional ??CrossCallReturnLabel_164, ??CrossCallReturnLabel_24
          CFI (cfiCond249) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond249) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond249) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond249) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond249) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond249) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond249) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond249) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond249) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond249) CFA_SP SP+0
          CFI (cfiCond249) CFA_XSP16 add(XSP16, 9)
          CFI Block cfiCond250 Using cfiCommon0
          CFI (cfiCond250) Function ZDSecMgrAppKeyGet
          CFI (cfiCond250) Conditional ??CrossCallReturnLabel_164, ??CrossCallReturnLabel_25
          CFI (cfiCond250) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond250) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond250) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond250) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond250) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond250) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond250) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond250) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond250) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond250) CFA_SP SP+0
          CFI (cfiCond250) CFA_XSP16 add(XSP16, 9)
          CFI Block cfiCond251 Using cfiCommon0
          CFI (cfiCond251) Function APSME_LinkKeySet
          CFI (cfiCond251) Conditional ??CrossCallReturnLabel_164, ??CrossCallReturnLabel_26
          CFI (cfiCond251) R6 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond251) VB load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond251) V0 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond251) V1 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond251) V2 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond251) V3 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond251) V4 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond251) V5 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond251) V6 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond251) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond251) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond251) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond251) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond251) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond251) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond251) CFA_SP SP+0
          CFI (cfiCond251) CFA_XSP16 add(XSP16, 19)
          CFI Block cfiCond252 Using cfiCommon0
          CFI (cfiCond252) Function ZDSecMgrTransportKeyInd
          CFI (cfiCond252) Conditional ??CrossCallReturnLabel_166, ??CrossCallReturnLabel_159
          CFI (cfiCond252) R6 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond252) VB load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond252) V0 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond252) V1 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond252) V2 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond252) V3 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond252) V4 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond252) V5 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond252) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond252) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond252) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond252) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond252) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond252) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond252) CFA_SP SP+0
          CFI (cfiCond252) CFA_XSP16 add(XSP16, 34)
          CFI Block cfiCond253 Using cfiCommon0
          CFI (cfiCond253) Function APSME_IsLinkKeyValid
          CFI (cfiCond253) Conditional ??CrossCallReturnLabel_166, ??CrossCallReturnLabel_160
          CFI (cfiCond253) R6 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond253) VB load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond253) V0 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond253) V1 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond253) V2 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond253) V3 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond253) V4 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond253) V5 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond253) V6 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond253) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond253) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond253) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond253) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond253) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond253) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond253) CFA_SP SP+0
          CFI (cfiCond253) CFA_XSP16 add(XSP16, 33)
          CFI Block cfiCond254 Using cfiCommon0
          CFI (cfiCond254) Function ZDSecMgrAddLinkKey
          CFI (cfiCond254) Conditional ??CrossCallReturnLabel_166, ??CrossCallReturnLabel_161
          CFI (cfiCond254) R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond254) VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond254) V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond254) V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond254) V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond254) V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond254) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond254) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond254) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond254) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond254) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond254) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond254) CFA_SP SP+0
          CFI (cfiCond254) CFA_XSP16 add(XSP16, 16)
          CFI Block cfiCond255 Using cfiCommon0
          CFI (cfiCond255) Function ZDSecMgrRestoreFromNV
          CFI (cfiCond255) Conditional ??CrossCallReturnLabel_166, ??CrossCallReturnLabel_162
          CFI (cfiCond255) R6 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI (cfiCond255) VB load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI (cfiCond255) V0 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI (cfiCond255) V1 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond255) V2 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond255) V3 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond255) V4 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond255) V5 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond255) V6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond255) V7 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond255) V8 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond255) V9 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond255) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond255) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond255) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond255) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond255) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond255) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond255) CFA_SP SP+0
          CFI (cfiCond255) CFA_XSP16 add(XSP16, 20)
          CFI Block cfiCond256 Using cfiCommon0
          CFI (cfiCond256) Function ZDSecMgrEntryInit
          CFI (cfiCond256) Conditional ??CrossCallReturnLabel_166, ??CrossCallReturnLabel_152
          CFI (cfiCond256) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond256) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond256) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond256) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond256) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond256) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond256) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond256) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond256) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond256) CFA_SP SP+0
          CFI (cfiCond256) CFA_XSP16 add(XSP16, 9)
          CFI Block cfiCond257 Using cfiCommon0
          CFI (cfiCond257) Function ZDSecMgrEntryLookupExtGetIndex
          CFI (cfiCond257) Conditional ??CrossCallReturnLabel_166, ??CrossCallReturnLabel_153
          CFI (cfiCond257) R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond257) VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond257) V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond257) V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond257) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond257) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond257) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond257) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond257) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond257) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond257) CFA_SP SP+0
          CFI (cfiCond257) CFA_XSP16 add(XSP16, 12)
          CFI Block cfiCond258 Using cfiCommon0
          CFI (cfiCond258) Function ZDSecMgrEntryLookupAMIGetIndex
          CFI (cfiCond258) Conditional ??CrossCallReturnLabel_166, ??CrossCallReturnLabel_154
          CFI (cfiCond258) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond258) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond258) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond258) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond258) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond258) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond258) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond258) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond258) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond258) CFA_SP SP+0
          CFI (cfiCond258) CFA_XSP16 add(XSP16, 9)
          CFI Block cfiCond259 Using cfiCommon0
          CFI (cfiCond259) Function ZDSecMgrEntryFree
          CFI (cfiCond259) Conditional ??CrossCallReturnLabel_166, ??CrossCallReturnLabel_155
          CFI (cfiCond259) R6 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI (cfiCond259) VB load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond259) V0 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond259) V1 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond259) V2 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond259) V3 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond259) V4 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond259) V5 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond259) V6 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond259) V7 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond259) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond259) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond259) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond259) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond259) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond259) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond259) CFA_SP SP+0
          CFI (cfiCond259) CFA_XSP16 add(XSP16, 20)
          CFI Block cfiCond260 Using cfiCommon0
          CFI (cfiCond260) Function ZDSecMgrEntryFree
          CFI (cfiCond260) Conditional ??CrossCallReturnLabel_166, ??CrossCallReturnLabel_156
          CFI (cfiCond260) R6 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI (cfiCond260) VB load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond260) V0 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond260) V1 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond260) V2 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond260) V3 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond260) V4 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond260) V5 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond260) V6 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond260) V7 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond260) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond260) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond260) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond260) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond260) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond260) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond260) CFA_SP SP+0
          CFI (cfiCond260) CFA_XSP16 add(XSP16, 20)
          CFI Block cfiCond261 Using cfiCommon0
          CFI (cfiCond261) Function ZDSecMgrRemoveDeviceInd
          CFI (cfiCond261) Conditional ??CrossCallReturnLabel_166, ??CrossCallReturnLabel_157
          CFI (cfiCond261) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond261) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond261) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond261) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond261) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond261) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond261) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond261) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond261) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond261) CFA_SP SP+0
          CFI (cfiCond261) CFA_XSP16 add(XSP16, 17)
          CFI Block cfiCond262 Using cfiCommon0
          CFI (cfiCond262) Function APSME_KeyFwdToChild
          CFI (cfiCond262) Conditional ??CrossCallReturnLabel_166, ??CrossCallReturnLabel_158
          CFI (cfiCond262) DPL0 Frame(CFA_SP, 4)
          CFI (cfiCond262) DPH0 Frame(CFA_SP, 5)
          CFI (cfiCond262) CFA_SP SP+-5
          CFI Block cfiPicker263 Using cfiCommon1
          CFI (cfiPicker263) NoFunction
          CFI (cfiPicker263) Picker
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R1,A
        MOV     A,R0
        RET
          CFI EndBlock cfiCond242
          CFI EndBlock cfiCond243
          CFI EndBlock cfiCond244
          CFI EndBlock cfiCond245
          CFI EndBlock cfiCond246
          CFI EndBlock cfiCond247
          CFI EndBlock cfiCond248
          CFI EndBlock cfiCond249
          CFI EndBlock cfiCond250
          CFI EndBlock cfiCond251
          CFI EndBlock cfiCond252
          CFI EndBlock cfiCond253
          CFI EndBlock cfiCond254
          CFI EndBlock cfiCond255
          CFI EndBlock cfiCond256
          CFI EndBlock cfiCond257
          CFI EndBlock cfiCond258
          CFI EndBlock cfiCond259
          CFI EndBlock cfiCond260
          CFI EndBlock cfiCond261
          CFI EndBlock cfiCond262
          CFI EndBlock cfiPicker263

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine13:
          CFI Block cfiCond264 Using cfiCommon0
          CFI Function APSME_LinkKeySet
          CFI Conditional ??CrossCallReturnLabel_150
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 19)
          CFI Block cfiCond265 Using cfiCommon0
          CFI (cfiCond265) Function APSME_LinkKeySet
          CFI (cfiCond265) Conditional ??CrossCallReturnLabel_151
          CFI (cfiCond265) R6 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond265) VB load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond265) V0 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond265) V1 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond265) V2 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond265) V3 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond265) V4 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond265) V5 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond265) V6 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond265) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond265) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond265) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond265) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond265) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond265) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond265) CFA_SP SP+0
          CFI (cfiCond265) CFA_XSP16 add(XSP16, 19)
          CFI Block cfiPicker266 Using cfiCommon1
          CFI (cfiPicker266) NoFunction
          CFI (cfiPicker266) Picker
        MOV     DPL,A
        MOV     A,?V0 + 3
        ADDC    A,#0x0
          CFI EndBlock cfiCond264
          CFI EndBlock cfiCond265
          CFI EndBlock cfiPicker266
        REQUIRE ??Subroutine65_0
        ; // Fall through to label ??Subroutine65_0

        RSEG BANKED_CODE:CODE:NOROOT(0)
??Subroutine65_0:
          CFI Block cfiCond267 Using cfiCommon0
          CFI Function APSME_LinkKeySet
          CFI Conditional ??CrossCallReturnLabel_148
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 19)
          CFI Block cfiCond268 Using cfiCommon0
          CFI (cfiCond268) Function APSME_LinkKeySet
          CFI (cfiCond268) Conditional ??CrossCallReturnLabel_149
          CFI (cfiCond268) R6 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond268) VB load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond268) V0 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond268) V1 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond268) V2 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond268) V3 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond268) V4 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond268) V5 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond268) V6 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond268) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond268) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond268) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond268) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond268) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond268) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond268) CFA_SP SP+0
          CFI (cfiCond268) CFA_XSP16 add(XSP16, 19)
          CFI Block cfiCond269 Using cfiCommon0
          CFI (cfiCond269) Function APSME_LinkKeySet
          CFI (cfiCond269) Conditional ??CrossCallReturnLabel_150
          CFI (cfiCond269) R6 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond269) VB load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond269) V0 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond269) V1 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond269) V2 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond269) V3 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond269) V4 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond269) V5 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond269) V6 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond269) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond269) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond269) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond269) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond269) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond269) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond269) CFA_SP SP+0
          CFI (cfiCond269) CFA_XSP16 add(XSP16, 19)
          CFI Block cfiCond270 Using cfiCommon0
          CFI (cfiCond270) Function APSME_LinkKeySet
          CFI (cfiCond270) Conditional ??CrossCallReturnLabel_151
          CFI (cfiCond270) R6 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond270) VB load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond270) V0 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond270) V1 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond270) V2 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond270) V3 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond270) V4 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond270) V5 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond270) V6 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond270) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond270) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond270) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond270) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond270) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond270) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond270) CFA_SP SP+0
          CFI (cfiCond270) CFA_XSP16 add(XSP16, 19)
          CFI Block cfiPicker271 Using cfiCommon1
          CFI (cfiPicker271) NoFunction
          CFI (cfiPicker271) Picker
        MOV     DPH,A
          CFI EndBlock cfiCond267
          CFI EndBlock cfiCond268
          CFI EndBlock cfiCond269
          CFI EndBlock cfiCond270
          CFI EndBlock cfiPicker271
        REQUIRE ??Subroutine66_0
        ; // Fall through to label ??Subroutine66_0

        RSEG BANKED_CODE:CODE:NOROOT(0)
??Subroutine66_0:
          CFI Block cfiCond272 Using cfiCommon0
          CFI Function APSME_TCLinkKeyInit
          CFI Conditional ??CrossCallReturnLabel_147
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V7 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 48)
          CFI Block cfiCond273 Using cfiCommon0
          CFI (cfiCond273) Function APSME_LinkKeySet
          CFI (cfiCond273) Conditional ??CrossCallReturnLabel_148
          CFI (cfiCond273) R6 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond273) VB load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond273) V0 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond273) V1 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond273) V2 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond273) V3 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond273) V4 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond273) V5 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond273) V6 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond273) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond273) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond273) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond273) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond273) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond273) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond273) CFA_SP SP+0
          CFI (cfiCond273) CFA_XSP16 add(XSP16, 19)
          CFI Block cfiCond274 Using cfiCommon0
          CFI (cfiCond274) Function APSME_LinkKeySet
          CFI (cfiCond274) Conditional ??CrossCallReturnLabel_149
          CFI (cfiCond274) R6 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond274) VB load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond274) V0 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond274) V1 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond274) V2 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond274) V3 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond274) V4 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond274) V5 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond274) V6 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond274) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond274) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond274) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond274) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond274) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond274) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond274) CFA_SP SP+0
          CFI (cfiCond274) CFA_XSP16 add(XSP16, 19)
          CFI Block cfiCond275 Using cfiCommon0
          CFI (cfiCond275) Function APSME_LinkKeySet
          CFI (cfiCond275) Conditional ??CrossCallReturnLabel_150
          CFI (cfiCond275) R6 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond275) VB load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond275) V0 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond275) V1 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond275) V2 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond275) V3 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond275) V4 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond275) V5 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond275) V6 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond275) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond275) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond275) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond275) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond275) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond275) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond275) CFA_SP SP+0
          CFI (cfiCond275) CFA_XSP16 add(XSP16, 19)
          CFI Block cfiCond276 Using cfiCommon0
          CFI (cfiCond276) Function APSME_LinkKeySet
          CFI (cfiCond276) Conditional ??CrossCallReturnLabel_151
          CFI (cfiCond276) R6 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond276) VB load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond276) V0 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond276) V1 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond276) V2 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond276) V3 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond276) V4 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond276) V5 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond276) V6 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond276) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond276) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond276) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond276) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond276) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond276) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond276) CFA_SP SP+0
          CFI (cfiCond276) CFA_XSP16 add(XSP16, 19)
          CFI Block cfiPicker277 Using cfiCommon1
          CFI (cfiPicker277) NoFunction
          CFI (cfiPicker277) Picker
        CLR     A
        MOVX    @DPTR,A
        INC     DPTR
        MOVX    @DPTR,A
        INC     DPTR
        MOVX    @DPTR,A
        INC     DPTR
        MOVX    @DPTR,A
        RET
          CFI EndBlock cfiCond272
          CFI EndBlock cfiCond273
          CFI EndBlock cfiCond274
          CFI EndBlock cfiCond275
          CFI EndBlock cfiCond276
          CFI EndBlock cfiPicker277
// 2106 
// 2107 /******************************************************************************
// 2108  * @fn          ZDSecMgrAuthenticationSet
// 2109  *
// 2110  * @brief       Mark the specific device as authenticated or not
// 2111  *
// 2112  * @param       extAddr - [in] EXT address
// 2113  * @param       option  - [in] authenticated or not
// 2114  *
// 2115  * @return      ZStatus_t
// 2116  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 2117 ZStatus_t ZDSecMgrAuthenticationSet( uint8* extAddr, ZDSecMgr_Authentication_Option option )
ZDSecMgrAuthenticationSet:
          CFI Block cfiBlock278 Using cfiCommon0
          CFI Function ZDSecMgrAuthenticationSet
        CODE
// 2118 {
        FUNCALL ZDSecMgrAuthenticationSet, ZDSecMgrEntryLookupExt
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 11, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 11, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x9
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 2
        MOV     A,#-0x2
        LCALL   ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 11)
        MOV     A,R1
        MOV     R6,A
// 2119   ZStatus_t        status;
// 2120   ZDSecMgrEntry_t* entry;
// 2121 
// 2122 
// 2123   // lookup entry index for specified EXT address
// 2124   status = ZDSecMgrEntryLookupExt( extAddr, &entry );
        ; Setup parameters for call to function ZDSecMgrEntryLookupExt
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     R4,DPL
        MOV     R5,DPH
        LCALL   ??ZDSecMgrEntryLookupExt?relay
        MOV     A,R1
// 2125 
// 2126   if ( status == ZSuccess )
        JNZ     ??ZDSecMgrAuthenticationSet_0
// 2127   {
// 2128     entry->authenticateOption = option;
        LCALL   ?Subroutine25 & 0xFFFF
// 2129   }
??CrossCallReturnLabel_16:
        MOV     A,R6
        MOVX    @DPTR,A
          CFI EndBlock cfiBlock278
// 2130 
// 2131   return status;
??ZDSecMgrAuthenticationSet_0:
        REQUIRE ?Subroutine7
        ; // Fall through to label ?Subroutine7
// 2132 }

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine7:
          CFI Block cfiBlock279 Using cfiCommon0
          CFI NoFunction
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 11)
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        MOV     A,#0x2
        LJMP    ??Subroutine67_0 & 0xFFFF
          CFI EndBlock cfiBlock279
// 2133 
// 2134 /******************************************************************************
// 2135  * @fn          ZDSecMgrAuthenticationCheck
// 2136  *
// 2137  * @brief       Check if the specific device has been authenticated or not
// 2138  *              For non-trust center device, always return TRUE
// 2139  *
// 2140  * @param       shortAddr - [in] short address
// 2141  *
// 2142  * @return      TRUE @ authenticated with CBKE
// 2143  *              FALSE @ not authenticated
// 2144  */
// 2145 

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 2146 uint8 ZDSecMgrAuthenticationCheck( uint16 shortAddr )
ZDSecMgrAuthenticationCheck:
          CFI Block cfiBlock280 Using cfiCommon0
          CFI Function ZDSecMgrAuthenticationCheck
        CODE
// 2147 {
        FUNCALL ZDSecMgrAuthenticationCheck, APSME_GetRequest
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 21, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 21, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrAuthenticationCheck, NLME_GetExtAddr
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 21, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 21, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrAuthenticationCheck, sAddrExtCmp
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 21, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 21, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrAuthenticationCheck, AddrMgrExtAddrLookup
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 21, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 21, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrAuthenticationCheck, ZDSecMgrEntryLookupExt
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 21, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 21, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrAuthenticationCheck, ZDSecMgrExtAddrLookup
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 21, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 21, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x9
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 12
        MOV     A,#-0xc
        LCALL   ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 21)
        MOV     A,R2
        MOV     R6,A
        MOV     A,R3
        MOV     R7,A
// 2148 #if defined (TC_LINKKEY_JOIN)
// 2149 
// 2150   ZDSecMgrEntry_t* entry;
// 2151   uint8 extAddr[Z_EXTADDR_LEN];
// 2152 
// 2153   // If the local device is not the trust center, always return TRUE
// 2154   APSME_GetRequest( apsTrustCenterAddress, 0, extAddr );
        ; Setup parameters for call to function APSME_GetRequest
        MOV     A,#0x4
        LCALL   ?XSTACK_DISP0_8
        MOV     R4,DPL
        MOV     R5,DPH
        MOV     R2,#0x0
        MOV     R3,#0x0
        MOV     R1,#-0x55
        LCALL   ??APSME_GetRequest?relay
// 2155   if ( ! osal_ExtAddrEqual( extAddr , NLME_GetExtAddr() ) )
        ; Setup parameters for call to function sAddrExtCmp
        ; Setup parameters for call to function NLME_GetExtAddr
        LCALL   ??NLME_GetExtAddr?relay
        MOV     A,R2
        MOV     R4,A
        MOV     A,R3
        MOV     R5,A
        MOV     A,#0x4
        LCALL   ?XSTACK_DISP0_8
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??sAddrExtCmp?relay
        MOV     A,R1
        JZ      ??ZDSecMgrAuthenticationCheck_0
// 2156   {
// 2157     return TRUE;
// 2158   }
// 2159   // Otherwise, check the authentication option
// 2160   else if ( AddrMgrExtAddrLookup( shortAddr, extAddr ) )
        ; Setup parameters for call to function AddrMgrExtAddrLookup
        MOV     A,#0x4
        LCALL   ?XSTACK_DISP0_8
        MOV     R4,DPL
        MOV     R5,DPH
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        LCALL   ??AddrMgrExtAddrLookup?relay
        MOV     A,R1
        JZ      ??ZDSecMgrAuthenticationCheck_1
// 2161   {
// 2162     // lookup entry index for specified EXT address
// 2163     if ( ZDSecMgrEntryLookupExt( extAddr, &entry ) == ZSuccess )
        ; Setup parameters for call to function ZDSecMgrEntryLookupExt
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     R4,DPL
        MOV     R5,DPH
        MOV     A,#0x4
        LCALL   ?XSTACK_DISP0_8
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??ZDSecMgrEntryLookupExt?relay
        MOV     A,R1
        JNZ     ??ZDSecMgrAuthenticationCheck_2
// 2164     {
// 2165       if ( entry->authenticateOption != ZDSecMgr_Not_Authenticated )
        LCALL   ?Subroutine25 & 0xFFFF
// 2166       {
// 2167         return TRUE;
// 2168       }
// 2169       else
// 2170       {
// 2171         return FALSE;
// 2172       }
// 2173     }
??CrossCallReturnLabel_17:
        MOVX    A,@DPTR
        JNZ     ??ZDSecMgrAuthenticationCheck_0
// 2174     else
// 2175     {
// 2176       // it may have been secured with TCLK only
// 2177       uint16    ami;
// 2178 
// 2179       // lookup address index in address manager
// 2180       if ( ZDSecMgrExtAddrLookup( extAddr, &ami ) == ZSuccess )
// 2181       {
// 2182         return TRUE;
// 2183       }
// 2184     }
// 2185   }
// 2186   return FALSE;
??ZDSecMgrAuthenticationCheck_1:
        MOV     R1,#0x0
??ZDSecMgrAuthenticationCheck_3:
        MOV     A,#0xc
        SJMP    ??Subroutine67_0
??ZDSecMgrAuthenticationCheck_2:
        ; Setup parameters for call to function ZDSecMgrExtAddrLookup
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        MOV     R4,DPL
        MOV     R5,DPH
        MOV     A,#0x4
        LCALL   ?XSTACK_DISP0_8
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??ZDSecMgrExtAddrLookup?relay
        MOV     A,R1
        JNZ     ??ZDSecMgrAuthenticationCheck_1
??ZDSecMgrAuthenticationCheck_0:
        MOV     R1,#0x1
        SJMP    ??ZDSecMgrAuthenticationCheck_3
          CFI EndBlock cfiBlock280
// 2187 
// 2188 #else
// 2189   (void)shortAddr;  // Intentionally unreferenced parameter
// 2190 
// 2191   // For non AMI/SE Profile, perform no check and always return TRUE.
// 2192   return TRUE;
// 2193 
// 2194 #endif // TC_LINKKEY_JOIN
// 2195 }

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine25:
          CFI Block cfiCond281 Using cfiCommon0
          CFI Function ZDSecMgrAuthenticationSet
          CFI Conditional ??CrossCallReturnLabel_16
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 11)
          CFI Block cfiCond282 Using cfiCommon0
          CFI (cfiCond282) Function ZDSecMgrAuthenticationCheck
          CFI (cfiCond282) Conditional ??CrossCallReturnLabel_17
          CFI (cfiCond282) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond282) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond282) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond282) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond282) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond282) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond282) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond282) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond282) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond282) CFA_SP SP+0
          CFI (cfiCond282) CFA_XSP16 add(XSP16, 21)
          CFI Block cfiPicker283 Using cfiCommon1
          CFI (cfiPicker283) NoFunction
          CFI (cfiPicker283) Picker
        LCALL   ?Subroutine47 & 0xFFFF
??CrossCallReturnLabel_58:
        INC     DPTR
        INC     DPTR
        RET
          CFI EndBlock cfiCond281
          CFI EndBlock cfiCond282
          CFI EndBlock cfiPicker283

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine47:
          CFI Block cfiCond284 Using cfiCommon0
          CFI Function APSME_LinkKeySet
          CFI Conditional ??CrossCallReturnLabel_57
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 19)
          CFI Block cfiCond285 Using cfiCommon0
          CFI (cfiCond285) Function ZDSecMgrAuthenticationSet
          CFI (cfiCond285) Conditional ??CrossCallReturnLabel_58, ??CrossCallReturnLabel_16
          CFI (cfiCond285) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond285) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond285) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond285) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond285) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond285) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond285) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond285) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond285) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond285) CFA_SP SP+0
          CFI (cfiCond285) CFA_XSP16 add(XSP16, 11)
          CFI Block cfiCond286 Using cfiCommon0
          CFI (cfiCond286) Function ZDSecMgrAuthenticationCheck
          CFI (cfiCond286) Conditional ??CrossCallReturnLabel_58, ??CrossCallReturnLabel_17
          CFI (cfiCond286) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond286) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond286) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond286) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond286) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond286) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond286) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond286) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond286) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond286) CFA_SP SP+0
          CFI (cfiCond286) CFA_XSP16 add(XSP16, 21)
          CFI Block cfiPicker287 Using cfiCommon1
          CFI (cfiPicker287) NoFunction
          CFI (cfiPicker287) Picker
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        LCALL   ?Subroutine52 & 0xFFFF
??CrossCallReturnLabel_69:
        INC     DPTR
        INC     DPTR
        RET
          CFI EndBlock cfiCond284
          CFI EndBlock cfiCond285
          CFI EndBlock cfiCond286
          CFI EndBlock cfiPicker287

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine52:
          CFI Block cfiCond288 Using cfiCommon0
          CFI Function APSME_LinkKeySet
          CFI Conditional ??CrossCallReturnLabel_68, ??CrossCallReturnLabel_108
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 23)
          CFI Block cfiCond289 Using cfiCommon0
          CFI (cfiCond289) Function APSME_LinkKeySet
          CFI (cfiCond289) Conditional ??CrossCallReturnLabel_68, ??CrossCallReturnLabel_109
          CFI (cfiCond289) R6 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond289) VB load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond289) V0 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond289) V1 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond289) V2 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond289) V3 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond289) V4 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond289) V5 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond289) V6 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond289) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond289) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond289) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond289) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond289) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond289) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond289) CFA_SP SP+0
          CFI (cfiCond289) CFA_XSP16 add(XSP16, 23)
          CFI Block cfiCond290 Using cfiCommon0
          CFI (cfiCond290) Function APSME_LinkKeyNVIdGet
          CFI (cfiCond290) Conditional ??CrossCallReturnLabel_68, ??CrossCallReturnLabel_110
          CFI (cfiCond290) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond290) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond290) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond290) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond290) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond290) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond290) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond290) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond290) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond290) CFA_SP SP+0
          CFI (cfiCond290) CFA_XSP16 add(XSP16, 11)
          CFI Block cfiCond291 Using cfiCommon0
          CFI (cfiCond291) Function APSME_LinkKeySet
          CFI (cfiCond291) Conditional ??CrossCallReturnLabel_69, ??CrossCallReturnLabel_57
          CFI (cfiCond291) R6 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond291) VB load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond291) V0 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond291) V1 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond291) V2 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond291) V3 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond291) V4 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond291) V5 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond291) V6 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond291) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond291) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond291) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond291) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond291) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond291) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond291) CFA_SP SP+0
          CFI (cfiCond291) CFA_XSP16 add(XSP16, 19)
          CFI Block cfiCond292 Using cfiCommon0
          CFI (cfiCond292) Function ZDSecMgrAuthenticationSet
          CFI (cfiCond292) Conditional ??CrossCallReturnLabel_69, ??CrossCallReturnLabel_58, ??CrossCallReturnLabel_16
          CFI (cfiCond292) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond292) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond292) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond292) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond292) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond292) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond292) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond292) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond292) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond292) CFA_SP SP+0
          CFI (cfiCond292) CFA_XSP16 add(XSP16, 11)
          CFI Block cfiCond293 Using cfiCommon0
          CFI (cfiCond293) Function ZDSecMgrAuthenticationCheck
          CFI (cfiCond293) Conditional ??CrossCallReturnLabel_69, ??CrossCallReturnLabel_58, ??CrossCallReturnLabel_17
          CFI (cfiCond293) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond293) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond293) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond293) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond293) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond293) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond293) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond293) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond293) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond293) CFA_SP SP+0
          CFI (cfiCond293) CFA_XSP16 add(XSP16, 21)
          CFI Block cfiPicker294 Using cfiCommon1
          CFI (cfiPicker294) NoFunction
          CFI (cfiPicker294) Picker
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPH,A
        MOV     DPL,R0
        RET
          CFI EndBlock cfiCond288
          CFI EndBlock cfiCond289
          CFI EndBlock cfiCond290
          CFI EndBlock cfiCond291
          CFI EndBlock cfiCond292
          CFI EndBlock cfiCond293
          CFI EndBlock cfiPicker294
// 2196 
// 2197 /******************************************************************************
// 2198  * @fn          ZDSecMgrLinkKeyNVIdGet (stubs APSME_LinkKeyNVIdGet)
// 2199  *
// 2200  * @brief       Get Key NV ID for specified NWK address.
// 2201  *
// 2202  * @param       extAddr - [in] EXT address
// 2203  * @param       keyNvId - [out] NV ID
// 2204  *
// 2205  * @return      ZStatus_t
// 2206  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 2207 ZStatus_t ZDSecMgrLinkKeyNVIdGet(uint8* extAddr, uint16 *pKeyNvId)
APSME_LinkKeyNVIdGet:
          CFI Block cfiBlock295 Using cfiCommon0
          CFI Function APSME_LinkKeyNVIdGet
        CODE
// 2208 {
        FUNCALL APSME_LinkKeyNVIdGet, ZDSecMgrEntryLookupExt
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 11, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 11, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x9
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 2
        MOV     A,#-0x2
        LCALL   ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 11)
        MOV     A,R4
        MOV     R6,A
        MOV     A,R5
        MOV     R7,A
// 2209   ZStatus_t status;
// 2210   ZDSecMgrEntry_t* entry;
// 2211 
// 2212   // lookup entry index for specified NWK address
// 2213   status = ZDSecMgrEntryLookupExt( extAddr, &entry );
        ; Setup parameters for call to function ZDSecMgrEntryLookupExt
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     R4,DPL
        MOV     R5,DPH
        LCALL   ??ZDSecMgrEntryLookupExt?relay
        MOV     A,R1
// 2214 
// 2215   if ( status == ZSuccess )
        JNZ     ??APSME_LinkKeyNVIdGet_0
// 2216   {
// 2217     // return the index to the NV table
// 2218     *pKeyNvId = entry->keyNvId;
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        LCALL   ?Subroutine22 & 0xFFFF
// 2219   }
??CrossCallReturnLabel_110:
        MOV     DPL,R6
        MOV     DPH,R7
        MOV     A,R2
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R3
        SJMP    ??APSME_LinkKeyNVIdGet_1
// 2220   else
// 2221   {
// 2222     *pKeyNvId = SEC_NO_KEY_NV_ID;
??APSME_LinkKeyNVIdGet_0:
        MOV     DPL,R6
        MOV     DPH,R7
        CLR     A
        MOVX    @DPTR,A
        INC     DPTR
??APSME_LinkKeyNVIdGet_1:
        MOVX    @DPTR,A
// 2223   }
// 2224 
// 2225   return status;
        LJMP    ?Subroutine7 & 0xFFFF
          CFI EndBlock cfiBlock295
// 2226 }

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine0:
          CFI Block cfiBlock296 Using cfiCommon0
          CFI NoFunction
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 22)
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        MOV     A,#0xd
          CFI EndBlock cfiBlock296
        REQUIRE ??Subroutine67_0
        ; // Fall through to label ??Subroutine67_0

        RSEG BANKED_CODE:CODE:NOROOT(0)
??Subroutine67_0:
          CFI Block cfiBlock297 Using cfiCommon0
          CFI NoFunction
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 24)
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI Invalid
        LCALL   ?DEALLOC_XSTACK8
          CFI EndBlock cfiBlock297
        REQUIRE ??Subroutine68_0
        ; // Fall through to label ??Subroutine68_0

        RSEG BANKED_CODE:CODE:NOROOT(0)
??Subroutine68_0:
          CFI Block cfiBlock298 Using cfiCommon0
          CFI NoFunction
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        MOV     R7,#0x1
        LJMP    ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock298
// 2227 
// 2228 /******************************************************************************
// 2229  * @fn          ZDSecMgrIsLinkKeyValid (stubs APSME_IsLinkKeyValid)
// 2230  *
// 2231  * @brief       Verifies if Link Key in NV has been set.
// 2232  *
// 2233  * @param       extAddr - [in] EXT address
// 2234  *
// 2235  * @return      TRUE - Link Key has been established
// 2236  *              FALSE - Link Key in NV has default value.
// 2237  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 2238 uint8 ZDSecMgrIsLinkKeyValid(uint8* extAddr)
APSME_IsLinkKeyValid:
          CFI Block cfiBlock299 Using cfiCommon0
          CFI Function APSME_IsLinkKeyValid
        CODE
// 2239 {
        FUNCALL APSME_IsLinkKeyValid, osal_memset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 33, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 33, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_IsLinkKeyValid, APSME_LinkKeyNVIdGet
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 33, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 33, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_IsLinkKeyValid, osal_mem_alloc
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 33, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 33, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_IsLinkKeyValid, osal_nv_read
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 37, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 37, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_IsLinkKeyValid, osal_memcmp
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 36, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 36, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_IsLinkKeyValid, osal_memset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 33, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 33, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_IsLinkKeyValid, osal_mem_free
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 33, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 33, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0xf
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 15)
        ; Saved register size: 15
        ; Auto size: 18
        MOV     A,#-0x12
        LCALL   ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 33)
        MOV     A,R2
        MOV     R6,A
        MOV     A,R3
        MOV     R7,A
// 2240   APSME_LinkKeyData_t *pKeyData;
// 2241   uint16 apsLinkKeyNvId;
// 2242   uint8 nullKey[SEC_KEY_LEN];
// 2243   uint8 status = FALSE;
        MOV     ?V0 + 0,#0x0
// 2244 
// 2245   // initialize default vealue to compare to
// 2246   osal_memset(nullKey, 0x00, SEC_KEY_LEN);
        ; Setup parameters for call to function osal_memset
        MOV     R4,#0x10
        MOV     R5,#0x0
        MOV     R1,#0x0
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??osal_memset?relay
// 2247 
// 2248   // check for APS link NV ID
// 2249   APSME_LinkKeyNVIdGet( extAddr, &apsLinkKeyNvId );
        ; Setup parameters for call to function APSME_LinkKeyNVIdGet
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     R4,DPL
        MOV     R5,DPH
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        LCALL   ??APSME_LinkKeyNVIdGet?relay
// 2250 
// 2251   if (apsLinkKeyNvId != SEC_NO_KEY_NV_ID )
        LCALL   ?Subroutine23 & 0xFFFF
??CrossCallReturnLabel_160:
        JZ      ??APSME_IsLinkKeyValid_0
// 2252   {
// 2253     pKeyData = (APSME_LinkKeyData_t *)osal_mem_alloc(sizeof(APSME_LinkKeyData_t));
        ; Setup parameters for call to function osal_mem_alloc
        MOV     R2,#0x18
        MOV     R3,#0x0
        LCALL   ??osal_mem_alloc?relay
        MOV     ?V0 + 2,R2
        MOV     ?V0 + 3,R3
// 2254 
// 2255     if (pKeyData != NULL)
        MOV     A,R2
        ORL     A,?V0 + 3
        JZ      ??APSME_IsLinkKeyValid_0
// 2256     {
// 2257       // retrieve key from NV
// 2258       if ( osal_nv_read( apsLinkKeyNvId, 0,
// 2259                         sizeof(APSME_LinkKeyData_t), pKeyData) == ZSUCCESS)
        ; Setup parameters for call to function osal_nv_read
        MOV     R0,#?V0 + 2
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 35)
        MOV     ?V0 + 4,#0x18
        MOV     ?V0 + 5,#0x0
        MOV     R0,#?V0 + 4
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 37)
        MOV     R4,#0x0
        MOV     R5,#0x0
        MOV     A,#0x4
        LCALL   ?XSTACK_DISP0_8
        LCALL   ??Subroutine59_0 & 0xFFFF
??CrossCallReturnLabel_103:
        LCALL   ??osal_nv_read?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 33)
        MOV     A,R1
        JNZ     ??APSME_IsLinkKeyValid_1
// 2260       {
// 2261         // if stored key is different than default value, then a key has been established
// 2262         if (!osal_memcmp(pKeyData, nullKey, SEC_KEY_LEN))
        ; Setup parameters for call to function osal_memcmp
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        MOV     R1,DPL
        MOV     R2,DPH
        MOV     ?V0 + 4,R1
        MOV     ?V0 + 5,R2
        MOV     ?V0 + 6,#0x0
        MOV     R0,#?V0 + 4
        LCALL   ?PUSH_XSTACK_I_THREE
          CFI CFA_XSP16 add(XSP16, 36)
        MOV     R4,#0x10
        MOV     R5,#0x0
        MOV     DPL,?V0 + 2
        MOV     DPH,?V0 + 3
        MOV     R1,DPL
        MOV     R2,DPH
        MOV     R3,#0x0
        LCALL   ??osal_memcmp?relay
        MOV     A,#0x3
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 33)
        MOV     A,R1
        JNZ     ??APSME_IsLinkKeyValid_1
// 2263         {
// 2264           status = TRUE;
        MOV     ?V0 + 0,#0x1
// 2265         }
// 2266       }
// 2267 
// 2268       // clear copy of key in RAM
// 2269       osal_memset(pKeyData, 0x00, sizeof(APSME_LinkKeyData_t));
??APSME_IsLinkKeyValid_1:
        ; Setup parameters for call to function osal_memset
        MOV     R4,#0x18
        MOV     R5,#0x0
        MOV     R1,#0x0
        MOV     R2,?V0 + 2
        MOV     R3,?V0 + 3
        LCALL   ??osal_memset?relay
// 2270 
// 2271       osal_mem_free(pKeyData);
        ; Setup parameters for call to function osal_mem_free
        MOV     R2,?V0 + 2
        MOV     R3,?V0 + 3
        LCALL   ??osal_mem_free?relay
// 2272     }
// 2273   }
// 2274 
// 2275   return status;
??APSME_IsLinkKeyValid_0:
        MOV     R1,?V0 + 0
        MOV     A,#0x12
        LJMP    ?Subroutine5 & 0xFFFF
          CFI EndBlock cfiBlock299
// 2276 }
// 2277 
// 2278 /******************************************************************************
// 2279  * @fn          ZDSecMgrKeyFwdToChild (stubs APSME_KeyFwdToChild)
// 2280  *
// 2281  * @brief       Verify and process key transportation to child.
// 2282  *
// 2283  * @param       ind - [in] APSME_TransportKeyInd_t
// 2284  *
// 2285  * @return      uint8 - success(TRUE:FALSE)
// 2286  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 2287 uint8 ZDSecMgrKeyFwdToChild( APSME_TransportKeyInd_t* ind )
APSME_KeyFwdToChild:
          CFI Block cfiBlock300 Using cfiCommon0
          CFI Function APSME_KeyFwdToChild
        CODE
// 2288 {
        FUNCALL APSME_KeyFwdToChild, AssocGetWithExt
        LOCFRAME ISTACK, 2, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 0, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 0, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_KeyFwdToChild, ZDSecMgrAssocDeviceAuth
        LOCFRAME ISTACK, 2, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 0, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 0, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        PUSH    DPL
          CFI DPL0 Frame(CFA_SP, 4)
          CFI CFA_SP SP+-4
        PUSH    DPH
          CFI DPH0 Frame(CFA_SP, 5)
          CFI CFA_SP SP+-5
        ; Saved register size: 2
        ; Auto size: 0
// 2289   // verify from Trust Center
// 2290   if ( ind->srcAddr == APSME_TRUSTCENTER_NWKADDR )
        MOV     DPL,R2
        MOV     DPH,R3
        LCALL   ??Subroutine69_0 & 0xFFFF
??CrossCallReturnLabel_158:
        JNZ     ??APSME_KeyFwdToChild_0
// 2291   {
// 2292     // check for initial NWK key
// 2293     if ( ( ind->keyType == KEY_TYPE_NWK ) ||
// 2294          ( ind->keyType == 6            ) )
        MOV     DPL,R2
        MOV     DPH,R3
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R0,A
        MOV     A,#0x1
        XRL     A,R0
        JZ      ??APSME_KeyFwdToChild_1
        MOV     A,#0x6
        XRL     A,R0
        JNZ     ??APSME_KeyFwdToChild_2
// 2295     {
// 2296       // set association status to authenticated
// 2297       ZDSecMgrAssocDeviceAuth( AssocGetWithExt( ind->dstExtAddr ) );
??APSME_KeyFwdToChild_1:
        ; Setup parameters for call to function ZDSecMgrAssocDeviceAuth
        ; Setup parameters for call to function AssocGetWithExt
        MOV     DPL,R2
        MOV     DPH,R3
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        LCALL   ??Subroutine58_0 & 0xFFFF
// 2298     }
??CrossCallReturnLabel_106:
        LCALL   ??AssocGetWithExt?relay
        LCALL   ??ZDSecMgrAssocDeviceAuth?relay
// 2299 
// 2300     return TRUE;
??APSME_KeyFwdToChild_2:
        MOV     R1,#0x1
        SJMP    ??APSME_KeyFwdToChild_3
// 2301   }
// 2302 
// 2303   return FALSE;
??APSME_KeyFwdToChild_0:
        MOV     R1,#0x0
??APSME_KeyFwdToChild_3:
        LJMP    ??Subroutine61_0 & 0xFFFF
          CFI EndBlock cfiBlock300
// 2304 }

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine23:
          CFI Block cfiCond301 Using cfiCommon0
          CFI Function ZDSecMgrTransportKeyInd
          CFI Conditional ??CrossCallReturnLabel_159
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 34)
          CFI Block cfiCond302 Using cfiCommon0
          CFI (cfiCond302) Function APSME_IsLinkKeyValid
          CFI (cfiCond302) Conditional ??CrossCallReturnLabel_160
          CFI (cfiCond302) R6 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond302) VB load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond302) V0 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond302) V1 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond302) V2 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond302) V3 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond302) V4 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond302) V5 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond302) V6 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond302) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond302) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond302) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond302) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond302) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond302) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond302) CFA_SP SP+0
          CFI (cfiCond302) CFA_XSP16 add(XSP16, 33)
          CFI Block cfiCond303 Using cfiCommon0
          CFI (cfiCond303) Function ZDSecMgrAddLinkKey
          CFI (cfiCond303) Conditional ??CrossCallReturnLabel_161
          CFI (cfiCond303) R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond303) VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond303) V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond303) V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond303) V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond303) V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond303) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond303) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond303) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond303) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond303) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond303) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond303) CFA_SP SP+0
          CFI (cfiCond303) CFA_XSP16 add(XSP16, 16)
          CFI Block cfiCond304 Using cfiCommon0
          CFI (cfiCond304) Function ZDSecMgrRestoreFromNV
          CFI (cfiCond304) Conditional ??CrossCallReturnLabel_162
          CFI (cfiCond304) R6 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI (cfiCond304) VB load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI (cfiCond304) V0 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI (cfiCond304) V1 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond304) V2 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond304) V3 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond304) V4 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond304) V5 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond304) V6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond304) V7 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond304) V8 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond304) V9 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond304) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond304) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond304) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond304) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond304) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond304) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond304) CFA_SP SP+0
          CFI (cfiCond304) CFA_XSP16 add(XSP16, 20)
          CFI Block cfiPicker305 Using cfiCommon1
          CFI (cfiPicker305) NoFunction
          CFI (cfiPicker305) Picker
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
          CFI EndBlock cfiCond301
          CFI EndBlock cfiCond302
          CFI EndBlock cfiCond303
          CFI EndBlock cfiCond304
          CFI EndBlock cfiPicker305
        REQUIRE ??Subroutine69_0
        ; // Fall through to label ??Subroutine69_0

        RSEG BANKED_CODE:CODE:NOROOT(0)
??Subroutine69_0:
          CFI Block cfiCond306 Using cfiCommon0
          CFI Function ZDSecMgrEntryInit
          CFI Conditional ??CrossCallReturnLabel_152
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
          CFI Block cfiCond307 Using cfiCommon0
          CFI (cfiCond307) Function ZDSecMgrEntryLookupExtGetIndex
          CFI (cfiCond307) Conditional ??CrossCallReturnLabel_153
          CFI (cfiCond307) R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond307) VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond307) V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond307) V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond307) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond307) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond307) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond307) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond307) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond307) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond307) CFA_SP SP+0
          CFI (cfiCond307) CFA_XSP16 add(XSP16, 12)
          CFI Block cfiCond308 Using cfiCommon0
          CFI (cfiCond308) Function ZDSecMgrEntryLookupAMIGetIndex
          CFI (cfiCond308) Conditional ??CrossCallReturnLabel_154
          CFI (cfiCond308) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond308) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond308) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond308) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond308) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond308) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond308) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond308) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond308) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond308) CFA_SP SP+0
          CFI (cfiCond308) CFA_XSP16 add(XSP16, 9)
          CFI Block cfiCond309 Using cfiCommon0
          CFI (cfiCond309) Function ZDSecMgrEntryFree
          CFI (cfiCond309) Conditional ??CrossCallReturnLabel_155
          CFI (cfiCond309) R6 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI (cfiCond309) VB load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond309) V0 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond309) V1 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond309) V2 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond309) V3 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond309) V4 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond309) V5 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond309) V6 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond309) V7 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond309) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond309) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond309) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond309) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond309) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond309) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond309) CFA_SP SP+0
          CFI (cfiCond309) CFA_XSP16 add(XSP16, 20)
          CFI Block cfiCond310 Using cfiCommon0
          CFI (cfiCond310) Function ZDSecMgrEntryFree
          CFI (cfiCond310) Conditional ??CrossCallReturnLabel_156
          CFI (cfiCond310) R6 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI (cfiCond310) VB load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond310) V0 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond310) V1 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond310) V2 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond310) V3 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond310) V4 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond310) V5 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond310) V6 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond310) V7 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond310) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond310) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond310) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond310) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond310) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond310) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond310) CFA_SP SP+0
          CFI (cfiCond310) CFA_XSP16 add(XSP16, 20)
          CFI Block cfiCond311 Using cfiCommon0
          CFI (cfiCond311) Function ZDSecMgrRemoveDeviceInd
          CFI (cfiCond311) Conditional ??CrossCallReturnLabel_157
          CFI (cfiCond311) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond311) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond311) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond311) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond311) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond311) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond311) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond311) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond311) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond311) CFA_SP SP+0
          CFI (cfiCond311) CFA_XSP16 add(XSP16, 17)
          CFI Block cfiCond312 Using cfiCommon0
          CFI (cfiCond312) Function APSME_KeyFwdToChild
          CFI (cfiCond312) Conditional ??CrossCallReturnLabel_158
          CFI (cfiCond312) DPL0 Frame(CFA_SP, 4)
          CFI (cfiCond312) DPH0 Frame(CFA_SP, 5)
          CFI (cfiCond312) CFA_SP SP+-5
          CFI Block cfiCond313 Using cfiCommon0
          CFI (cfiCond313) Function ZDSecMgrTransportKeyInd
          CFI (cfiCond313) Conditional ??CrossCallReturnLabel_159
          CFI (cfiCond313) R6 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond313) VB load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond313) V0 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond313) V1 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond313) V2 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond313) V3 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond313) V4 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond313) V5 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond313) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond313) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond313) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond313) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond313) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond313) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond313) CFA_SP SP+0
          CFI (cfiCond313) CFA_XSP16 add(XSP16, 34)
          CFI Block cfiCond314 Using cfiCommon0
          CFI (cfiCond314) Function APSME_IsLinkKeyValid
          CFI (cfiCond314) Conditional ??CrossCallReturnLabel_160
          CFI (cfiCond314) R6 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond314) VB load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond314) V0 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond314) V1 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond314) V2 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond314) V3 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond314) V4 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond314) V5 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond314) V6 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond314) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond314) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond314) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond314) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond314) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond314) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond314) CFA_SP SP+0
          CFI (cfiCond314) CFA_XSP16 add(XSP16, 33)
          CFI Block cfiCond315 Using cfiCommon0
          CFI (cfiCond315) Function ZDSecMgrAddLinkKey
          CFI (cfiCond315) Conditional ??CrossCallReturnLabel_161
          CFI (cfiCond315) R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond315) VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond315) V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond315) V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond315) V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond315) V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond315) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond315) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond315) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond315) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond315) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond315) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond315) CFA_SP SP+0
          CFI (cfiCond315) CFA_XSP16 add(XSP16, 16)
          CFI Block cfiCond316 Using cfiCommon0
          CFI (cfiCond316) Function ZDSecMgrRestoreFromNV
          CFI (cfiCond316) Conditional ??CrossCallReturnLabel_162
          CFI (cfiCond316) R6 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI (cfiCond316) VB load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI (cfiCond316) V0 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI (cfiCond316) V1 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond316) V2 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond316) V3 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond316) V4 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond316) V5 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond316) V6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond316) V7 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond316) V8 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond316) V9 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond316) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond316) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond316) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond316) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond316) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond316) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond316) CFA_SP SP+0
          CFI (cfiCond316) CFA_XSP16 add(XSP16, 20)
          CFI Block cfiPicker317 Using cfiCommon1
          CFI (cfiPicker317) NoFunction
          CFI (cfiPicker317) Picker
        LCALL   ?Subroutine44 & 0xFFFF
??CrossCallReturnLabel_166:
        ORL     A,R1
        RET
          CFI EndBlock cfiCond306
          CFI EndBlock cfiCond307
          CFI EndBlock cfiCond308
          CFI EndBlock cfiCond309
          CFI EndBlock cfiCond310
          CFI EndBlock cfiCond311
          CFI EndBlock cfiCond312
          CFI EndBlock cfiCond313
          CFI EndBlock cfiCond314
          CFI EndBlock cfiCond315
          CFI EndBlock cfiCond316
          CFI EndBlock cfiPicker317
// 2305 
// 2306 /******************************************************************************
// 2307  * @fn          ZDSecMgrAddLinkKey
// 2308  *
// 2309  * @brief       Add the application link key to ZDSecMgr. Also mark the device
// 2310  *              as authenticated in the authenticateOption. Note that this function
// 2311  *              is hardwared to CBKE right now.
// 2312  *
// 2313  * @param       shortAddr - short address of the partner device
// 2314  * @param       extAddr - extended address of the partner device
// 2315  * @param       key - link key
// 2316  *
// 2317  * @return      ZStatus_t
// 2318  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 2319 ZStatus_t ZDSecMgrAddLinkKey( uint16 shortAddr, uint8 *extAddr, uint8 *key)
ZDSecMgrAddLinkKey:
          CFI Block cfiBlock318 Using cfiCommon0
          CFI Function ZDSecMgrAddLinkKey
        CODE
// 2320 {
        FUNCALL ZDSecMgrAddLinkKey, ZDSecMgrAddrStore
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 18, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 18, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrAddLinkKey, ZDSecMgrEntryLookupAMI
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 16, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 16, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrAddLinkKey, ZDSecMgrEntryNew
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 16, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 16, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrAddLinkKey, APSME_LinkKeySet
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 16, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 16, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrAddLinkKey, ZDSecMgrAuthenticationSet
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 16, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 16, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrAddLinkKey, ZDSecMgrWriteNV
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 16, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 16, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0xc
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 12)
        ; Saved register size: 12
        ; Auto size: 4
        MOV     A,#-0x4
        LCALL   ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 16)
        MOV     A,R4
        MOV     R6,A
        MOV     A,R5
        MOV     R7,A
        MOV     A,#0x10
        LCALL   ?XSTACK_DISP0_8
        MOVX    A,@DPTR
        MOV     ?V0 + 0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     ?V0 + 1,A
// 2321   uint16           ami;
// 2322   ZDSecMgrEntry_t* entry;
// 2323 
// 2324   /* Store the device address in the addr manager */
// 2325   if( ZDSecMgrAddrStore( shortAddr, extAddr, &ami ) != ZSuccess )
        ; Setup parameters for call to function ZDSecMgrAddrStore
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        MOV     ?V0 + 2,DPL
        MOV     ?V0 + 3,DPH
        MOV     R0,#?V0 + 2
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 18)
        LCALL   ??ZDSecMgrAddrStore?relay
        MOV     A,#0x2
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 16)
        MOV     A,R1
        JZ      ??ZDSecMgrAddLinkKey_0
// 2326   {
// 2327     /* Adding to Addr Manager fails */
// 2328     return ZFailure;
        MOV     R1,#0x1
        SJMP    ??ZDSecMgrAddLinkKey_1
// 2329   }
// 2330 
// 2331   /* Lookup entry using specified address index */
// 2332   ZDSecMgrEntryLookupAMI( ami, &entry );
??ZDSecMgrAddLinkKey_0:
        ; Setup parameters for call to function ZDSecMgrEntryLookupAMI
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     R4,DPL
        MOV     R5,DPH
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        LCALL   ??Subroutine59_0 & 0xFFFF
??CrossCallReturnLabel_104:
        LCALL   ??ZDSecMgrEntryLookupAMI?relay
// 2333 
// 2334   // If no existing entry, create one
// 2335   if ( entry == NULL )
        LCALL   ?Subroutine23 & 0xFFFF
??CrossCallReturnLabel_161:
        JNZ     ??CrossCallReturnLabel_137
// 2336   {
// 2337     if ( ZDSecMgrEntryNew( &entry ) == ZSuccess )
        ; Setup parameters for call to function ZDSecMgrEntryNew
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??ZDSecMgrEntryNew?relay
        MOV     A,R1
        JNZ     ??ZDSecMgrAddLinkKey_2
// 2338     {
// 2339       entry->ami = ami;
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        LCALL   ?Subroutine20 & 0xFFFF
// 2340     }
// 2341     else
// 2342     {
// 2343       /* Security Manager full */
// 2344       return ZBufferFull;
// 2345     }
// 2346   }
// 2347   // Write the link key
// 2348   APSME_LinkKeySet( extAddr, key );
??CrossCallReturnLabel_137:
        ; Setup parameters for call to function APSME_LinkKeySet
        MOV     R4,?V0 + 0
        MOV     R5,?V0 + 1
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        LCALL   ??APSME_LinkKeySet?relay
// 2349 
// 2350 #if defined (TC_LINKKEY_JOIN)
// 2351   // Mark the device as authenticated.
// 2352   ZDSecMgrAuthenticationSet( extAddr, ZDSecMgr_Authenticated_CBCK );
        ; Setup parameters for call to function ZDSecMgrAuthenticationSet
        MOV     R1,#0x1
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        LCALL   ??ZDSecMgrAuthenticationSet?relay
// 2353 #endif
// 2354 
// 2355 #if defined NV_RESTORE
// 2356   ZDSecMgrWriteNV();  // Write the new established link key to NV.
        ; Setup parameters for call to function ZDSecMgrWriteNV
        LCALL   ??ZDSecMgrWriteNV?relay
// 2357 #endif
// 2358 
// 2359   return ZSuccess;
        MOV     R1,#0x0
??ZDSecMgrAddLinkKey_1:
        MOV     A,#0x4
        LJMP    ?Subroutine3 & 0xFFFF
??ZDSecMgrAddLinkKey_2:
        MOV     R1,#0x11
        SJMP    ??ZDSecMgrAddLinkKey_1
          CFI EndBlock cfiBlock318
// 2360 }
// 2361 
// 2362 /******************************************************************************
// 2363  * @fn          ZDSecMgrInitNV
// 2364  *
// 2365  * @brief       Initialize the SecMgr entry data in NV with all values set to 0
// 2366  *
// 2367  * @param       none
// 2368  *
// 2369  * @return      uint8 - <osal_nv_item_init> return codes
// 2370  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 2371 uint8 ZDSecMgrInitNV(void)
ZDSecMgrInitNV:
          CFI Block cfiBlock319 Using cfiCommon0
          CFI Function ZDSecMgrInitNV
        CODE
// 2372 {
        FUNCALL ZDSecMgrInitNV, osal_nv_item_init
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 14, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrInitNV, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 16, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 16, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrInitNV, osal_nv_item_init
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 14, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0xa
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 10)
        ; Saved register size: 10
        ; Auto size: 2
        MOV     A,#-0x2
        LCALL   ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 12)
// 2373 
// 2374   uint8 rtrn = osal_nv_item_init(ZCD_NV_APS_LINK_KEY_TABLE,
// 2375                 (sizeof(nvDeviceListHdr_t) + (sizeof(ZDSecMgrEntry_t) * ZDSECMGR_ENTRY_MAX)), NULL);
        ; Setup parameters for call to function osal_nv_item_init
        CLR     A
        MOV     ?V0 + 0,A
        MOV     ?V0 + 1,A
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 14)
        MOV     R4,#0x11
        MOV     R5,#0x0
        MOV     R2,#0x4c
        MOV     R3,#0x0
        LCALL   ??osal_nv_item_init?relay
        MOV     A,#0x2
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 12)
        MOV     A,R1
        MOV     R6,A
// 2376 
// 2377   // If the item does not already exist, set all values to 0
// 2378   if (rtrn != SUCCESS)
        JZ      ??ZDSecMgrInitNV_0
// 2379   {
// 2380     nvDeviceListHdr_t hdr;
// 2381     hdr.numRecs = 0;
        LCALL   ?Subroutine15 & 0xFFFF
// 2382     osal_nv_write(ZCD_NV_APS_LINK_KEY_TABLE, 0, sizeof(nvDeviceListHdr_t), &hdr);
// 2383   }
??CrossCallReturnLabel_2:
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 14)
        MOV     ?V0 + 0,#0x2
        MOV     ?V0 + 1,#0x0
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 16)
        MOV     R4,#0x0
        MOV     R5,#0x0
        MOV     R2,#0x4c
        MOV     R3,#0x0
        LCALL   ??osal_nv_write?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 12)
// 2384 
// 2385   rtrn |= osal_nv_item_init( ZCD_NV_TRUSTCENTER_ADDR, Z_EXTADDR_LEN,
// 2386                              zgApsTrustCenterAddr );
// 2387 
// 2388   return rtrn;
??ZDSecMgrInitNV_0:
        ; Setup parameters for call to function osal_nv_item_init
        MOV     ?V0 + 0,#zgApsTrustCenterAddr & 0xff
        MOV     ?V0 + 1,#(zgApsTrustCenterAddr >> 8) & 0xff
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 14)
        MOV     R4,#0x8
        MOV     R5,#0x0
        MOV     R2,#0x71
        MOV     R3,#0x0
        LCALL   ??osal_nv_item_init?relay
        MOV     A,#0x2
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 12)
        MOV     A,R1
        ORL     A,R6
        MOV     R1,A
        LJMP    ?Subroutine1 & 0xFFFF
          CFI EndBlock cfiBlock319
// 2389 }
// 2390 
// 2391 #if defined ( NV_RESTORE )
// 2392 /*********************************************************************
// 2393  * @fn      ZDSecMgrWriteNV()
// 2394  *
// 2395  * @brief   Save off the APS link key list to NV
// 2396  *
// 2397  * @param   none
// 2398  *
// 2399  * @return  none
// 2400  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 2401 static void ZDSecMgrWriteNV( void )
ZDSecMgrWriteNV:
          CFI Block cfiBlock320 Using cfiCommon0
          CFI Function ZDSecMgrWriteNV
        CODE
// 2402 {
        FUNCALL ZDSecMgrWriteNV, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 18, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 18, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrWriteNV, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 18, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 18, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0xc
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 12)
        ; Saved register size: 12
        ; Auto size: 2
        MOV     A,#-0x2
        LCALL   ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 14)
// 2403   uint16 i;
// 2404   nvDeviceListHdr_t hdr;
// 2405 
// 2406   hdr.numRecs = 0;
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        LCALL   ?Subroutine11 & 0xFFFF
// 2407 
// 2408   if (ZDSecMgrEntries != NULL)
??CrossCallReturnLabel_80:
        JZ      ??ZDSecMgrWriteNV_0
// 2409   {
// 2410     for ( i = 0; i < ZDSECMGR_ENTRY_MAX; i++ )
        MOV     R6,#0x0
        MOV     R7,#0x0
// 2411     {
// 2412       // Save off the record
// 2413       osal_nv_write( ZCD_NV_APS_LINK_KEY_TABLE,
// 2414                     (uint16)((sizeof(nvDeviceListHdr_t)) + (i * sizeof(ZDSecMgrEntry_t))),
// 2415                     sizeof(ZDSecMgrEntry_t), &ZDSecMgrEntries[i] );
??ZDSecMgrWriteNV_1:
        MOV     ?V0 + 0,R6
        MOV     ?V0 + 1,R7
        MOV     A,?V0 + 0
        MOV     B,#0x5
        MUL     AB
        MOV     ?V0 + 0,A
        MOV     R0,B
        MOV     B,#0x5
        MOV     A,?V0 + 1
        MUL     AB
        ADD     A,R0
        MOV     ?V0 + 1,A
        ; Setup parameters for call to function osal_nv_write
        MOV     DPTR,#ZDSecMgrEntries
        MOVX    A,@DPTR
        ADD     A,?V0 + 0
        MOV     ?V0 + 2,A
        INC     DPTR
        MOVX    A,@DPTR
        ADDC    A,?V0 + 1
        MOV     ?V0 + 3,A
        MOV     R0,#?V0 + 2
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 16)
        MOV     ?V0 + 2,#0x5
        MOV     ?V0 + 3,#0x0
        MOV     R0,#?V0 + 2
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 18)
        LCALL   ?Subroutine34 & 0xFFFF
??CrossCallReturnLabel_38:
        LCALL   ??osal_nv_write?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 14)
// 2416 
// 2417       if ( ZDSecMgrEntries[i].ami != INVALID_NODE_ADDR )
        MOV     DPTR,#ZDSecMgrEntries
        MOVX    A,@DPTR
        ADD     A,?V0 + 0
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        ADDC    A,?V0 + 1
        MOV     DPL,R0
        MOV     DPH,A
        MOVX    A,@DPTR
        XRL     A,#0xfe
        JNZ     ??ZDSecMgrWriteNV_2
        INC     DPTR
        MOVX    A,@DPTR
        CPL     A
??ZDSecMgrWriteNV_2:
        JZ      ??ZDSecMgrWriteNV_3
// 2418       {
// 2419         hdr.numRecs++;
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        LCALL   ?Subroutine31 & 0xFFFF
// 2420       }
// 2421     }
??CrossCallReturnLabel_28:
        MOVX    @DPTR,A
??ZDSecMgrWriteNV_3:
        LCALL   ?Subroutine33 & 0xFFFF
// 2422   }
??CrossCallReturnLabel_34:
        JC      ??ZDSecMgrWriteNV_1
// 2423 
// 2424   // Save off the header
// 2425   osal_nv_write( ZCD_NV_APS_LINK_KEY_TABLE, 0, sizeof( nvDeviceListHdr_t ), &hdr );
??ZDSecMgrWriteNV_0:
        ; Setup parameters for call to function osal_nv_write
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     ?V0 + 0,DPL
        MOV     ?V0 + 1,DPH
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 16)
        MOV     ?V0 + 0,#0x2
        MOV     ?V0 + 1,#0x0
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 18)
        MOV     R4,#0x0
        MOV     R5,#0x0
        MOV     R2,#0x4c
        MOV     R3,#0x0
        LCALL   ??osal_nv_write?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 14)
// 2426 }
        MOV     A,#0x2
          CFI EndBlock cfiBlock320
        REQUIRE ?Subroutine3
        ; // Fall through to label ?Subroutine3

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine3:
          CFI Block cfiBlock321 Using cfiCommon0
          CFI NoFunction
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 46)
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI Invalid
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 12)
          CFI Valid
        MOV     R7,#0x4
        LJMP    ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock321

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine31:
          CFI Block cfiCond322 Using cfiCommon0
          CFI Function ZDSecMgrEntryFree
          CFI Conditional ??CrossCallReturnLabel_27
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V7 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 20)
          CFI Block cfiCond323 Using cfiCommon0
          CFI (cfiCond323) Function ZDSecMgrWriteNV
          CFI (cfiCond323) Conditional ??CrossCallReturnLabel_28
          CFI (cfiCond323) R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond323) VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond323) V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond323) V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond323) V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond323) V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond323) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond323) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond323) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond323) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond323) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond323) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond323) CFA_SP SP+0
          CFI (cfiCond323) CFA_XSP16 add(XSP16, 14)
          CFI Block cfiPicker324 Using cfiCommon1
          CFI (cfiPicker324) NoFunction
          CFI (cfiPicker324) Picker
        MOVX    A,@DPTR
        ADD     A,#0x1
        MOVX    @DPTR,A
        INC     DPTR
        MOVX    A,@DPTR
        ADDC    A,#0x0
        RET
          CFI EndBlock cfiCond322
          CFI EndBlock cfiCond323
          CFI EndBlock cfiPicker324
// 2427 #endif // NV_RESTORE
// 2428 
// 2429 #if defined ( NV_RESTORE )
// 2430 /******************************************************************************
// 2431  * @fn          ZDSecMgrRestoreFromNV
// 2432  *
// 2433  * @brief       Restore the APS Link Key entry data from NV. It does not restore
// 2434  *              the key data itself as they remain in NV until they are used.
// 2435  *              Only list data is restored.
// 2436  *              Restore zgTrustCenterAdress from NV.
// 2437  *
// 2438  * @param       none
// 2439  *
// 2440  * @return      None.
// 2441  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 2442 static void ZDSecMgrRestoreFromNV( void )
ZDSecMgrRestoreFromNV:
          CFI Block cfiBlock325 Using cfiCommon0
          CFI Function ZDSecMgrRestoreFromNV
        CODE
// 2443 {
        FUNCALL ZDSecMgrRestoreFromNV, osal_nv_read
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 24, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 24, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrRestoreFromNV, osal_mem_alloc
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 20, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 20, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrRestoreFromNV, osal_nv_read
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 24, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 24, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrRestoreFromNV, osal_nv_read
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 24, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 24, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrRestoreFromNV, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 24, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 24, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrRestoreFromNV, osal_memset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 20, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 20, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrRestoreFromNV, osal_mem_free
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 20, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 20, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrRestoreFromNV, osal_nv_read
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 24, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 24, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x12
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V9 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V8 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V7 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 18)
        ; Saved register size: 18
        ; Auto size: 2
        MOV     A,#-0x2
        LCALL   ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 20)
// 2444   nvDeviceListHdr_t hdr;
// 2445   APSME_LinkKeyData_t *pApsLinkKey = NULL;
// 2446 
// 2447   if ((osal_nv_read(ZCD_NV_APS_LINK_KEY_TABLE, 0, sizeof(nvDeviceListHdr_t), &hdr) == ZSUCCESS) &&
// 2448       ((hdr.numRecs > 0) && (hdr.numRecs <= ZDSECMGR_ENTRY_MAX)))
        ; Setup parameters for call to function osal_nv_read
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     ?V0 + 0,DPL
        MOV     ?V0 + 1,DPH
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 22)
        MOV     ?V0 + 0,#0x2
        MOV     ?V0 + 1,#0x0
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 24)
        MOV     R4,#0x0
        MOV     R5,#0x0
        MOV     R2,#0x4c
        MOV     R3,#0x0
        LCALL   ??osal_nv_read?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 20)
        MOV     A,R1
        JZ      $+5
        LJMP    ??ZDSecMgrRestoreFromNV_0 & 0xFFFF
        LCALL   ?Subroutine23 & 0xFFFF
??CrossCallReturnLabel_162:
        JNZ     $+5
        LJMP    ??ZDSecMgrRestoreFromNV_0 & 0xFFFF
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        CLR     C
        MOVX    A,@DPTR
        SUBB    A,#0x4
        INC     DPTR
        MOVX    A,@DPTR
        SUBB    A,#0x0
        JC      $+5
        LJMP    ??ZDSecMgrRestoreFromNV_0 & 0xFFFF
// 2449   {
// 2450     uint8 x;
// 2451 
// 2452     pApsLinkKey = (APSME_LinkKeyData_t *)osal_mem_alloc(sizeof(APSME_LinkKeyData_t));
        ; Setup parameters for call to function osal_mem_alloc
        MOV     R2,#0x18
        MOV     R3,#0x0
        LCALL   ??osal_mem_alloc?relay
        MOV     ?V0 + 8,R2
        MOV     ?V0 + 9,R3
// 2453 
// 2454     for (x = 0; x < ZDSECMGR_ENTRY_MAX; x++)
        MOV     ?V0 + 0,#0x0
        MOV     A,R2
        ADD     A,#0x10
        MOV     ?V0 + 2,A
        MOV     A,R3
        ADDC    A,#0x0
        MOV     ?V0 + 3,A
// 2455     {
// 2456       if ( osal_nv_read( ZCD_NV_APS_LINK_KEY_TABLE,
// 2457                         (uint16)(sizeof(nvDeviceListHdr_t) + (x * sizeof(ZDSecMgrEntry_t))),
// 2458                         sizeof(ZDSecMgrEntry_t), &ZDSecMgrEntries[x] ) == SUCCESS )
??ZDSecMgrRestoreFromNV_1:
        MOV     A,?V0 + 0
        MOV     B,#0x5
        MUL     AB
        MOV     R6,A
        MOV     R7,B
        ; Setup parameters for call to function osal_nv_read
        MOV     DPTR,#ZDSecMgrEntries
        MOVX    A,@DPTR
        ADD     A,R6
        MOV     ?V0 + 4,A
        INC     DPTR
        MOVX    A,@DPTR
        ADDC    A,R7
        MOV     ?V0 + 5,A
        MOV     R0,#?V0 + 4
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 22)
        MOV     ?V0 + 4,#0x5
        MOV     ?V0 + 5,#0x0
        MOV     R0,#?V0 + 4
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 24)
        MOV     A,?V0 + 0
        MOV     B,#0x5
        MUL     AB
        ADD     A,#0x2
        MOV     R4,A
        MOV     A,B
        LCALL   ?Subroutine50 & 0xFFFF
??CrossCallReturnLabel_64:
        LCALL   ??osal_nv_read?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 20)
        MOV     A,R1
        JZ      $+5
        LJMP    ??ZDSecMgrRestoreFromNV_2 & 0xFFFF
// 2459       {
// 2460         // update data only for valid entries
// 2461         if ( ZDSecMgrEntries[x].ami != INVALID_NODE_ADDR )
        MOV     DPTR,#ZDSecMgrEntries
        MOVX    A,@DPTR
        ADD     A,R6
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        ADDC    A,R7
        MOV     R1,A
        MOV     A,R0
        MOV     R2,A
        MOV     A,R1
        MOV     R3,A
        MOV     DPL,R2
        MOV     DPH,R3
        MOVX    A,@DPTR
        XRL     A,#0xfe
        JNZ     ??ZDSecMgrRestoreFromNV_3
        INC     DPTR
        MOVX    A,@DPTR
        CPL     A
??ZDSecMgrRestoreFromNV_3:
        JNZ     $+5
        LJMP    ??ZDSecMgrRestoreFromNV_2 & 0xFFFF
// 2462         {
// 2463           if (pApsLinkKey != NULL)
        MOV     A,?V0 + 8
        ORL     A,?V0 + 9
        JNZ     $+5
        LJMP    ??ZDSecMgrRestoreFromNV_2 & 0xFFFF
// 2464           {
// 2465             // read the key form NV, keyNvId must be ZCD_NV_APS_LINK_KEY_DATA_START based
// 2466             osal_nv_read( ZDSecMgrEntries[x].keyNvId, 0,
// 2467                          sizeof(APSME_LinkKeyData_t), pApsLinkKey );
        ; Setup parameters for call to function osal_nv_read
        MOV     R0,#?V0 + 8
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 22)
        MOV     ?V0 + 4,#0x18
        MOV     R0,#?V0 + 4
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 24)
        MOV     R4,#0x0
        MOV     R5,#0x0
        MOV     DPL,R2
        MOV     DPH,R3
        LCALL   ??Subroutine58_0 & 0xFFFF
??CrossCallReturnLabel_107:
        LCALL   ??osal_nv_read?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 20)
// 2468 
// 2469             // set new values for the counter
// 2470             pApsLinkKey->txFrmCntr += ( MAX_APS_FRAMECOUNTER_CHANGES + 1 );
        MOV     DPTR,#__Constant_3e9
        MOV     R0,#?V0 + 4
        LCALL   ?L_MOV_X
        MOV     DPL,?V0 + 2
        MOV     DPH,?V0 + 3
        MOV     R0,#?V0 + 4
        LCALL   ?L_ADD_TO_X
        LCALL   ?Subroutine28 & 0xFFFF
??CrossCallReturnLabel_23:
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R6,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R7,A
        MOV     A,R6
        MOV     R0,A
        MOV     A,R7
        MOV     R1,A
        MOV     A,R0
        MOV     B,#0x9
        MUL     AB
        MOV     R0,A
        MOV     R2,B
        MOV     B,#0x9
        MOV     A,R1
        MUL     AB
        ADD     A,R2
        MOV     R1,A
        MOV     A,#ApsLinkKeyFrmCntr & 0xff
        ADD     A,R0
        MOV     R0,A
        MOV     A,#(ApsLinkKeyFrmCntr >> 8) & 0xff
        ADDC    A,R1
        MOV     R1,A
        MOV     DPL,?V0 + 2
        MOV     DPH,?V0 + 3
        LCALL   ?XLOAD_R2345
        MOV     A,R0
        ADD     A,#-0x9
        MOV     DPL,A
        MOV     A,R1
        ADDC    A,#-0x13
        MOV     DPH,A
        LCALL   ?XSTORE_R2345
// 2471 
// 2472             // restore values for counters in RAM
// 2473             ApsLinkKeyFrmCntr[ZDSecMgrEntries[x].keyNvId - ZCD_NV_APS_LINK_KEY_DATA_START].txFrmCntr =
// 2474                                             pApsLinkKey->txFrmCntr;
// 2475 
// 2476             ApsLinkKeyFrmCntr[ZDSecMgrEntries[x].keyNvId - ZCD_NV_APS_LINK_KEY_DATA_START].rxFrmCntr =
// 2477                                             pApsLinkKey->rxFrmCntr;
        MOV     A,?V0 + 8
        ADD     A,#0x14
        MOV     DPL,A
        MOV     A,?V0 + 9
        LCALL   ??Subroutine71_0 & 0xFFFF
??CrossCallReturnLabel_183:
        LCALL   ?XLOAD_R2345
        MOV     A,R0
        ADD     A,#-0x5
        MOV     DPL,A
        MOV     A,R1
        ADDC    A,#-0x13
        MOV     DPH,A
        LCALL   ?XSTORE_R2345
// 2478 
// 2479             osal_nv_write( ZDSecMgrEntries[x].keyNvId, 0,
// 2480                           sizeof(APSME_LinkKeyData_t), pApsLinkKey );
        ; Setup parameters for call to function osal_nv_write
        MOV     R0,#?V0 + 8
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 22)
        MOV     ?V0 + 4,#0x18
        MOV     ?V0 + 5,#0x0
        MOV     R0,#?V0 + 4
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 24)
        MOV     R4,#0x0
        MOV     R5,#0x0
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        LCALL   ??osal_nv_write?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 20)
// 2481 
// 2482             // clear copy of key in RAM
// 2483             osal_memset(pApsLinkKey, 0x00, sizeof(APSME_LinkKeyData_t));
        ; Setup parameters for call to function osal_memset
        MOV     R4,#0x18
        MOV     R5,#0x0
        MOV     R1,#0x0
        MOV     R2,?V0 + 8
        MOV     R3,?V0 + 9
        LCALL   ??osal_memset?relay
// 2484           }
// 2485         }
// 2486       }
// 2487     }
??ZDSecMgrRestoreFromNV_2:
        INC     ?V0 + 0
        MOV     A,?V0 + 0
        CLR     C
        SUBB    A,#0x3
        JNC     $+5
        LJMP    ??ZDSecMgrRestoreFromNV_1 & 0xFFFF
// 2488 
// 2489     if (pApsLinkKey != NULL)
        MOV     A,?V0 + 8
        ORL     A,?V0 + 9
        JZ      ??ZDSecMgrRestoreFromNV_0
// 2490     {
// 2491       osal_mem_free(pApsLinkKey);
        ; Setup parameters for call to function osal_mem_free
        MOV     R2,?V0 + 8
        MOV     R3,?V0 + 9
        LCALL   ??osal_mem_free?relay
// 2492     }
// 2493   }
// 2494 
// 2495   osal_nv_read( ZCD_NV_TRUSTCENTER_ADDR, 0, Z_EXTADDR_LEN, zgApsTrustCenterAddr );
??ZDSecMgrRestoreFromNV_0:
        ; Setup parameters for call to function osal_nv_read
        MOV     ?V0 + 0,#zgApsTrustCenterAddr & 0xff
        MOV     ?V0 + 1,#(zgApsTrustCenterAddr >> 8) & 0xff
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 22)
        MOV     ?V0 + 0,#0x8
        MOV     ?V0 + 1,#0x0
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 24)
        MOV     R4,#0x0
        MOV     R5,#0x0
        MOV     R2,#0x71
        MOV     R3,#0x0
        LCALL   ??osal_nv_read?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 20)
// 2496 }
        MOV     A,#0x2
        LJMP    ?Subroutine6 & 0xFFFF
          CFI EndBlock cfiBlock325

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine28:
          CFI Block cfiCond326 Using cfiCommon0
          CFI Function ZDSecMgrEntryFree
          CFI Conditional ??CrossCallReturnLabel_22
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V7 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 20)
          CFI Block cfiCond327 Using cfiCommon0
          CFI (cfiCond327) Function ZDSecMgrRestoreFromNV
          CFI (cfiCond327) Conditional ??CrossCallReturnLabel_23
          CFI (cfiCond327) R6 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI (cfiCond327) VB load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI (cfiCond327) V0 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI (cfiCond327) V1 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond327) V2 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond327) V3 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond327) V4 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond327) V5 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond327) V6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond327) V7 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond327) V8 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond327) V9 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond327) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond327) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond327) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond327) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond327) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond327) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond327) CFA_SP SP+0
          CFI (cfiCond327) CFA_XSP16 add(XSP16, 20)
          CFI Block cfiPicker328 Using cfiCommon1
          CFI (cfiPicker328) NoFunction
          CFI (cfiPicker328) Picker
        MOV     DPTR,#ZDSecMgrEntries
        MOVX    A,@DPTR
        ADD     A,R6
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        ADDC    A,R7
        MOV     DPL,R0
        MOV     DPH,A
        RET
          CFI EndBlock cfiCond326
          CFI EndBlock cfiCond327
          CFI EndBlock cfiPicker328
// 2497 #endif // NV_RESTORE
// 2498 
// 2499 /*********************************************************************
// 2500  * @fn          ZDSecMgrSetDefaultNV
// 2501  *
// 2502  * @brief       Write the defaults to NV for Entry table and for APS key data table
// 2503  *
// 2504  * @param       none
// 2505  *
// 2506  * @return      none
// 2507  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 2508 void ZDSecMgrSetDefaultNV( void )
ZDSecMgrSetDefaultNV:
          CFI Block cfiBlock329 Using cfiCommon0
          CFI Function ZDSecMgrSetDefaultNV
        CODE
// 2509 {
        FUNCALL ZDSecMgrSetDefaultNV, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 23, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 23, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrSetDefaultNV, osal_memset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 19, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 19, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrSetDefaultNV, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 23, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 23, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrSetDefaultNV, osal_mem_alloc
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 19, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 19, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrSetDefaultNV, osal_memset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 19, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 19, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrSetDefaultNV, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 23, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 23, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrSetDefaultNV, osal_mem_free
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 19, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 19, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0xc
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 12)
        ; Saved register size: 12
        ; Auto size: 7
        MOV     A,#-0x7
        LCALL   ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 19)
// 2510   uint16 i;
// 2511   nvDeviceListHdr_t hdr;
// 2512   ZDSecMgrEntry_t secMgrEntry;
// 2513   APSME_LinkKeyData_t *pApsLinkKey = NULL;
// 2514 
// 2515   // Initialize the header
// 2516   hdr.numRecs = 0;
        LCALL   ?Subroutine15 & 0xFFFF
// 2517 
// 2518   // clear the header
// 2519   osal_nv_write(ZCD_NV_APS_LINK_KEY_TABLE, 0, sizeof(nvDeviceListHdr_t), &hdr);
??CrossCallReturnLabel_3:
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 21)
        MOV     ?V0 + 0,#0x2
        MOV     ?V0 + 1,#0x0
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 23)
        MOV     R4,#0x0
        MOV     R5,#0x0
        MOV     R2,#0x4c
        MOV     R3,#0x0
        LCALL   ??osal_nv_write?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 19)
// 2520 
// 2521   osal_memset( &secMgrEntry, 0x00, sizeof(ZDSecMgrEntry_t) );
        ; Setup parameters for call to function osal_memset
        MOV     R4,#0x5
        MOV     R5,#0x0
        MOV     R1,#0x0
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??osal_memset?relay
// 2522 
// 2523   for ( i = 0; i < ZDSECMGR_ENTRY_MAX; i++ )
        MOV     R6,#0x0
        MOV     R7,#0x0
// 2524   {
// 2525     // Clear the record
// 2526     osal_nv_write( ZCD_NV_APS_LINK_KEY_TABLE,
// 2527                 (uint16)((sizeof(nvDeviceListHdr_t)) + (i * sizeof(ZDSecMgrEntry_t))),
// 2528                         sizeof(ZDSecMgrEntry_t), &secMgrEntry );
??ZDSecMgrSetDefaultNV_0:
        ; Setup parameters for call to function osal_nv_write
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        MOV     ?V0 + 0,DPL
        MOV     ?V0 + 1,DPH
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 21)
        MOV     ?V0 + 0,#0x5
        MOV     ?V0 + 1,#0x0
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 23)
        LCALL   ?Subroutine34 & 0xFFFF
// 2529   }
??CrossCallReturnLabel_39:
        LCALL   ??osal_nv_write?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 19)
        LCALL   ?Subroutine33 & 0xFFFF
??CrossCallReturnLabel_35:
        JC      ??ZDSecMgrSetDefaultNV_0
// 2530 
// 2531   pApsLinkKey = (APSME_LinkKeyData_t *)osal_mem_alloc(sizeof(APSME_LinkKeyData_t));
        ; Setup parameters for call to function osal_mem_alloc
        MOV     R2,#0x18
        MOV     R3,#0x0
        LCALL   ??osal_mem_alloc?relay
        MOV     ?V0 + 0,R2
        MOV     ?V0 + 1,R3
// 2532 
// 2533   if (pApsLinkKey != NULL)
        MOV     A,R2
        ORL     A,?V0 + 1
        JZ      ??ZDSecMgrSetDefaultNV_1
// 2534   {
// 2535     osal_memset( pApsLinkKey, 0x00, sizeof(APSME_LinkKeyData_t) );
        ; Setup parameters for call to function osal_memset
        MOV     R4,#0x18
        MOV     R5,#0x0
        MOV     R1,#0x0
        LCALL   ??osal_memset?relay
// 2536 
// 2537     for ( i = 0; i < ZDSECMGR_ENTRY_MAX; i++ )
        MOV     R6,#0x0
        MOV     R7,#0x0
// 2538     {
// 2539       // Clear the record
// 2540       osal_nv_write( (ZCD_NV_APS_LINK_KEY_DATA_START + i), 0,
// 2541                     sizeof(APSME_LinkKeyData_t), pApsLinkKey);
??ZDSecMgrSetDefaultNV_2:
        ; Setup parameters for call to function osal_nv_write
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 21)
        MOV     ?V0 + 2,#0x18
        MOV     ?V0 + 3,#0x0
        MOV     R0,#?V0 + 2
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 23)
        MOV     R4,#0x0
        MOV     R5,#0x0
        MOV     A,R6
        ADD     A,#0x1
        MOV     R2,A
        MOV     A,R7
        ADDC    A,#0x2
        MOV     R3,A
        LCALL   ??osal_nv_write?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 19)
// 2542     }
        LCALL   ?Subroutine33 & 0xFFFF
??CrossCallReturnLabel_36:
        JC      ??ZDSecMgrSetDefaultNV_2
// 2543 
// 2544     osal_mem_free(pApsLinkKey);
        ; Setup parameters for call to function osal_mem_free
        MOV     R2,?V0 + 0
        MOV     R3,?V0 + 1
        LCALL   ??osal_mem_free?relay
// 2545   }
// 2546 }
??ZDSecMgrSetDefaultNV_1:
        MOV     A,#0x7
        LJMP    ?Subroutine3 & 0xFFFF
          CFI EndBlock cfiBlock329

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine34:
          CFI Block cfiCond330 Using cfiCommon0
          CFI Function ZDSecMgrWriteNV
          CFI Conditional ??CrossCallReturnLabel_38
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 18)
          CFI Block cfiCond331 Using cfiCommon0
          CFI (cfiCond331) Function ZDSecMgrSetDefaultNV
          CFI (cfiCond331) Conditional ??CrossCallReturnLabel_39
          CFI (cfiCond331) R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond331) VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond331) V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond331) V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond331) V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond331) V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond331) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond331) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond331) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond331) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond331) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond331) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond331) CFA_SP SP+0
          CFI (cfiCond331) CFA_XSP16 add(XSP16, 23)
          CFI Block cfiPicker332 Using cfiCommon1
          CFI (cfiPicker332) NoFunction
          CFI (cfiPicker332) Picker
        MOV     A,R6
        MOV     R0,A
        MOV     A,R7
        MOV     R1,A
        MOV     A,R0
        MOV     B,#0x5
        MUL     AB
        MOV     R0,A
        MOV     R2,B
        MOV     B,#0x5
        MOV     A,R1
        MUL     AB
        ADD     A,R2
        MOV     R1,A
        MOV     A,R0
        ADD     A,#0x2
        MOV     R4,A
        MOV     A,R1
        LCALL   ?Subroutine50 & 0xFFFF
??CrossCallReturnLabel_65:
        RET
          CFI EndBlock cfiCond330
          CFI EndBlock cfiCond331
          CFI EndBlock cfiPicker332

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine50:
          CFI Block cfiCond333 Using cfiCommon0
          CFI Function ZDSecMgrEntryFree
          CFI Conditional ??CrossCallReturnLabel_63
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V7 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 24)
          CFI Block cfiCond334 Using cfiCommon0
          CFI (cfiCond334) Function ZDSecMgrRestoreFromNV
          CFI (cfiCond334) Conditional ??CrossCallReturnLabel_64
          CFI (cfiCond334) R6 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI (cfiCond334) VB load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI (cfiCond334) V0 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI (cfiCond334) V1 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond334) V2 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond334) V3 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond334) V4 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond334) V5 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond334) V6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond334) V7 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond334) V8 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond334) V9 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond334) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond334) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond334) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond334) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond334) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond334) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond334) CFA_SP SP+0
          CFI (cfiCond334) CFA_XSP16 add(XSP16, 24)
          CFI Block cfiCond335 Using cfiCommon0
          CFI (cfiCond335) Function ZDSecMgrWriteNV
          CFI (cfiCond335) Conditional ??CrossCallReturnLabel_65, ??CrossCallReturnLabel_38
          CFI (cfiCond335) R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond335) VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond335) V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond335) V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond335) V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond335) V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond335) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond335) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond335) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond335) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond335) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond335) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond335) CFA_SP SP+0
          CFI (cfiCond335) CFA_XSP16 add(XSP16, 18)
          CFI Block cfiCond336 Using cfiCommon0
          CFI (cfiCond336) Function ZDSecMgrSetDefaultNV
          CFI (cfiCond336) Conditional ??CrossCallReturnLabel_65, ??CrossCallReturnLabel_39
          CFI (cfiCond336) R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond336) VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond336) V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond336) V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond336) V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond336) V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond336) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond336) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond336) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond336) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond336) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond336) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond336) CFA_SP SP+0
          CFI (cfiCond336) CFA_XSP16 add(XSP16, 23)
          CFI Block cfiPicker337 Using cfiCommon1
          CFI (cfiPicker337) NoFunction
          CFI (cfiPicker337) Picker
        ADDC    A,#0x0
        MOV     R5,A
        MOV     R2,#0x4c
        MOV     R3,#0x0
        RET
          CFI EndBlock cfiCond333
          CFI EndBlock cfiCond334
          CFI EndBlock cfiCond335
          CFI EndBlock cfiCond336
          CFI EndBlock cfiPicker337

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine33:
          CFI Block cfiCond338 Using cfiCommon0
          CFI Function ZDSecMgrWriteNV
          CFI Conditional ??CrossCallReturnLabel_34
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 14)
          CFI Block cfiCond339 Using cfiCommon0
          CFI (cfiCond339) Function ZDSecMgrSetDefaultNV
          CFI (cfiCond339) Conditional ??CrossCallReturnLabel_35
          CFI (cfiCond339) R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond339) VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond339) V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond339) V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond339) V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond339) V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond339) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond339) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond339) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond339) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond339) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond339) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond339) CFA_SP SP+0
          CFI (cfiCond339) CFA_XSP16 add(XSP16, 19)
          CFI Block cfiCond340 Using cfiCommon0
          CFI (cfiCond340) Function ZDSecMgrSetDefaultNV
          CFI (cfiCond340) Conditional ??CrossCallReturnLabel_36
          CFI (cfiCond340) R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond340) VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond340) V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond340) V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond340) V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond340) V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond340) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond340) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond340) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond340) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond340) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond340) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond340) CFA_SP SP+0
          CFI (cfiCond340) CFA_XSP16 add(XSP16, 19)
          CFI Block cfiCond341 Using cfiCommon0
          CFI (cfiCond341) Function ZDSecMgrSaveApsLinkKey
          CFI (cfiCond341) Conditional ??CrossCallReturnLabel_37
          CFI (cfiCond341) R6 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI (cfiCond341) VB load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI (cfiCond341) V0 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI (cfiCond341) V1 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond341) V2 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond341) V3 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond341) V4 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond341) V5 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond341) V6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond341) V7 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond341) V8 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond341) V9 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond341) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond341) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond341) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond341) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond341) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond341) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond341) CFA_SP SP+0
          CFI (cfiCond341) CFA_XSP16 add(XSP16, 18)
          CFI Block cfiPicker342 Using cfiCommon1
          CFI (cfiPicker342) NoFunction
          CFI (cfiPicker342) Picker
        LCALL   ?Subroutine51 & 0xFFFF
??CrossCallReturnLabel_66:
        SUBB    A,#0x3
        MOV     A,R7
        SUBB    A,#0x0
        RET
          CFI EndBlock cfiCond338
          CFI EndBlock cfiCond339
          CFI EndBlock cfiCond340
          CFI EndBlock cfiCond341
          CFI EndBlock cfiPicker342

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine15:
          CFI Block cfiCond343 Using cfiCommon0
          CFI Function ZDSecMgrInitNV
          CFI Conditional ??CrossCallReturnLabel_2
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 12)
          CFI Block cfiCond344 Using cfiCommon0
          CFI (cfiCond344) Function ZDSecMgrSetDefaultNV
          CFI (cfiCond344) Conditional ??CrossCallReturnLabel_3
          CFI (cfiCond344) R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond344) VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond344) V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond344) V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond344) V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond344) V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond344) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond344) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond344) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond344) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond344) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond344) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond344) CFA_SP SP+0
          CFI (cfiCond344) CFA_XSP16 add(XSP16, 19)
          CFI Block cfiPicker345 Using cfiCommon1
          CFI (cfiPicker345) NoFunction
          CFI (cfiPicker345) Picker
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        CLR     A
        MOVX    @DPTR,A
        INC     DPTR
        MOVX    @DPTR,A
        ; Setup parameters for call to function osal_nv_write
        ; Setup parameters for call to function osal_nv_write
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     ?V0 + 0,DPL
        MOV     ?V0 + 1,DPH
        MOV     R0,#?V0 + 0
        RET
          CFI EndBlock cfiCond343
          CFI EndBlock cfiCond344
          CFI EndBlock cfiPicker345
// 2547 
// 2548 #if defined ( NV_RESTORE )
// 2549 /*********************************************************************
// 2550  * @fn      ZDSecMgrUpdateNV()
// 2551  *
// 2552  * @brief   Updates one entry of the APS link key table to NV
// 2553  *
// 2554  * @param   index - to the entry in security manager table
// 2555  *
// 2556  * @return  none
// 2557  */
// 2558 static void ZDSecMgrUpdateNV( uint16 index )
// 2559 {
// 2560   nvDeviceListHdr_t hdr;
// 2561 
// 2562   if (ZDSecMgrEntries != NULL)
// 2563   {
// 2564     // Save off the record
// 2565     osal_nv_write( ZCD_NV_APS_LINK_KEY_TABLE,
// 2566                    (uint16)((sizeof(nvDeviceListHdr_t)) + (index * sizeof(ZDSecMgrEntry_t))),
// 2567                    sizeof(ZDSecMgrEntry_t), &ZDSecMgrEntries[index] );
// 2568   }
// 2569 
// 2570   if (osal_nv_read(ZCD_NV_APS_LINK_KEY_TABLE, 0, sizeof(nvDeviceListHdr_t), &hdr) == ZSUCCESS)
// 2571   {
// 2572     if ( ZDSecMgrEntries[index].ami == INVALID_NODE_ADDR )
// 2573     {
// 2574       if (hdr.numRecs > 0)
// 2575       {
// 2576         hdr.numRecs--;
// 2577       }
// 2578     }
// 2579     else
// 2580     {
// 2581       hdr.numRecs++;
// 2582     }
// 2583 
// 2584     // Save off the header
// 2585     osal_nv_write( ZCD_NV_APS_LINK_KEY_TABLE, 0, sizeof( nvDeviceListHdr_t ), &hdr );
// 2586   }
// 2587 }
// 2588 #endif // NV_RESTORE
// 2589 
// 2590 /******************************************************************************
// 2591  * @fn          ZDSecMgrAPSRemove
// 2592  *
// 2593  * @brief       Remove device from network.
// 2594  *
// 2595  * @param       nwkAddr - device's NWK address
// 2596  * @param       extAddr - device's Extended address
// 2597  * @param       parentAddr - parent's NWK address
// 2598  *
// 2599  * @return      ZStatus_t
// 2600  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 2601 ZStatus_t ZDSecMgrAPSRemove( uint16 nwkAddr, uint8 *extAddr, uint16 parentAddr )
ZDSecMgrAPSRemove:
          CFI Block cfiBlock346 Using cfiCommon0
          CFI Function ZDSecMgrAPSRemove
        CODE
// 2602 {
        FUNCALL ZDSecMgrAPSRemove, ZDSecMgrDeviceRemove
        LOCFRAME ISTACK, 2, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 8, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 8, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        PUSH    DPL
          CFI DPL0 Frame(CFA_SP, 4)
          CFI CFA_SP SP+-4
        PUSH    DPH
          CFI DPH0 Frame(CFA_SP, 5)
          CFI CFA_SP SP+-5
        ; Saved register size: 2
        ; Auto size: 8
        MOV     A,#-0x8
        LCALL   ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 8)
// 2603   ZDSecMgrDevice_t device;
// 2604 
// 2605   if ( ( nwkAddr == INVALID_NODE_ADDR ) ||
// 2606        ( extAddr == NULL )              ||
// 2607        ( parentAddr == INVALID_NODE_ADDR ) )
        MOV     A,#-0x2
        XRL     A,R2
        JNZ     ??ZDSecMgrAPSRemove_0
        MOV     A,#-0x1
        XRL     A,R3
??ZDSecMgrAPSRemove_0:
        JZ      ??ZDSecMgrAPSRemove_1
        MOV     A,R4
        ORL     A,R5
        JZ      ??ZDSecMgrAPSRemove_1
        MOV     A,#0x8
        LCALL   ?XSTACK_DISP0_8
        LCALL   ??Subroutine70_0 & 0xFFFF
??CrossCallReturnLabel_171:
        MOV     A,#-0x2
        XRL     A,R0
        JNZ     ??ZDSecMgrAPSRemove_2
        MOV     A,#-0x1
        XRL     A,R1
??ZDSecMgrAPSRemove_2:
        JNZ     ??ZDSecMgrAPSRemove_3
// 2608   {
// 2609     return ( ZFailure );
??ZDSecMgrAPSRemove_1:
        MOV     R1,#0x1
        SJMP    ??ZDSecMgrAPSRemove_4
// 2610   }
// 2611 
// 2612   device.nwkAddr = nwkAddr;
??ZDSecMgrAPSRemove_3:
        LCALL   ?Subroutine21 & 0xFFFF
// 2613   device.extAddr = extAddr;
??CrossCallReturnLabel_87:
        LCALL   ?XSTACK_DISP0_8
        MOV     A,R4
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R5
        MOVX    @DPTR,A
// 2614   device.parentAddr = parentAddr;
        MOV     A,#0x4
        LCALL   ?XSTACK_DISP0_8
        MOV     A,R0
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R1
        LCALL   ??Subroutine64_0 & 0xFFFF
// 2615 
// 2616   // remove device
// 2617   ZDSecMgrDeviceRemove( &device );
??CrossCallReturnLabel_146:
        LCALL   ??ZDSecMgrDeviceRemove?relay
// 2618 
// 2619   return ( ZSuccess );
        MOV     R1,#0x0
??ZDSecMgrAPSRemove_4:
        LJMP    ?Subroutine4 & 0xFFFF
          CFI EndBlock cfiBlock346
// 2620 }

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine30:
          CFI Block cfiCond347 Using cfiCommon0
          CFI Function ZDSecMgrAddrClear
          CFI Conditional ??CrossCallReturnLabel_172
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 24)
          CFI Block cfiCond348 Using cfiCommon0
          CFI (cfiCond348) Function ZDSecMgrAppKeyReq
          CFI (cfiCond348) Conditional ??CrossCallReturnLabel_173
          CFI (cfiCond348) R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond348) VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond348) V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond348) V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond348) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond348) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond348) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond348) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond348) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond348) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond348) CFA_SP SP+0
          CFI (cfiCond348) CFA_XSP16 add(XSP16, 49)
          CFI Block cfiPicker349 Using cfiCommon1
          CFI (cfiPicker349) NoFunction
          CFI (cfiPicker349) Picker
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
          CFI EndBlock cfiCond347
          CFI EndBlock cfiCond348
          CFI EndBlock cfiPicker349
        REQUIRE ??Subroutine70_0
        ; // Fall through to label ??Subroutine70_0

        RSEG BANKED_CODE:CODE:NOROOT(0)
??Subroutine70_0:
          CFI Block cfiCond350 Using cfiCommon0
          CFI Function ZDSecMgrSendNwkKey
          CFI Conditional ??CrossCallReturnLabel_167
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 46)
          CFI Block cfiCond351 Using cfiCommon0
          CFI (cfiCond351) Function ZDSecMgrSendNwkKey
          CFI (cfiCond351) Conditional ??CrossCallReturnLabel_168
          CFI (cfiCond351) R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond351) VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond351) V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond351) V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond351) V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond351) V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond351) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond351) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond351) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond351) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond351) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond351) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond351) CFA_SP SP+0
          CFI (cfiCond351) CFA_XSP16 add(XSP16, 46)
          CFI Block cfiCond352 Using cfiCommon0
          CFI (cfiCond352) Function ZDSecMgrDeviceJoinFwd
          CFI (cfiCond352) Conditional ??CrossCallReturnLabel_169
          CFI (cfiCond352) DPL0 Frame(CFA_SP, 4)
          CFI (cfiCond352) DPH0 Frame(CFA_SP, 5)
          CFI (cfiCond352) CFA_SP SP+-5
          CFI (cfiCond352) CFA_XSP16 add(XSP16, 8)
          CFI Block cfiCond353 Using cfiCommon0
          CFI (cfiCond353) Function ZDSecMgrNewDeviceEvent
          CFI (cfiCond353) Conditional ??CrossCallReturnLabel_170
          CFI (cfiCond353) R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond353) VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond353) V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond353) V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond353) V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond353) V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond353) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond353) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond353) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond353) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond353) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond353) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond353) CFA_SP SP+0
          CFI (cfiCond353) CFA_XSP16 add(XSP16, 33)
          CFI Block cfiCond354 Using cfiCommon0
          CFI (cfiCond354) Function ZDSecMgrAPSRemove
          CFI (cfiCond354) Conditional ??CrossCallReturnLabel_171
          CFI (cfiCond354) DPL0 Frame(CFA_SP, 4)
          CFI (cfiCond354) DPH0 Frame(CFA_SP, 5)
          CFI (cfiCond354) CFA_SP SP+-5
          CFI (cfiCond354) CFA_XSP16 add(XSP16, 8)
          CFI Block cfiCond355 Using cfiCommon0
          CFI (cfiCond355) Function ZDSecMgrAddrClear
          CFI (cfiCond355) Conditional ??CrossCallReturnLabel_172
          CFI (cfiCond355) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond355) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond355) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond355) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond355) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond355) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond355) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond355) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond355) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond355) CFA_SP SP+0
          CFI (cfiCond355) CFA_XSP16 add(XSP16, 24)
          CFI Block cfiCond356 Using cfiCommon0
          CFI (cfiCond356) Function ZDSecMgrAppKeyReq
          CFI (cfiCond356) Conditional ??CrossCallReturnLabel_173
          CFI (cfiCond356) R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond356) VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond356) V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond356) V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond356) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond356) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond356) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond356) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond356) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond356) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond356) CFA_SP SP+0
          CFI (cfiCond356) CFA_XSP16 add(XSP16, 49)
          CFI Block cfiPicker357 Using cfiCommon1
          CFI (cfiPicker357) NoFunction
          CFI (cfiPicker357) Picker
        LCALL   ?Subroutine46 & 0xFFFF
??CrossCallReturnLabel_178:
        RET
          CFI EndBlock cfiCond350
          CFI EndBlock cfiCond351
          CFI EndBlock cfiCond352
          CFI EndBlock cfiCond353
          CFI EndBlock cfiCond354
          CFI EndBlock cfiCond355
          CFI EndBlock cfiCond356
          CFI EndBlock cfiPicker357

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine46:
          CFI Block cfiCond358 Using cfiCommon0
          CFI Function ZDSecMgrAddrStore
          CFI Conditional ??CrossCallReturnLabel_177, ??CrossCallReturnLabel_11
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 22)
          CFI Block cfiCond359 Using cfiCommon0
          CFI (cfiCond359) Function ZDSecMgrExtAddrStore
          CFI (cfiCond359) Conditional ??CrossCallReturnLabel_177, ??CrossCallReturnLabel_12
          CFI (cfiCond359) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond359) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond359) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond359) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond359) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond359) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond359) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond359) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond359) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond359) CFA_SP SP+0
          CFI (cfiCond359) CFA_XSP16 add(XSP16, 22)
          CFI Block cfiCond360 Using cfiCommon0
          CFI (cfiCond360) Function ZDSecMgrExtAddrLookup
          CFI (cfiCond360) Conditional ??CrossCallReturnLabel_177, ??CrossCallReturnLabel_13
          CFI (cfiCond360) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond360) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond360) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond360) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond360) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond360) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond360) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond360) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond360) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond360) CFA_SP SP+0
          CFI (cfiCond360) CFA_XSP16 add(XSP16, 22)
          CFI Block cfiCond361 Using cfiCommon0
          CFI (cfiCond361) Function ZDSecMgrAppKeyReq
          CFI (cfiCond361) Conditional ??CrossCallReturnLabel_175, ??CrossCallReturnLabel_4
          CFI (cfiCond361) R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond361) VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond361) V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond361) V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond361) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond361) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond361) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond361) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond361) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond361) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond361) CFA_SP SP+0
          CFI (cfiCond361) CFA_XSP16 add(XSP16, 49)
          CFI Block cfiCond362 Using cfiCommon0
          CFI (cfiCond362) Function ZDSecMgrSendNwkKey
          CFI (cfiCond362) Conditional ??CrossCallReturnLabel_175, ??CrossCallReturnLabel_5
          CFI (cfiCond362) R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond362) VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond362) V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond362) V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond362) V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond362) V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond362) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond362) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond362) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond362) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond362) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond362) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond362) CFA_SP SP+0
          CFI (cfiCond362) CFA_XSP16 add(XSP16, 46)
          CFI Block cfiCond363 Using cfiCommon0
          CFI (cfiCond363) Function ZDSecMgrSendNwkKey
          CFI (cfiCond363) Conditional ??CrossCallReturnLabel_176, ??CrossCallReturnLabel_6
          CFI (cfiCond363) R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond363) VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond363) V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond363) V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond363) V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond363) V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond363) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond363) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond363) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond363) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond363) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond363) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond363) CFA_SP SP+0
          CFI (cfiCond363) CFA_XSP16 add(XSP16, 46)
          CFI Block cfiCond364 Using cfiCommon0
          CFI (cfiCond364) Function ZDSecMgrDeviceRemove
          CFI (cfiCond364) Conditional ??CrossCallReturnLabel_176, ??CrossCallReturnLabel_7
          CFI (cfiCond364) R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond364) VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond364) V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond364) V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond364) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond364) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond364) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond364) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond364) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond364) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond364) CFA_SP SP+0
          CFI (cfiCond364) CFA_XSP16 add(XSP16, 20)
          CFI Block cfiCond365 Using cfiCommon0
          CFI (cfiCond365) Function ZDSecMgrDeviceJoinFwd
          CFI (cfiCond365) Conditional ??CrossCallReturnLabel_174, ??CrossCallReturnLabel_0
          CFI (cfiCond365) DPL0 Frame(CFA_SP, 4)
          CFI (cfiCond365) DPH0 Frame(CFA_SP, 5)
          CFI (cfiCond365) CFA_SP SP+-5
          CFI (cfiCond365) CFA_XSP16 add(XSP16, 8)
          CFI Block cfiCond366 Using cfiCommon0
          CFI (cfiCond366) Function ZDSecMgrUpdateDeviceInd
          CFI (cfiCond366) Conditional ??CrossCallReturnLabel_174, ??CrossCallReturnLabel_1
          CFI (cfiCond366) DPL0 Frame(CFA_SP, 4)
          CFI (cfiCond366) DPH0 Frame(CFA_SP, 5)
          CFI (cfiCond366) CFA_SP SP+-5
          CFI (cfiCond366) CFA_XSP16 add(XSP16, 8)
          CFI Block cfiCond367 Using cfiCommon0
          CFI (cfiCond367) Function ZDSecMgrAddrClear
          CFI (cfiCond367) Conditional ??CrossCallReturnLabel_178, ??CrossCallReturnLabel_172
          CFI (cfiCond367) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond367) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond367) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond367) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond367) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond367) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond367) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond367) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond367) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond367) CFA_SP SP+0
          CFI (cfiCond367) CFA_XSP16 add(XSP16, 24)
          CFI Block cfiCond368 Using cfiCommon0
          CFI (cfiCond368) Function ZDSecMgrAppKeyReq
          CFI (cfiCond368) Conditional ??CrossCallReturnLabel_178, ??CrossCallReturnLabel_173
          CFI (cfiCond368) R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond368) VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond368) V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond368) V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond368) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond368) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond368) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond368) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond368) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond368) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond368) CFA_SP SP+0
          CFI (cfiCond368) CFA_XSP16 add(XSP16, 49)
          CFI Block cfiCond369 Using cfiCommon0
          CFI (cfiCond369) Function ZDSecMgrSendNwkKey
          CFI (cfiCond369) Conditional ??CrossCallReturnLabel_178, ??CrossCallReturnLabel_167
          CFI (cfiCond369) R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond369) VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond369) V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond369) V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond369) V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond369) V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond369) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond369) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond369) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond369) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond369) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond369) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond369) CFA_SP SP+0
          CFI (cfiCond369) CFA_XSP16 add(XSP16, 46)
          CFI Block cfiCond370 Using cfiCommon0
          CFI (cfiCond370) Function ZDSecMgrSendNwkKey
          CFI (cfiCond370) Conditional ??CrossCallReturnLabel_178, ??CrossCallReturnLabel_168
          CFI (cfiCond370) R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond370) VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond370) V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond370) V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond370) V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond370) V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond370) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond370) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond370) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond370) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond370) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond370) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond370) CFA_SP SP+0
          CFI (cfiCond370) CFA_XSP16 add(XSP16, 46)
          CFI Block cfiCond371 Using cfiCommon0
          CFI (cfiCond371) Function ZDSecMgrDeviceJoinFwd
          CFI (cfiCond371) Conditional ??CrossCallReturnLabel_178, ??CrossCallReturnLabel_169
          CFI (cfiCond371) DPL0 Frame(CFA_SP, 4)
          CFI (cfiCond371) DPH0 Frame(CFA_SP, 5)
          CFI (cfiCond371) CFA_SP SP+-5
          CFI (cfiCond371) CFA_XSP16 add(XSP16, 8)
          CFI Block cfiCond372 Using cfiCommon0
          CFI (cfiCond372) Function ZDSecMgrNewDeviceEvent
          CFI (cfiCond372) Conditional ??CrossCallReturnLabel_178, ??CrossCallReturnLabel_170
          CFI (cfiCond372) R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond372) VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond372) V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond372) V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond372) V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond372) V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond372) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond372) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond372) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond372) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond372) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond372) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond372) CFA_SP SP+0
          CFI (cfiCond372) CFA_XSP16 add(XSP16, 33)
          CFI Block cfiCond373 Using cfiCommon0
          CFI (cfiCond373) Function ZDSecMgrAPSRemove
          CFI (cfiCond373) Conditional ??CrossCallReturnLabel_178, ??CrossCallReturnLabel_171
          CFI (cfiCond373) DPL0 Frame(CFA_SP, 4)
          CFI (cfiCond373) DPH0 Frame(CFA_SP, 5)
          CFI (cfiCond373) CFA_SP SP+-5
          CFI (cfiCond373) CFA_XSP16 add(XSP16, 8)
          CFI Block cfiPicker374 Using cfiCommon1
          CFI (cfiPicker374) NoFunction
          CFI (cfiPicker374) Picker
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R1,A
        RET
          CFI EndBlock cfiCond358
          CFI EndBlock cfiCond359
          CFI EndBlock cfiCond360
          CFI EndBlock cfiCond361
          CFI EndBlock cfiCond362
          CFI EndBlock cfiCond363
          CFI EndBlock cfiCond364
          CFI EndBlock cfiCond365
          CFI EndBlock cfiCond366
          CFI EndBlock cfiCond367
          CFI EndBlock cfiCond368
          CFI EndBlock cfiCond369
          CFI EndBlock cfiCond370
          CFI EndBlock cfiCond371
          CFI EndBlock cfiCond372
          CFI EndBlock cfiCond373
          CFI EndBlock cfiPicker374
// 2621 
// 2622 /******************************************************************************
// 2623  * @fn          APSME_TCLinkKeyInit
// 2624  *
// 2625  * @brief       Initialize the NV table for preconfigured TC link key
// 2626  *
// 2627  *              When zgUseDefaultTCL is set to TRUE, the default preconfig
// 2628  *              Trust Center Link Key is written to NV. A single tclk is used
// 2629  *              by all devices joining the network.
// 2630  *
// 2631  * @param       setDefault - TRUE to set default values
// 2632  *
// 2633  * @return      none
// 2634  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 2635 void APSME_TCLinkKeyInit(uint8 setDefault)
APSME_TCLinkKeyInit:
          CFI Block cfiBlock375 Using cfiCommon0
          CFI Function APSME_TCLinkKeyInit
        CODE
// 2636 {
        FUNCALL APSME_TCLinkKeyInit, osal_memset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 48, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 48, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_TCLinkKeyInit, osal_memset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 48, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 48, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_TCLinkKeyInit, osal_memcpy
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 51, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 51, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_TCLinkKeyInit, osal_nv_item_init
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 50, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 50, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_TCLinkKeyInit, osal_nv_read
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 52, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 52, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_TCLinkKeyInit, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 52, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 52, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_TCLinkKeyInit, osal_memset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 48, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 48, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x10
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V7 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 16)
        ; Saved register size: 16
        ; Auto size: 32
        MOV     A,#-0x20
        LCALL   ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 48)
        MOV     ?V0 + 3,R1
// 2637   uint8             i;
// 2638   APSME_TCLinkKey_t tcLinkKey;
// 2639   uint8             rtrn;
// 2640 
// 2641   // Initialize all NV items for preconfigured TCLK
// 2642   for( i = 0; i < ZDSECMGR_TC_DEVICE_MAX; i++ )
        MOV     ?V0 + 2,#0x0
// 2643   {
// 2644     // Making sure data is cleared for every key all the time
// 2645     osal_memset( &tcLinkKey, 0x00, sizeof(APSME_TCLinkKey_t) );
??APSME_TCLinkKeyInit_0:
        ; Setup parameters for call to function osal_memset
        MOV     R4,#0x20
        MOV     R5,#0x0
        MOV     R1,#0x0
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??osal_memset?relay
// 2646 
// 2647     // Initialize first element of the table with the default TCLK
// 2648     if((i == 0) && ( zgUseDefaultTCLK == TRUE ))
        MOV     A,?V0 + 2
        JNZ     ??APSME_TCLinkKeyInit_1
        MOV     DPTR,#zgUseDefaultTCLK
        MOVX    A,@DPTR
        XRL     A,#0x1
        JNZ     ??APSME_TCLinkKeyInit_1
// 2649     {
// 2650       osal_memset( tcLinkKey.extAddr, 0xFF, Z_EXTADDR_LEN );
        ; Setup parameters for call to function osal_memset
        MOV     R4,#0x8
        MOV     R5,#0x0
        MOV     R1,#-0x1
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??osal_memset?relay
// 2651       osal_memcpy( tcLinkKey.key, defaultTCLinkKey, SEC_KEY_LEN);
        ; Setup parameters for call to function osal_memcpy
        MOV     ?V0 + 4,#defaultTCLinkKey & 0xff
        MOV     ?V0 + 5,#(defaultTCLinkKey >> 8) & 0xff
        MOV     ?V0 + 6,#-0x80
        MOV     R0,#?V0 + 4
        LCALL   ?PUSH_XSTACK_I_THREE
          CFI CFA_XSP16 add(XSP16, 51)
        MOV     R4,#0x10
        MOV     R5,#0x0
        MOV     A,#0xb
        LCALL   ?XSTACK_DISP0_8
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??osal_memcpy?relay
        MOV     A,#0x3
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 48)
// 2652     }
// 2653 
// 2654     // If the item doesn't exist in NV memory, create and initialize
// 2655     // it with the default value passed in, either defaultTCLK or 0
// 2656     rtrn = osal_nv_item_init( (ZCD_NV_TCLK_TABLE_START + i),
// 2657                                sizeof(APSME_TCLinkKey_t), &tcLinkKey);
// 2658 
// 2659     if (rtrn == SUCCESS)
??APSME_TCLinkKeyInit_1:
        MOV     DPL,?V0 + 2
        MOV     ?V0 + 0,DPL
        MOV     A,?V0 + 0
        ADD     A,#0x1
        MOV     R6,A
        CLR     A
        ADDC    A,#0x1
        MOV     R7,A
        ; Setup parameters for call to function osal_nv_item_init
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     ?V0 + 4,DPL
        MOV     ?V0 + 5,DPH
        MOV     R0,#?V0 + 4
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 50)
        MOV     R4,#0x20
        MOV     R5,#0x0
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        LCALL   ??osal_nv_item_init?relay
        MOV     A,#0x2
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 48)
        MOV     A,R1
        JZ      $+5
        LJMP    ??APSME_TCLinkKeyInit_2 & 0xFFFF
// 2660     {
// 2661       // set the Frame counters to 0 to existing keys in NV
// 2662       osal_nv_read( ( ZCD_NV_TCLK_TABLE_START + i), 0,
// 2663                      sizeof(APSME_TCLinkKey_t), &tcLinkKey );
        ; Setup parameters for call to function osal_nv_read
        MOV     R0,#?V0 + 4
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 50)
        MOV     ?V0 + 4,#0x20
        MOV     ?V0 + 5,#0x0
        MOV     R0,#?V0 + 4
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 52)
        MOV     R4,#0x0
        MOV     R5,#0x0
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        LCALL   ??osal_nv_read?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 48)
// 2664 
// 2665 #if defined ( NV_RESTORE )
// 2666       if (setDefault == TRUE)
        MOV     A,#0x1
        XRL     A,?V0 + 3
        JNZ     ??APSME_TCLinkKeyInit_3
// 2667       {
// 2668         // clear the value stored in NV
// 2669         tcLinkKey.txFrmCntr = 0;
        MOV     A,#0x18
        LCALL   ?XSTACK_DISP0_8
        LCALL   ??Subroutine66_0 & 0xFFFF
// 2670       }
??CrossCallReturnLabel_147:
        SJMP    ??APSME_TCLinkKeyInit_4
// 2671       else
// 2672       {
// 2673         // increase the value stored in NV
// 2674         tcLinkKey.txFrmCntr += ( MAX_TCLK_FRAMECOUNTER_CHANGES + 1 );
??APSME_TCLinkKeyInit_3:
        MOV     DPTR,#__Constant_b
        MOV     R0,#?V0 + 4
        LCALL   ?L_MOV_X
        MOV     A,#0x18
        LCALL   ?XSTACK_DISP0_8
        MOV     R0,#?V0 + 4
        LCALL   ?L_ADD_TO_X
// 2675       }
// 2676 #else
// 2677       // Clear the counters if NV_RESTORE is not enabled and this NV item
// 2678       // already existed in the NV memory
// 2679       tcLinkKey.txFrmCntr = 0;
// 2680       tcLinkKey.rxFrmCntr = 0;
// 2681 #endif  // NV_RESTORE
// 2682 
// 2683       osal_nv_write( ( ZCD_NV_TCLK_TABLE_START + i), 0,
// 2684                       sizeof(APSME_TCLinkKey_t), &tcLinkKey );
??APSME_TCLinkKeyInit_4:
        ; Setup parameters for call to function osal_nv_write
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     ?V0 + 4,DPL
        MOV     ?V0 + 5,DPH
        MOV     R0,#?V0 + 4
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 50)
        MOV     ?V0 + 4,#0x20
        MOV     ?V0 + 5,#0x0
        MOV     R0,#?V0 + 4
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 52)
        MOV     R4,#0x0
        MOV     R5,#0x0
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        LCALL   ??osal_nv_write?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 48)
// 2685 
// 2686       // set initial values for counters in RAM
// 2687       TCLinkKeyFrmCntr[i].txFrmCntr = tcLinkKey.txFrmCntr;
        MOV     A,?V0 + 0
        MOV     B,#0x9
        MUL     AB
        MOV     ?V0 + 0,A
        MOV     A,B
        MOV     ?V0 + 1,A
        MOV     A,#TCLinkKeyFrmCntr & 0xff
        ADD     A,?V0 + 0
        MOV     R0,A
        MOV     A,#(TCLinkKeyFrmCntr >> 8) & 0xff
        ADDC    A,?V0 + 1
        MOV     R1,A
        MOV     A,#0x18
        LCALL   ?XSTACK_DISP0_8
        LCALL   ?XLOAD_R2345
        MOV     DPL,R0
        MOV     DPH,R1
        LCALL   ?XSTORE_R2345
// 2688       TCLinkKeyFrmCntr[i].rxFrmCntr = tcLinkKey.rxFrmCntr;
        MOV     A,#0x1c
        LCALL   ?XSTACK_DISP0_8
        LCALL   ?XLOAD_R2345
        MOV     DPL,R0
        MOV     DPH,R1
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        LCALL   ?XSTORE_R2345
// 2689     }
// 2690   }
??APSME_TCLinkKeyInit_2:
        INC     ?V0 + 2
        MOV     A,R6
        CLR     C
        SUBB    A,#0x2
        JNC     $+5
        LJMP    ??APSME_TCLinkKeyInit_0 & 0xFFFF
// 2691 
// 2692   // clear copy of key in RAM
// 2693   osal_memset( &tcLinkKey, 0x00, sizeof(APSME_TCLinkKey_t) );
        ; Setup parameters for call to function osal_memset
        MOV     R4,#0x20
        MOV     R5,#0x0
        MOV     R1,#0x0
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??osal_memset?relay
// 2694 
// 2695 }
        MOV     A,#0x20
        LJMP    ?Subroutine2 & 0xFFFF
          CFI EndBlock cfiBlock375
// 2696 
// 2697 /******************************************************************************
// 2698  * @fn          APSME_TCLinkKeySync
// 2699  *
// 2700  * @brief       Sync Trust Center LINK key data.
// 2701  *
// 2702  * @param       srcAddr - [in] srcAddr
// 2703  * @param       si      - [in, out] SSP_Info_t
// 2704  *
// 2705  * @return      ZStatus_t
// 2706  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 2707 ZStatus_t APSME_TCLinkKeySync( uint16 srcAddr, SSP_Info_t* si )
APSME_TCLinkKeySync:
          CFI Block cfiBlock376 Using cfiCommon0
          CFI Function APSME_TCLinkKeySync
        CODE
// 2708 {
        FUNCALL APSME_TCLinkKeySync, AddrMgrExtAddrValid
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 50, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 50, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_TCLinkKeySync, APSME_LookupExtAddr
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 50, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 50, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_TCLinkKeySync, sAddrExtCmp
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 50, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 50, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_TCLinkKeySync, osal_nv_read
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 54, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 54, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_TCLinkKeySync, AddrMgrExtAddrEqual
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 50, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 50, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_TCLinkKeySync, APSME_IsDefaultTCLK
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 50, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 50, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_TCLinkKeySync, osal_memset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 50, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 50, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x12
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V9 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V8 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V7 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 18)
        ; Saved register size: 18
        ; Auto size: 32
        MOV     A,#-0x20
        LCALL   ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 50)
        MOV     ?V0 + 6,R2
        MOV     ?V0 + 7,R3
        MOV     ?V0 + 4,R4
        MOV     ?V0 + 5,R5
// 2709   uint8 i, selectedId = ZDSECMGR_TC_DEVICE_MAX;
        MOV     ?V0 + 1,#0x2
// 2710   ZStatus_t status = ZSecNoKey;
        MOV     ?V0 + 0,#-0x5f
// 2711   APSME_TCLinkKey_t tcLinkKey;
// 2712   uint32 *tclkRxFrmCntr;
// 2713   uint16 originatorAddr = APSME_TRUSTCENTER_NWKADDR;
        MOV     ?V0 + 2,#0x0
        MOV     ?V0 + 3,#0x0
// 2714 
// 2715   // Look up the IEEE address of the trust center if it's available
// 2716   if ( AddrMgrExtAddrValid( si->extAddr ) == FALSE )
        MOV     A,R4
        ADD     A,#0x6
        MOV     R6,A
        MOV     A,R5
        ADDC    A,#0x0
        MOV     R7,A
        ; Setup parameters for call to function AddrMgrExtAddrValid
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        LCALL   ??AddrMgrExtAddrValid?relay
        MOV     A,R1
        JNZ     ??APSME_TCLinkKeySync_0
// 2717   {
// 2718     APSME_LookupExtAddr( srcAddr, si->extAddr );
        ; Setup parameters for call to function APSME_LookupExtAddr
        MOV     A,R6
        MOV     R4,A
        MOV     A,R7
        MOV     R5,A
        MOV     R2,?V0 + 6
        MOV     R3,?V0 + 7
        LCALL   ??APSME_LookupExtAddr?relay
        SJMP    ??APSME_TCLinkKeySync_1
// 2719   }
// 2720   else if ( osal_ExtAddrEqual( si->extAddr, _NIB.nwkCoordExtAddress ) )
??APSME_TCLinkKeySync_0:
        ; Setup parameters for call to function sAddrExtCmp
        MOV     R4,#(_NIB + 25) & 0xff
        MOV     R5,#((_NIB + 25) >> 8) & 0xff
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        LCALL   ??sAddrExtCmp?relay
        MOV     A,R1
        JZ      ??APSME_TCLinkKeySync_1
// 2721   {
// 2722     originatorAddr = _NIB.nwkCoordAddress;
        MOV     DPTR,#_NIB + 23
        MOVX    A,@DPTR
        MOV     ?V0 + 2,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     ?V0 + 3,A
// 2723     // in case originated not from our parent, use the default TC address
// 2724   }
// 2725 
// 2726   // Look up the TC link key associated with the device
// 2727   // or the default TC link key (extAddr is all FFs), whichever is found
// 2728   for ( i = 0; i < ZDSECMGR_TC_DEVICE_MAX; i++ )
??APSME_TCLinkKeySync_1:
        MOV     ?V0 + 6,#0x0
// 2729   {
// 2730     // Read entry i of the TC link key table from NV
// 2731     osal_nv_read( (ZCD_NV_TCLK_TABLE_START + i), 0,
// 2732                  sizeof(APSME_TCLinkKey_t), &tcLinkKey );
??APSME_TCLinkKeySync_2:
        ; Setup parameters for call to function osal_nv_read
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     ?V0 + 8,DPL
        MOV     ?V0 + 9,DPH
        MOV     R0,#?V0 + 8
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 52)
        MOV     ?V0 + 8,#0x20
        MOV     ?V0 + 9,#0x0
        MOV     R0,#?V0 + 8
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 54)
        MOV     R4,#0x0
        MOV     R5,#0x0
        MOV     ?V0 + 8,?V0 + 6
        MOV     A,?V0 + 8
        LCALL   ?Subroutine35 & 0xFFFF
??CrossCallReturnLabel_40:
        LCALL   ??osal_nv_read?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 50)
// 2733 
// 2734     // prefer exact match over default
// 2735     if ( AddrMgrExtAddrEqual(si->extAddr, tcLinkKey.extAddr) )
        ; Setup parameters for call to function AddrMgrExtAddrEqual
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     R4,DPL
        MOV     R5,DPH
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        LCALL   ??AddrMgrExtAddrEqual?relay
        MOV     A,R1
        JZ      ??APSME_TCLinkKeySync_3
// 2736     {
// 2737       selectedId = i;
        MOV     ?V0 + 1,?V0 + 6
// 2738       // break from the loop
// 2739       break;
        SJMP    ??APSME_TCLinkKeySync_4
// 2740     }
// 2741     else if ( APSME_IsDefaultTCLK(tcLinkKey.extAddr) )
??APSME_TCLinkKeySync_3:
        ; Setup parameters for call to function APSME_IsDefaultTCLK
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??APSME_IsDefaultTCLK?relay
        MOV     A,R1
        JZ      ??APSME_TCLinkKeySync_5
// 2742     {
// 2743       if ( ( originatorAddr != APSME_TRUSTCENTER_NWKADDR ) && ( si->keyID == SEC_KEYID_TRANSPORT )
// 2744            && (i == 0) && ( zgUseDefaultTCLK == TRUE ) )
        MOV     A,?V0 + 2
        ORL     A,?V0 + 3
        JZ      ??APSME_TCLinkKeySync_6
        MOV     A,?V0 + 4
        ADD     A,#0xe
        MOV     DPL,A
        MOV     A,?V0 + 5
        LCALL   ??Subroutine71_0 & 0xFFFF
??CrossCallReturnLabel_184:
        MOVX    A,@DPTR
        XRL     A,#0x2
        JNZ     ??APSME_TCLinkKeySync_6
        MOV     A,?V0 + 6
        JNZ     ??APSME_TCLinkKeySync_6
        MOV     DPTR,#zgUseDefaultTCLK
        MOVX    A,@DPTR
        XRL     A,#0x1
        JZ      ??APSME_TCLinkKeySync_5
// 2745       {
// 2746         //if a Key is received directly from an unusual TC,
// 2747         // don't use the first element of the table initialized with the default TCLK
// 2748         continue;
// 2749       }
// 2750       if ( selectedId == ZDSECMGR_TC_DEVICE_MAX )
??APSME_TCLinkKeySync_6:
        MOV     A,#0x2
        XRL     A,?V0 + 1
        JNZ     ??APSME_TCLinkKeySync_5
// 2751       {
// 2752         selectedId = i;
        MOV     ?V0 + 1,?V0 + 6
// 2753       }
// 2754     }
// 2755   }
??APSME_TCLinkKeySync_5:
        INC     ?V0 + 6
        MOV     A,?V0 + 6
        CLR     C
        SUBB    A,#0x2
        JNC     $+5
        LJMP    ??APSME_TCLinkKeySync_2 & 0xFFFF
// 2756 
// 2757   if ( selectedId < ZDSECMGR_TC_DEVICE_MAX )
??APSME_TCLinkKeySync_4:
        MOV     A,?V0 + 1
        CLR     C
        SUBB    A,#0x2
        JNC     ??APSME_TCLinkKeySync_7
// 2758   {
// 2759      // Only for UNIQUE keys, verify that the incoming frame counter is valid
// 2760     if ( zgApsLinkKeyType == ZG_UNIQUE_LINK_KEY )
        MOV     DPL,?V0 + 1
        MOV     R0,DPL
        MOV     A,R0
        LCALL   ?Subroutine35 & 0xFFFF
??CrossCallReturnLabel_41:
        MOV     A,?V0 + 4
        ADD     A,#0xf
        MOV     R6,A
        MOV     A,?V0 + 5
        ADDC    A,#0x0
        MOV     R7,A
        MOV     DPTR,#zgApsLinkKeyType
        MOVX    A,@DPTR
        JNZ     ??APSME_TCLinkKeySync_8
// 2761     {
// 2762       tclkRxFrmCntr = &TCLinkKeyFrmCntr[selectedId].rxFrmCntr;
        MOV     A,R0
        MOV     B,#0x9
        MUL     AB
        MOV     R0,A
        MOV     R1,B
        MOV     A,#(TCLinkKeyFrmCntr + 4) & 0xff
        ADD     A,R0
        MOV     R4,A
        MOV     A,#((TCLinkKeyFrmCntr + 4) >> 8) & 0xff
        ADDC    A,R1
        MOV     R5,A
// 2763 
// 2764       if ( si->frmCntr >= *tclkRxFrmCntr )
        MOV     A,?V0 + 4
        ADD     A,#0x12
        MOV     DPL,A
        MOV     A,?V0 + 5
        LCALL   ??Subroutine71_0 & 0xFFFF
??CrossCallReturnLabel_185:
        MOV     R0,#?V0 + 4
        LCALL   ?L_MOV_X
        MOV     DPL,R4
        MOV     DPH,R5
        MOV     R0,#?V0 + 4
        LCALL   ?UL_GE_X
        JNC     ??APSME_TCLinkKeySync_9
// 2765       {
// 2766         // set the keyNvId to use
// 2767         si->keyNvId = (ZCD_NV_TCLK_TABLE_START + selectedId);
        LCALL   ?Subroutine42 & 0xFFFF
// 2768 
// 2769         // update the rx frame counter
// 2770         *tclkRxFrmCntr = si->frmCntr + 1;
??CrossCallReturnLabel_116:
        MOV     DPTR,#__Constant_1
        MOV     R0,#?V0 + 4
        LCALL   ?L_ADD_X
        MOV     DPL,R4
        MOV     DPH,R5
        MOV     R0,#?V0 + 4
        LCALL   ?L_MOV_TO_X
// 2771 
// 2772         status = ZSuccess;
        SJMP    ??CrossCallReturnLabel_117
// 2773       }
// 2774       else
// 2775       {
// 2776         status = ZSecOldFrmCount;
??APSME_TCLinkKeySync_9:
        MOV     ?V0 + 0,#-0x5e
        SJMP    ??APSME_TCLinkKeySync_7
// 2777       }
// 2778     }
// 2779     else
// 2780     {
// 2781       // set the keyNvId to use
// 2782       si->keyNvId = (ZCD_NV_TCLK_TABLE_START + selectedId);
??APSME_TCLinkKeySync_8:
        LCALL   ?Subroutine42 & 0xFFFF
// 2783 
// 2784       status = ZSuccess;
??CrossCallReturnLabel_117:
        MOV     ?V0 + 0,#0x0
// 2785     }
// 2786   }
// 2787 
// 2788   // clear copy of key in RAM
// 2789   osal_memset( &tcLinkKey, 0x00, sizeof(APSME_TCLinkKey_t) );
??APSME_TCLinkKeySync_7:
        ; Setup parameters for call to function osal_memset
        MOV     R4,#0x20
        MOV     R5,#0x0
        MOV     R1,#0x0
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??osal_memset?relay
// 2790 
// 2791   return status;
        MOV     R1,?V0 + 0
        MOV     A,#0x20
        LJMP    ?Subroutine6 & 0xFFFF
          CFI EndBlock cfiBlock376
// 2792 }

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine37:
          CFI Block cfiCond377 Using cfiCommon0
          CFI Function ZDSecMgrSaveApsLinkKey
          CFI Conditional ??CrossCallReturnLabel_189
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V7 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V8 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V9 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 18)
          CFI Block cfiCond378 Using cfiCommon0
          CFI (cfiCond378) Function ZDSecMgrSaveApsLinkKey
          CFI (cfiCond378) Conditional ??CrossCallReturnLabel_190
          CFI (cfiCond378) R6 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI (cfiCond378) VB load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI (cfiCond378) V0 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI (cfiCond378) V1 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond378) V2 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond378) V3 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond378) V4 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond378) V5 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond378) V6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond378) V7 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond378) V8 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond378) V9 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond378) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond378) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond378) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond378) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond378) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond378) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond378) CFA_SP SP+0
          CFI (cfiCond378) CFA_XSP16 add(XSP16, 18)
          CFI Block cfiCond379 Using cfiCommon0
          CFI (cfiCond379) Function ZDSecMgrSaveTCLinkKey
          CFI (cfiCond379) Conditional ??CrossCallReturnLabel_191
          CFI (cfiCond379) R6 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI (cfiCond379) VB load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI (cfiCond379) V0 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI (cfiCond379) V1 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond379) V2 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond379) V3 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond379) V4 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond379) V5 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond379) V6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond379) V7 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond379) V8 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond379) V9 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond379) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond379) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond379) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond379) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond379) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond379) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond379) CFA_SP SP+0
          CFI (cfiCond379) CFA_XSP16 add(XSP16, 18)
          CFI Block cfiCond380 Using cfiCommon0
          CFI (cfiCond380) Function ZDSecMgrSaveTCLinkKey
          CFI (cfiCond380) Conditional ??CrossCallReturnLabel_192
          CFI (cfiCond380) R6 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI (cfiCond380) VB load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI (cfiCond380) V0 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI (cfiCond380) V1 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond380) V2 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond380) V3 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond380) V4 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond380) V5 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond380) V6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond380) V7 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond380) V8 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond380) V9 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond380) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond380) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond380) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond380) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond380) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond380) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond380) CFA_SP SP+0
          CFI (cfiCond380) CFA_XSP16 add(XSP16, 18)
          CFI Block cfiPicker381 Using cfiCommon1
          CFI (cfiPicker381) NoFunction
          CFI (cfiPicker381) Picker
        MOV     DPL,A
        MOV     A,?V0 + 7
          CFI EndBlock cfiCond377
          CFI EndBlock cfiCond378
          CFI EndBlock cfiCond379
          CFI EndBlock cfiCond380
          CFI EndBlock cfiPicker381
        REQUIRE ??Subroutine71_0
        ; // Fall through to label ??Subroutine71_0

        RSEG BANKED_CODE:CODE:NOROOT(0)
??Subroutine71_0:
          CFI Block cfiCond382 Using cfiCommon0
          CFI Function ZDSecMgrDeviceJoinFwd
          CFI Conditional ??CrossCallReturnLabel_179
          CFI DPL0 Frame(CFA_SP, 4)
          CFI DPH0 Frame(CFA_SP, 5)
          CFI CFA_SP SP+-5
          CFI CFA_XSP16 add(XSP16, 8)
          CFI Block cfiCond383 Using cfiCommon0
          CFI (cfiCond383) Function ZDSecMgrTransportKeyInd
          CFI (cfiCond383) Conditional ??CrossCallReturnLabel_180
          CFI (cfiCond383) R6 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond383) VB load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond383) V0 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond383) V1 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond383) V2 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond383) V3 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond383) V4 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond383) V5 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond383) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond383) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond383) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond383) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond383) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond383) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond383) CFA_SP SP+0
          CFI (cfiCond383) CFA_XSP16 add(XSP16, 34)
          CFI Block cfiCond384 Using cfiCommon0
          CFI (cfiCond384) Function ZDSecMgrUpdateDeviceInd
          CFI (cfiCond384) Conditional ??CrossCallReturnLabel_181
          CFI (cfiCond384) DPL0 Frame(CFA_SP, 4)
          CFI (cfiCond384) DPH0 Frame(CFA_SP, 5)
          CFI (cfiCond384) CFA_SP SP+-5
          CFI (cfiCond384) CFA_XSP16 add(XSP16, 8)
          CFI Block cfiCond385 Using cfiCommon0
          CFI (cfiCond385) Function ZDSecMgrUpdateDeviceInd
          CFI (cfiCond385) Conditional ??CrossCallReturnLabel_182
          CFI (cfiCond385) DPL0 Frame(CFA_SP, 4)
          CFI (cfiCond385) DPH0 Frame(CFA_SP, 5)
          CFI (cfiCond385) CFA_SP SP+-5
          CFI (cfiCond385) CFA_XSP16 add(XSP16, 8)
          CFI Block cfiCond386 Using cfiCommon0
          CFI (cfiCond386) Function ZDSecMgrRestoreFromNV
          CFI (cfiCond386) Conditional ??CrossCallReturnLabel_183
          CFI (cfiCond386) R6 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI (cfiCond386) VB load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI (cfiCond386) V0 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI (cfiCond386) V1 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond386) V2 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond386) V3 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond386) V4 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond386) V5 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond386) V6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond386) V7 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond386) V8 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond386) V9 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond386) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond386) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond386) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond386) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond386) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond386) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond386) CFA_SP SP+0
          CFI (cfiCond386) CFA_XSP16 add(XSP16, 20)
          CFI Block cfiCond387 Using cfiCommon0
          CFI (cfiCond387) Function APSME_TCLinkKeySync
          CFI (cfiCond387) Conditional ??CrossCallReturnLabel_184
          CFI (cfiCond387) R6 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI (cfiCond387) VB load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI (cfiCond387) V0 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI (cfiCond387) V1 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond387) V2 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond387) V3 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond387) V4 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond387) V5 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond387) V6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond387) V7 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond387) V8 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond387) V9 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond387) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond387) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond387) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond387) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond387) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond387) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond387) CFA_SP SP+0
          CFI (cfiCond387) CFA_XSP16 add(XSP16, 50)
          CFI Block cfiCond388 Using cfiCommon0
          CFI (cfiCond388) Function APSME_TCLinkKeySync
          CFI (cfiCond388) Conditional ??CrossCallReturnLabel_185
          CFI (cfiCond388) R6 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI (cfiCond388) VB load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI (cfiCond388) V0 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI (cfiCond388) V1 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond388) V2 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond388) V3 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond388) V4 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond388) V5 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond388) V6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond388) V7 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond388) V8 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond388) V9 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond388) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond388) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond388) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond388) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond388) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond388) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond388) CFA_SP SP+0
          CFI (cfiCond388) CFA_XSP16 add(XSP16, 50)
          CFI Block cfiCond389 Using cfiCommon0
          CFI (cfiCond389) Function APSME_TCLinkKeyLoad
          CFI (cfiCond389) Conditional ??CrossCallReturnLabel_186
          CFI (cfiCond389) R6 load(1, XDATA, add(CFA_XSP16, literal(-20)))
          CFI (cfiCond389) VB load(1, XDATA, add(CFA_XSP16, literal(-19)))
          CFI (cfiCond389) V0 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI (cfiCond389) V1 load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI (cfiCond389) V2 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI (cfiCond389) V3 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond389) V4 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond389) V5 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond389) V6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond389) V7 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond389) V8 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond389) V9 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond389) V10 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond389) V11 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond389) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond389) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond389) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond389) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond389) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond389) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond389) CFA_SP SP+0
          CFI (cfiCond389) CFA_XSP16 add(XSP16, 65)
          CFI Block cfiCond390 Using cfiCommon0
          CFI (cfiCond390) Function APSME_TCLinkKeyLoad
          CFI (cfiCond390) Conditional ??CrossCallReturnLabel_187
          CFI (cfiCond390) R6 load(1, XDATA, add(CFA_XSP16, literal(-20)))
          CFI (cfiCond390) VB load(1, XDATA, add(CFA_XSP16, literal(-19)))
          CFI (cfiCond390) V0 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI (cfiCond390) V1 load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI (cfiCond390) V2 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI (cfiCond390) V3 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond390) V4 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond390) V5 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond390) V6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond390) V7 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond390) V8 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond390) V9 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond390) V10 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond390) V11 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond390) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond390) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond390) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond390) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond390) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond390) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond390) CFA_SP SP+0
          CFI (cfiCond390) CFA_XSP16 add(XSP16, 65)
          CFI Block cfiCond391 Using cfiCommon0
          CFI (cfiCond391) Function APSME_TCLinkKeyLoad
          CFI (cfiCond391) Conditional ??CrossCallReturnLabel_188
          CFI (cfiCond391) R6 load(1, XDATA, add(CFA_XSP16, literal(-20)))
          CFI (cfiCond391) VB load(1, XDATA, add(CFA_XSP16, literal(-19)))
          CFI (cfiCond391) V0 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI (cfiCond391) V1 load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI (cfiCond391) V2 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI (cfiCond391) V3 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond391) V4 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond391) V5 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond391) V6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond391) V7 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond391) V8 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond391) V9 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond391) V10 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond391) V11 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond391) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond391) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond391) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond391) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond391) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond391) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond391) CFA_SP SP+0
          CFI (cfiCond391) CFA_XSP16 add(XSP16, 65)
          CFI Block cfiCond392 Using cfiCommon0
          CFI (cfiCond392) Function ZDSecMgrSaveApsLinkKey
          CFI (cfiCond392) Conditional ??CrossCallReturnLabel_189
          CFI (cfiCond392) R6 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI (cfiCond392) VB load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI (cfiCond392) V0 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI (cfiCond392) V1 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond392) V2 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond392) V3 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond392) V4 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond392) V5 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond392) V6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond392) V7 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond392) V8 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond392) V9 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond392) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond392) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond392) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond392) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond392) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond392) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond392) CFA_SP SP+0
          CFI (cfiCond392) CFA_XSP16 add(XSP16, 18)
          CFI Block cfiCond393 Using cfiCommon0
          CFI (cfiCond393) Function ZDSecMgrSaveApsLinkKey
          CFI (cfiCond393) Conditional ??CrossCallReturnLabel_190
          CFI (cfiCond393) R6 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI (cfiCond393) VB load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI (cfiCond393) V0 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI (cfiCond393) V1 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond393) V2 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond393) V3 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond393) V4 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond393) V5 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond393) V6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond393) V7 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond393) V8 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond393) V9 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond393) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond393) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond393) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond393) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond393) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond393) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond393) CFA_SP SP+0
          CFI (cfiCond393) CFA_XSP16 add(XSP16, 18)
          CFI Block cfiCond394 Using cfiCommon0
          CFI (cfiCond394) Function ZDSecMgrSaveTCLinkKey
          CFI (cfiCond394) Conditional ??CrossCallReturnLabel_191
          CFI (cfiCond394) R6 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI (cfiCond394) VB load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI (cfiCond394) V0 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI (cfiCond394) V1 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond394) V2 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond394) V3 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond394) V4 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond394) V5 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond394) V6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond394) V7 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond394) V8 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond394) V9 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond394) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond394) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond394) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond394) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond394) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond394) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond394) CFA_SP SP+0
          CFI (cfiCond394) CFA_XSP16 add(XSP16, 18)
          CFI Block cfiCond395 Using cfiCommon0
          CFI (cfiCond395) Function ZDSecMgrSaveTCLinkKey
          CFI (cfiCond395) Conditional ??CrossCallReturnLabel_192
          CFI (cfiCond395) R6 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI (cfiCond395) VB load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI (cfiCond395) V0 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI (cfiCond395) V1 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond395) V2 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond395) V3 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond395) V4 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond395) V5 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond395) V6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond395) V7 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond395) V8 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond395) V9 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond395) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond395) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond395) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond395) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond395) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond395) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond395) CFA_SP SP+0
          CFI (cfiCond395) CFA_XSP16 add(XSP16, 18)
          CFI Block cfiPicker396 Using cfiCommon1
          CFI (cfiPicker396) NoFunction
          CFI (cfiPicker396) Picker
        ADDC    A,#0x0
        MOV     DPH,A
        RET
          CFI EndBlock cfiCond382
          CFI EndBlock cfiCond383
          CFI EndBlock cfiCond384
          CFI EndBlock cfiCond385
          CFI EndBlock cfiCond386
          CFI EndBlock cfiCond387
          CFI EndBlock cfiCond388
          CFI EndBlock cfiCond389
          CFI EndBlock cfiCond390
          CFI EndBlock cfiCond391
          CFI EndBlock cfiCond392
          CFI EndBlock cfiCond393
          CFI EndBlock cfiCond394
          CFI EndBlock cfiCond395
          CFI EndBlock cfiPicker396
// 2793 
// 2794 /******************************************************************************
// 2795  * @fn          APSME_TCLinkKeyLoad
// 2796  *
// 2797  * @brief       Load Trust Center LINK key data.
// 2798  *
// 2799  * @param       dstAddr - [in] dstAddr
// 2800  * @param       si      - [in, out] SSP_Info_t
// 2801  *
// 2802  * @return      ZStatus_t
// 2803  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 2804 ZStatus_t APSME_TCLinkKeyLoad( uint16 dstAddr, SSP_Info_t* si )
APSME_TCLinkKeyLoad:
          CFI Block cfiBlock397 Using cfiCommon0
          CFI Function APSME_TCLinkKeyLoad
        CODE
// 2805 {
        FUNCALL APSME_TCLinkKeyLoad, AddrMgrExtAddrValid
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 65, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 65, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_TCLinkKeyLoad, osal_nv_read
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 69, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 69, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_TCLinkKeyLoad, AddrMgrExtAddrEqual
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 65, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 65, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_TCLinkKeyLoad, APSME_IsDefaultTCLK
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 65, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 65, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_TCLinkKeyLoad, APSME_IsDistributedSecurity
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 65, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 65, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_TCLinkKeyLoad, osal_set_event
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 65, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 65, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_TCLinkKeyLoad, AddrMgrEntryLookupNwk
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 65, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 65, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_TCLinkKeyLoad, AddrMgrEntryRelease
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 65, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 65, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL APSME_TCLinkKeyLoad, osal_memset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 65, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 65, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x14
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V11 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V10 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V9 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V8 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V7 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-19)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-20)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 20)
        ; Saved register size: 20
        ; Auto size: 45
        MOV     A,#-0x2d
        LCALL   ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 65)
        MOV     ?V0 + 0,R4
        MOV     ?V0 + 1,R5
// 2806   uint8 i;
// 2807   ZStatus_t status = ZSecNoKey;
        MOV     R6,#-0x5f
// 2808   APSME_TCLinkKey_t tcLinkKey;
// 2809   AddrMgrEntry_t addrEntry;
// 2810   uint32 *tclkTxFrmCntr;
// 2811   uint8 extAddrFound;
// 2812   uint8 defaultTCLKIdx = ZDSECMGR_TC_DEVICE_MAX;
        MOV     ?V0 + 8,#0x2
// 2813 
// 2814   // Look up the ami of the srcAddr if available
// 2815   addrEntry.user    = ADDRMGR_USER_DEFAULT;
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        CLR     A
        MOVX    @DPTR,A
// 2816   addrEntry.nwkAddr = dstAddr;
        INC     A
        LCALL   ?XSTACK_DISP0_8
        LCALL   ??Subroutine62_0 & 0xFFFF
// 2817 
// 2818   extAddrFound = AddrMgrExtAddrValid( si->extAddr );
??CrossCallReturnLabel_112:
        MOV     A,R4
        ADD     A,#0x6
        MOV     ?V0 + 2,A
        MOV     A,R5
        ADDC    A,#0x0
        MOV     ?V0 + 3,A
        ; Setup parameters for call to function AddrMgrExtAddrValid
        MOV     R2,?V0 + 2
        MOV     R3,A
        LCALL   ??AddrMgrExtAddrValid?relay
        MOV     A,R1
        MOV     ?V0 + 6,A
// 2819 
// 2820   // Look up the TC link key associated with the device
// 2821   // or the master TC link key (ami = 0xFFFF), whichever is found
// 2822   for( i = 0; i < ZDSECMGR_TC_DEVICE_MAX; i++ )
        MOV     R7,#0x0
// 2823   {
// 2824     // Read entry i of the TC link key table from NV
// 2825     osal_nv_read( (ZCD_NV_TCLK_TABLE_START + i), 0,
// 2826                  sizeof(APSME_TCLinkKey_t), &tcLinkKey );
??APSME_TCLinkKeyLoad_0:
        ; Setup parameters for call to function osal_nv_read
        MOV     A,#0xd
        LCALL   ?XSTACK_DISP0_8
        MOV     ?V0 + 4,DPL
        MOV     ?V0 + 5,DPH
        MOV     R0,#?V0 + 4
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 67)
        MOV     ?V0 + 4,#0x20
        MOV     ?V0 + 5,#0x0
        MOV     R0,#?V0 + 4
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 69)
        MOV     R4,#0x0
        MOV     R5,#0x0
        MOV     ?V0 + 4,R7
        MOV     A,?V0 + 4
        LCALL   ?Subroutine35 & 0xFFFF
??CrossCallReturnLabel_42:
        LCALL   ??osal_nv_read?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 65)
// 2827 
// 2828     if( extAddrFound && AddrMgrExtAddrEqual(si->extAddr, tcLinkKey.extAddr) )
        MOV     A,?V0 + 6
        JZ      ??APSME_TCLinkKeyLoad_1
        ; Setup parameters for call to function AddrMgrExtAddrEqual
        MOV     A,#0xd
        LCALL   ?XSTACK_DISP0_8
        MOV     R4,DPL
        MOV     R5,DPH
        MOV     R2,?V0 + 2
        MOV     R3,?V0 + 3
        LCALL   ??AddrMgrExtAddrEqual?relay
        MOV     A,R1
        JNZ     ??APSME_TCLinkKeyLoad_2
// 2829     {
// 2830       status = ZSuccess;
// 2831 
// 2832       break; // break from the loop
// 2833     }
// 2834 
// 2835     if ( APSME_IsDefaultTCLK(tcLinkKey.extAddr) )
??APSME_TCLinkKeyLoad_1:
        ; Setup parameters for call to function APSME_IsDefaultTCLK
        MOV     A,#0xd
        LCALL   ?XSTACK_DISP0_8
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??APSME_IsDefaultTCLK?relay
        MOV     A,R1
        JZ      ??APSME_TCLinkKeyLoad_3
// 2836     {
// 2837       if ( !extAddrFound && ( !APSME_IsDistributedSecurity() ) )
        MOV     A,?V0 + 6
        JNZ     ??APSME_TCLinkKeyLoad_4
        ; Setup parameters for call to function APSME_IsDistributedSecurity
        LCALL   ??APSME_IsDistributedSecurity?relay
        MOV     A,R1
        JZ      ??APSME_TCLinkKeyLoad_2
// 2838       {
// 2839         status = ZSuccess;
// 2840 
// 2841         break; // break from the loop
// 2842       }
// 2843 
// 2844       // Remember the last default TCLK index
// 2845       defaultTCLKIdx = i;
// 2846     }
// 2847   }
// 2848 
// 2849   if ( (status != ZSuccess) && (defaultTCLKIdx < ZDSECMGR_TC_DEVICE_MAX) )
// 2850   {
// 2851     // Exact match was not found; use the last default TC Link Key
// 2852     i = defaultTCLKIdx;
// 2853     status = ZSuccess;
// 2854   }
// 2855 
// 2856   if ( status == ZSuccess )
??APSME_TCLinkKeyLoad_4:
        MOV     ?V0 + 8,R7
??APSME_TCLinkKeyLoad_3:
        INC     R7
        MOV     A,R7
        CLR     C
        SUBB    A,#0x2
        JC      ??APSME_TCLinkKeyLoad_0
        MOV     A,?V0 + 8
        CLR     C
        SUBB    A,#0x2
        JC      $+5
        LJMP    ??APSME_TCLinkKeyLoad_5 & 0xFFFF
        MOV     R7,?V0 + 8
??APSME_TCLinkKeyLoad_2:
        MOV     R6,#0x0
// 2857   {
// 2858     tclkTxFrmCntr = &TCLinkKeyFrmCntr[i].txFrmCntr;
        MOV     DPL,R7
        MOV     R0,DPL
        MOV     A,R0
        MOV     B,#0x9
        MUL     AB
        MOV     R2,A
        MOV     R3,B
        MOV     A,#TCLinkKeyFrmCntr & 0xff
        ADD     A,R2
        MOV     ?V0 + 10,A
        MOV     A,#(TCLinkKeyFrmCntr >> 8) & 0xff
        ADDC    A,R3
        MOV     ?V0 + 11,A
        MOV     ?V0 + 4,?V0 + 10
        MOV     ?V0 + 5,A
// 2859 
// 2860     // set the keyNvId to use
// 2861     si->keyNvId = (ZCD_NV_TCLK_TABLE_START + i);
        MOV     A,R0
        ADD     A,#0x1
        INC     R0
        CLR     A
        ADDC    A,#0x1
        MOV     R1,A
        MOV     A,?V0 + 0
        ADD     A,#0xf
        MOV     DPL,A
        MOV     A,?V0 + 1
        LCALL   ??Subroutine71_0 & 0xFFFF
??CrossCallReturnLabel_186:
        LCALL   ??Subroutine63_0 & 0xFFFF
// 2862 
// 2863     // update link key related fields
// 2864     si->keyID   = SEC_KEYID_LINK;
??CrossCallReturnLabel_135:
        MOV     A,?V0 + 0
        ADD     A,#0xe
        MOV     DPL,A
        MOV     A,?V0 + 1
        LCALL   ??Subroutine71_0 & 0xFFFF
??CrossCallReturnLabel_187:
        CLR     A
        MOVX    @DPTR,A
// 2865     si->frmCntr = *tclkTxFrmCntr;
        MOV     DPL,?V0 + 4
        MOV     DPH,?V0 + 5
        LCALL   ?XLOAD_R2345
        MOV     A,?V0 + 0
        ADD     A,#0x12
        MOV     DPL,A
        MOV     A,?V0 + 1
        LCALL   ??Subroutine71_0 & 0xFFFF
??CrossCallReturnLabel_188:
        LCALL   ?XSTORE_R2345
// 2866 
// 2867     // update outgoing frame counter
// 2868     (*tclkTxFrmCntr)++;
        MOV     DPTR,#__Constant_1
        MOV     R0,#?V0 + 0
        LCALL   ?L_MOV_X
        MOV     DPL,?V0 + 4
        MOV     DPH,?V0 + 5
        MOV     R0,#?V0 + 0
        LCALL   ?L_ADD_TO_X
// 2869 
// 2870 #if defined ( NV_RESTORE )
// 2871     // write periodically to NV
// 2872     if ( !(*tclkTxFrmCntr % MAX_TCLK_FRAMECOUNTER_CHANGES) )
        MOV     DPL,?V0 + 4
        MOV     DPH,?V0 + 5
        MOV     R0,#?V0 + 4
        LCALL   ?L_MOV_X
        MOV     DPTR,#__Constant_a
        MOV     R0,#?V0 + 0
        LCALL   ?L_MOV_X
        MOV     R0,#?V0 + 4
        MOV     R1,#?V0 + 0
        LCALL   ?UL_DIV_MOD
        MOV     A,?V0 + 0
        ORL     A,?V0 + 1
        ORL     A,?V0 + 2
        ORL     A,?V0 + 3
        JNZ     ??APSME_TCLinkKeyLoad_6
// 2873     {
// 2874       // set the flag to write key to NV
// 2875       TCLinkKeyFrmCntr[i].pendingFlag = TRUE;
        MOV     DPL,?V0 + 10
        MOV     DPH,?V0 + 11
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOV     A,#0x1
        MOVX    @DPTR,A
// 2876 
// 2877       // Notify the ZDApp that the frame counter has changed.
// 2878       osal_set_event( ZDAppTaskID, ZDO_TCLK_FRAMECOUNTER_CHANGE );
        ; Setup parameters for call to function osal_set_event
        MOV     R2,#0x0
        MOV     R3,#0x4
        MOV     DPTR,#ZDAppTaskID
        MOVX    A,@DPTR
        MOV     R1,A
        LCALL   ??osal_set_event?relay
        SJMP    ??APSME_TCLinkKeyLoad_6
??APSME_TCLinkKeyLoad_5:
        ; Setup parameters for call to function AddrMgrEntryLookupNwk
// 2879     }
// 2880 #endif
// 2881   }
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??AddrMgrEntryLookupNwk?relay
        MOV     A,R1
        XRL     A,#0x1
        JNZ     ??APSME_TCLinkKeyLoad_6
// 2882 
// 2883   // If no TC link key found, remove the device from the address manager
// 2884   if ( (status != ZSuccess) && (AddrMgrEntryLookupNwk(&addrEntry) == TRUE) )
// 2885   {
// 2886     AddrMgrEntryRelease( &addrEntry );
        ; Setup parameters for call to function AddrMgrEntryRelease
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??AddrMgrEntryRelease?relay
// 2887   }
// 2888 
// 2889     // clear copy of key in RAM
// 2890   osal_memset( &tcLinkKey, 0x00, sizeof(APSME_TCLinkKey_t) );
??APSME_TCLinkKeyLoad_6:
        ; Setup parameters for call to function osal_memset
        MOV     R4,#0x20
        MOV     R5,#0x0
        MOV     R1,#0x0
        MOV     A,#0xd
        LCALL   ?XSTACK_DISP0_8
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??osal_memset?relay
// 2891 
// 2892   return status;
        MOV     A,R6
        MOV     R1,A
        MOV     A,#0x2d
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 20)
        MOV     R7,#0xc
        LJMP    ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock397
// 2893 }

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine35:
          CFI Block cfiCond398 Using cfiCommon0
          CFI Function APSME_TCLinkKeySync
          CFI Conditional ??CrossCallReturnLabel_40
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V7 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V8 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V9 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 54)
          CFI Block cfiCond399 Using cfiCommon0
          CFI (cfiCond399) Function APSME_TCLinkKeySync
          CFI (cfiCond399) Conditional ??CrossCallReturnLabel_41
          CFI (cfiCond399) R6 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI (cfiCond399) VB load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI (cfiCond399) V0 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI (cfiCond399) V1 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond399) V2 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond399) V3 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond399) V4 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond399) V5 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond399) V6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond399) V7 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond399) V8 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond399) V9 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond399) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond399) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond399) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond399) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond399) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond399) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond399) CFA_SP SP+0
          CFI (cfiCond399) CFA_XSP16 add(XSP16, 50)
          CFI Block cfiCond400 Using cfiCommon0
          CFI (cfiCond400) Function APSME_TCLinkKeyLoad
          CFI (cfiCond400) Conditional ??CrossCallReturnLabel_42
          CFI (cfiCond400) R6 load(1, XDATA, add(CFA_XSP16, literal(-20)))
          CFI (cfiCond400) VB load(1, XDATA, add(CFA_XSP16, literal(-19)))
          CFI (cfiCond400) V0 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI (cfiCond400) V1 load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI (cfiCond400) V2 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI (cfiCond400) V3 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond400) V4 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond400) V5 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond400) V6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond400) V7 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond400) V8 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond400) V9 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond400) V10 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond400) V11 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond400) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond400) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond400) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond400) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond400) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond400) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond400) CFA_SP SP+0
          CFI (cfiCond400) CFA_XSP16 add(XSP16, 69)
          CFI Block cfiPicker401 Using cfiCommon1
          CFI (cfiPicker401) NoFunction
          CFI (cfiPicker401) Picker
        ADD     A,#0x1
        MOV     R2,A
        CLR     A
        ADDC    A,#0x1
        MOV     R3,A
        RET
          CFI EndBlock cfiCond398
          CFI EndBlock cfiCond399
          CFI EndBlock cfiCond400
          CFI EndBlock cfiPicker401
// 2894 
// 2895 /******************************************************************************
// 2896  * @fn          APSME_IsDefaultTCLK
// 2897  *
// 2898  * @brief       Return TRUE or FALSE based on the extended address.  If the
// 2899  *              input ext address is all FFs, it means the trust center link
// 2900  *              assoiciated with the address is the default trust center link key
// 2901  *
// 2902  * @param       extAddr - [in] extended address
// 2903  *
// 2904  * @return      uint8 TRUE/FALSE
// 2905  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 2906 uint8 APSME_IsDefaultTCLK( uint8 *extAddr )
APSME_IsDefaultTCLK:
          CFI Block cfiBlock402 Using cfiCommon0
          CFI Function APSME_IsDefaultTCLK
        CODE
// 2907 {
        FUNCALL APSME_IsDefaultTCLK, osal_isbufset
        LOCFRAME ISTACK, 2, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 0, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 0, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        PUSH    DPL
          CFI DPL0 Frame(CFA_SP, 4)
          CFI CFA_SP SP+-4
        PUSH    DPH
          CFI DPH0 Frame(CFA_SP, 5)
          CFI CFA_SP SP+-5
        ; Saved register size: 2
        ; Auto size: 0
// 2908   return osal_isbufset( extAddr, 0xFF, Z_EXTADDR_LEN );
        ; Setup parameters for call to function osal_isbufset
        MOV     R4,#0x8
        MOV     R1,#-0x1
        LCALL   ??osal_isbufset?relay
        LJMP    ??Subroutine61_0 & 0xFFFF
          CFI EndBlock cfiBlock402
// 2909 }
// 2910 
// 2911 /******************************************************************************
// 2912  * @fn          ZDSecMgrNwkKeyInit
// 2913  *
// 2914  * @brief       Initialize the NV items for
// 2915  *                  ZCD_NV_NWKKEY,
// 2916  *                  ZCD_NV_NWK_ACTIVE_KEY_INFO and
// 2917  *                  ZCD_NV_NWK_ALTERN_KEY_INFO
// 2918  *
// 2919  * @param       setDefault
// 2920  *
// 2921  * @return      none
// 2922  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 2923 void ZDSecMgrNwkKeyInit(uint8 setDefault)
ZDSecMgrNwkKeyInit:
          CFI Block cfiBlock403 Using cfiCommon0
          CFI Function ZDSecMgrNwkKeyInit
        CODE
// 2924 {
        FUNCALL ZDSecMgrNwkKeyInit, osal_memset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 48, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 48, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrNwkKeyInit, osal_nv_item_init
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 50, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 50, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrNwkKeyInit, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 52, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 52, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrNwkKeyInit, osal_memset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 48, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 48, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrNwkKeyInit, osal_nv_item_init
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 50, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 50, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrNwkKeyInit, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 52, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 52, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrNwkKeyInit, osal_nv_item_init
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 50, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 50, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrNwkKeyInit, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 52, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 52, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0xa
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 10)
        ; Saved register size: 10
        ; Auto size: 38
        MOV     A,#-0x26
        LCALL   ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 48)
        MOV     A,R1
        MOV     R6,A
// 2925   uint8 status;
// 2926   nwkKeyDesc nwkKey;
// 2927 
// 2928   // Initialize NV items for NWK key, this structure contains the frame counter
// 2929   // and is only used when NV_RESTORE is enabled
// 2930   nwkActiveKeyItems keyItems;
// 2931 
// 2932   osal_memset( &keyItems, 0, sizeof( nwkActiveKeyItems ) );
        ; Setup parameters for call to function osal_memset
        MOV     R4,#0x15
        MOV     R5,#0x0
        MOV     R1,#0x0
        MOV     A,#0x11
        LCALL   ?XSTACK_DISP0_8
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??osal_memset?relay
// 2933 
// 2934   status = osal_nv_item_init( ZCD_NV_NWKKEY, sizeof(nwkActiveKeyItems), (void *)&keyItems );
// 2935 
// 2936 #if defined ( NV_RESTORE )
// 2937   // reset the values of NV items if NV_RESTORE is not enabled
// 2938   if ((status == SUCCESS) && (setDefault == TRUE))
        ; Setup parameters for call to function osal_nv_item_init
        MOV     A,#0x11
        LCALL   ?XSTACK_DISP0_8
        MOV     ?V0 + 0,DPL
        MOV     ?V0 + 1,DPH
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 50)
        MOV     R4,#0x15
        MOV     R5,#0x0
        MOV     R2,#-0x7e
        MOV     R3,#0x0
        LCALL   ??osal_nv_item_init?relay
        MOV     A,#0x2
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 48)
        MOV     A,R1
        JNZ     ??ZDSecMgrNwkKeyInit_0
        MOV     A,#0x1
        XRL     A,R6
        JNZ     ??ZDSecMgrNwkKeyInit_0
// 2939   {
// 2940     // clear NV data to default values
// 2941     osal_nv_write( ZCD_NV_NWKKEY, 0, sizeof(nwkActiveKeyItems), &keyItems );
        ; Setup parameters for call to function osal_nv_write
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 50)
        MOV     ?V0 + 0,#0x15
        MOV     ?V0 + 1,#0x0
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 52)
        MOV     R4,#0x0
        MOV     R5,#0x0
        MOV     R2,#-0x7e
        MOV     R3,#0x0
        LCALL   ??osal_nv_write?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 48)
// 2942   }
// 2943 #else
// 2944   (void)setDefault;   // to eliminate compiler warning
// 2945 
// 2946   // reset the values of NV items if NV_RESTORE is not enabled
// 2947   if (status == SUCCESS)
// 2948   {
// 2949     osal_nv_write( ZCD_NV_NWKKEY, 0, sizeof(nwkActiveKeyItems), &keyItems );
// 2950   }
// 2951 #endif // defined (NV_RESTORE)
// 2952 
// 2953   // Initialize NV items for NWK Active and Alternate keys. These items are used
// 2954   // all the time, independently of NV_RESTORE being set or not
// 2955   osal_memset( &nwkKey, 0x00, sizeof(nwkKey) );
??ZDSecMgrNwkKeyInit_0:
        ; Setup parameters for call to function osal_memset
        MOV     R4,#0x11
        MOV     R5,#0x0
        MOV     R1,#0x0
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??osal_memset?relay
// 2956 
// 2957   status = osal_nv_item_init( ZCD_NV_NWK_ACTIVE_KEY_INFO, sizeof(nwkKey), &nwkKey);
// 2958 
// 2959 #if defined ( NV_RESTORE )
// 2960   // reset the values of NV items if NV_RESTORE is not enabled
// 2961   if ((status == SUCCESS) && (setDefault == TRUE))
        ; Setup parameters for call to function osal_nv_item_init
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     ?V0 + 0,DPL
        MOV     ?V0 + 1,DPH
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 50)
        MOV     R4,#0x11
        MOV     R5,#0x0
        MOV     R2,#0x3a
        MOV     R3,#0x0
        LCALL   ??osal_nv_item_init?relay
        MOV     A,#0x2
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 48)
        MOV     A,R1
        JNZ     ??ZDSecMgrNwkKeyInit_1
        MOV     A,#0x1
        XRL     A,R6
        JNZ     ??ZDSecMgrNwkKeyInit_1
// 2962   {
// 2963     // clear NV data to default values
// 2964     osal_nv_write( ZCD_NV_NWK_ACTIVE_KEY_INFO, 0, sizeof(nwkKey), &nwkKey );
        ; Setup parameters for call to function osal_nv_write
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 50)
        MOV     ?V0 + 0,#0x11
        MOV     ?V0 + 1,#0x0
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 52)
        MOV     R4,#0x0
        MOV     R5,#0x0
        MOV     R2,#0x3a
        MOV     R3,#0x0
        LCALL   ??osal_nv_write?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 48)
// 2965   }
// 2966 #else
// 2967   // reset the values of NV items if NV_RESTORE is not enabled
// 2968   if (status == SUCCESS)
// 2969   {
// 2970     osal_nv_write( ZCD_NV_NWK_ACTIVE_KEY_INFO, 0, sizeof(nwkKey), &nwkKey );
// 2971   }
// 2972 #endif // defined (NV_RESTORE)
// 2973 
// 2974   status = osal_nv_item_init( ZCD_NV_NWK_ALTERN_KEY_INFO, sizeof(nwkKey), &nwkKey );
// 2975 
// 2976 #if defined ( NV_RESTORE )
// 2977   // reset the values of NV items if NV_RESTORE is not enabled
// 2978   if ((status == SUCCESS) && (setDefault == TRUE))
??ZDSecMgrNwkKeyInit_1:
        ; Setup parameters for call to function osal_nv_item_init
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     ?V0 + 0,DPL
        MOV     ?V0 + 1,DPH
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 50)
        MOV     R4,#0x11
        MOV     R5,#0x0
        MOV     R2,#0x3b
        MOV     R3,#0x0
        LCALL   ??osal_nv_item_init?relay
        MOV     A,#0x2
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 48)
        MOV     A,R1
        JNZ     ??ZDSecMgrNwkKeyInit_2
        MOV     A,#0x1
        XRL     A,R6
        JNZ     ??ZDSecMgrNwkKeyInit_2
// 2979   {
// 2980     // clear NV data to default values
// 2981     osal_nv_write( ZCD_NV_NWK_ALTERN_KEY_INFO, 0, sizeof(nwkKey), &nwkKey );
        ; Setup parameters for call to function osal_nv_write
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 50)
        MOV     ?V0 + 0,#0x11
        MOV     ?V0 + 1,#0x0
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 52)
        MOV     R4,#0x0
        MOV     R5,#0x0
        MOV     R2,#0x3b
        MOV     R3,#0x0
        LCALL   ??osal_nv_write?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 48)
          CFI EndBlock cfiBlock403
// 2982   }
// 2983 #else
// 2984   // reset the values of NV items if NV_RESTORE is not enabled
// 2985   if (status == SUCCESS)
// 2986   {
// 2987     osal_nv_write( ZCD_NV_NWK_ALTERN_KEY_INFO, 0, sizeof(nwkKey), &nwkKey );
// 2988   }
// 2989 #endif // defined (NV_RESTORE)
// 2990 
// 2991 }
??ZDSecMgrNwkKeyInit_2:
        REQUIRE ?Subroutine9
        ; // Fall through to label ?Subroutine9

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine9:
          CFI Block cfiBlock404 Using cfiCommon0
          CFI NoFunction
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 48)
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        MOV     A,#0x26
        SJMP    ??Subroutine72_0
          CFI EndBlock cfiBlock404

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine1:
          CFI Block cfiBlock405 Using cfiCommon0
          CFI NoFunction
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 12)
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        MOV     A,#0x2
          CFI EndBlock cfiBlock405
        REQUIRE ??Subroutine72_0
        ; // Fall through to label ??Subroutine72_0

        RSEG BANKED_CODE:CODE:NOROOT(0)
??Subroutine72_0:
          CFI Block cfiBlock406 Using cfiCommon0
          CFI NoFunction
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 49)
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI Invalid
        LCALL   ?DEALLOC_XSTACK8
          CFI EndBlock cfiBlock406
        REQUIRE ??Subroutine73_0
        ; // Fall through to label ??Subroutine73_0

        RSEG BANKED_CODE:CODE:NOROOT(0)
??Subroutine73_0:
          CFI Block cfiBlock407 Using cfiCommon0
          CFI NoFunction
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 10)
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        MOV     R7,#0x2
        LJMP    ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock407
// 2992 
// 2993 /*********************************************************************
// 2994  * @fn          ZDSecMgrReadKeyFromNv
// 2995  *
// 2996  * @brief       Looks for a specific key in NV based on Index value
// 2997  *
// 2998  * @param   keyNvId - Index of key to look in NV
// 2999  *                    valid values are:
// 3000  *                    ZCD_NV_NWK_ACTIVE_KEY_INFO
// 3001  *                    ZCD_NV_NWK_ALTERN_KEY_INFO
// 3002  *                    ZCD_NV_TCLK_TABLE_START + <offset_in_table>
// 3003  *                    ZCD_NV_APS_LINK_KEY_DATA_START + <offset_in_table>
// 3004  *                    ZCD_NV_PRECFGKEY
// 3005  *
// 3006  * @param  *keyinfo - Data is read into this buffer.
// 3007  *
// 3008  * @return  SUCCESS if NV data was copied to the keyinfo parameter .
// 3009  *          Otherwise, NV_OPER_FAILED for failure.
// 3010  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 3011 ZStatus_t ZDSecMgrReadKeyFromNv(uint16 keyNvId, void *keyinfo)
ZDSecMgrReadKeyFromNv:
          CFI Block cfiBlock408 Using cfiCommon0
          CFI Function ZDSecMgrReadKeyFromNv
        CODE
// 3012 {
        FUNCALL ZDSecMgrReadKeyFromNv, osal_nv_read
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 14, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrReadKeyFromNv, osal_nv_read
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 14, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrReadKeyFromNv, osal_nv_read
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 14, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrReadKeyFromNv, osal_nv_read
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 14, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0xa
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 10)
        ; Saved register size: 10
        ; Auto size: 0
// 3013   if ((keyNvId == ZCD_NV_NWK_ACTIVE_KEY_INFO) ||
// 3014       (keyNvId == ZCD_NV_NWK_ALTERN_KEY_INFO))
        MOV     A,#0x3a
        XRL     A,R2
        JNZ     ??ZDSecMgrReadKeyFromNv_0
        MOV     A,R3
??ZDSecMgrReadKeyFromNv_0:
        JZ      ??ZDSecMgrReadKeyFromNv_1
        MOV     A,#0x3b
        XRL     A,R2
        JNZ     ??ZDSecMgrReadKeyFromNv_2
        MOV     A,R3
??ZDSecMgrReadKeyFromNv_2:
        JNZ     ??ZDSecMgrReadKeyFromNv_3
// 3015   {
// 3016     // get NWK active or alternate key from NV
// 3017     return (osal_nv_read(keyNvId,
// 3018                          osal_offsetof(nwkKeyDesc, key),
// 3019                          SEC_KEY_LEN,
// 3020                          keyinfo));
??ZDSecMgrReadKeyFromNv_1:
        ; Setup parameters for call to function osal_nv_read
        MOV     ?V0 + 0,R4
        MOV     ?V0 + 1,R5
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 12)
        MOV     ?V0 + 0,#0x10
        MOV     ?V0 + 1,#0x0
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 14)
        MOV     R4,#0x1
        SJMP    ??ZDSecMgrReadKeyFromNv_4
          CFI CFA_XSP16 add(XSP16, 10)
// 3021   }
// 3022   else if ((keyNvId >= ZCD_NV_TCLK_TABLE_START) &&
// 3023            (keyNvId < (ZCD_NV_TCLK_TABLE_START + ZDSECMGR_TC_DEVICE_MAX)))
??ZDSecMgrReadKeyFromNv_3:
        MOV     A,R2
        ADD     A,#-0x1
        MOV     R0,A
        MOV     A,R3
        ADDC    A,#-0x2
        MOV     R1,A
        CLR     C
        MOV     A,R0
        SUBB    A,#0x2
        MOV     A,R1
        SUBB    A,#0x0
        JNC     ??ZDSecMgrReadKeyFromNv_5
// 3024   {
// 3025     // Read entry keyNvId of the TC link key table from NV. keyNvId should be
// 3026     // ZCD_NV_TCLK_TABLE_START + <offset_in_table>
// 3027     return (osal_nv_read(keyNvId,
// 3028                          osal_offsetof(APSME_TCLinkKey_t, key),
// 3029                          SEC_KEY_LEN,
// 3030                          keyinfo));
        ; Setup parameters for call to function osal_nv_read
        MOV     ?V0 + 0,R4
        MOV     ?V0 + 1,R5
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 12)
        MOV     ?V0 + 0,#0x10
        MOV     ?V0 + 1,#0x0
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 14)
        MOV     R4,#0x8
        SJMP    ??ZDSecMgrReadKeyFromNv_4
          CFI CFA_XSP16 add(XSP16, 10)
// 3031   }
// 3032   else if ((keyNvId >= ZCD_NV_APS_LINK_KEY_DATA_START) &&
// 3033            (keyNvId < (ZCD_NV_APS_LINK_KEY_DATA_START + ZDSECMGR_ENTRY_MAX)))
??ZDSecMgrReadKeyFromNv_5:
        DEC     R1
        CLR     C
        MOV     A,R0
        SUBB    A,#0x3
        MOV     A,R1
        SUBB    A,#0x0
        JNC     ??ZDSecMgrReadKeyFromNv_6
// 3034   {
// 3035     // Read entry keyNvId of the APS link key table from NV. keyNvId should be
// 3036     // ZCD_NV_APS_LINK_KEY_DATA_START + <offset_in_table>
// 3037     return (osal_nv_read(keyNvId,
// 3038                          osal_offsetof(APSME_LinkKeyData_t, key),
// 3039                          SEC_KEY_LEN,
// 3040                          keyinfo));
        ; Setup parameters for call to function osal_nv_read
        MOV     ?V0 + 0,R4
        MOV     ?V0 + 1,R5
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 12)
        MOV     ?V0 + 0,#0x10
        MOV     ?V0 + 1,#0x0
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 14)
        MOV     R4,#0x0
??ZDSecMgrReadKeyFromNv_4:
        MOV     R5,#0x0
        SJMP    ??ZDSecMgrReadKeyFromNv_7
          CFI CFA_XSP16 add(XSP16, 10)
// 3041   }
// 3042   else if (keyNvId == ZCD_NV_PRECFGKEY)
??ZDSecMgrReadKeyFromNv_6:
        MOV     A,#0x62
        XRL     A,R2
        JNZ     ??ZDSecMgrReadKeyFromNv_8
        MOV     A,R3
??ZDSecMgrReadKeyFromNv_8:
        JNZ     ??ZDSecMgrReadKeyFromNv_9
// 3043   {
// 3044     // Read entry keyNvId of the Preconfig key from NV.
// 3045     return (osal_nv_read(keyNvId,
// 3046                          0,
// 3047                          SEC_KEY_LEN,
// 3048                          keyinfo));
        ; Setup parameters for call to function osal_nv_read
        MOV     ?V0 + 0,R4
        MOV     ?V0 + 1,R5
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 12)
        MOV     ?V0 + 0,#0x10
        MOV     ?V0 + 1,#0x0
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 14)
        MOV     R4,#0x0
        MOV     R5,#0x0
        MOV     R2,#0x62
        MOV     R3,#0x0
??ZDSecMgrReadKeyFromNv_7:
        LCALL   ??osal_nv_read?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 10)
        SJMP    ??ZDSecMgrReadKeyFromNv_10
// 3049   }
// 3050 
// 3051   return NV_OPER_FAILED;
??ZDSecMgrReadKeyFromNv_9:
        MOV     R1,#0xa
??ZDSecMgrReadKeyFromNv_10:
        LJMP    ??Subroutine73_0 & 0xFFFF
          CFI EndBlock cfiBlock408
// 3052 }
// 3053 
// 3054 /******************************************************************************
// 3055  * @fn          ZDSecMgrApsLinkKeyInit
// 3056  *
// 3057  * @brief       Initialize the NV table for Application link keys
// 3058  *
// 3059  * @param       none
// 3060  *
// 3061  * @return      none
// 3062  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 3063 void ZDSecMgrApsLinkKeyInit(void)
ZDSecMgrApsLinkKeyInit:
          CFI Block cfiBlock409 Using cfiCommon0
          CFI Function ZDSecMgrApsLinkKeyInit
        CODE
// 3064 {
        FUNCALL ZDSecMgrApsLinkKeyInit, osal_memset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 34, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 34, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrApsLinkKeyInit, osal_nv_item_init
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 36, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 36, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0xa
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 10)
        ; Saved register size: 10
        ; Auto size: 24
        MOV     A,#-0x18
        LCALL   ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 34)
// 3065   APSME_LinkKeyData_t pApsLinkKey;
// 3066   uint8 i;
// 3067   uint8 status;
// 3068 
// 3069   // Initialize all NV items for APS link key, if not exist already.
// 3070   osal_memset( &pApsLinkKey, 0x00, sizeof(APSME_LinkKeyData_t) );
        ; Setup parameters for call to function osal_memset
        MOV     R4,#0x18
        MOV     R5,#0x0
        MOV     R1,#0x0
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??osal_memset?relay
// 3071 
// 3072   for( i = 0; i < ZDSECMGR_ENTRY_MAX; i++ )
        MOV     R6,#0x0
// 3073   {
// 3074     status = osal_nv_item_init( (ZCD_NV_APS_LINK_KEY_DATA_START + i),
// 3075                                sizeof(APSME_LinkKeyData_t), &pApsLinkKey );
??ZDSecMgrApsLinkKeyInit_0:
        ; Setup parameters for call to function osal_nv_item_init
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     ?V0 + 0,DPL
        MOV     ?V0 + 1,DPH
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 36)
        MOV     R4,#0x18
        MOV     R5,#0x0
        MOV     ?V0 + 0,R6
        MOV     A,?V0 + 0
        ADD     A,#0x1
        MOV     R2,A
        CLR     A
        ADDC    A,#0x2
        MOV     R3,A
        LCALL   ??osal_nv_item_init?relay
        MOV     A,#0x2
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 34)
// 3076 
// 3077 #if defined ( NV_RESTORE )
// 3078     (void)status;   // to eliminate compiler warning
// 3079 #else
// 3080     // reset the values of NV items if NV_RESTORE is not enabled
// 3081     if (status == SUCCESS)
// 3082     {
// 3083       osal_nv_write( (ZCD_NV_APS_LINK_KEY_DATA_START + i), 0,
// 3084                     sizeof(APSME_LinkKeyData_t), &pApsLinkKey );
// 3085 
// 3086     }
// 3087 #endif // defined (NV_RESTORE)
// 3088   }
        INC     R6
        MOV     A,R6
        CLR     C
        SUBB    A,#0x3
        JC      ??ZDSecMgrApsLinkKeyInit_0
// 3089 }
        MOV     A,#0x18
        LJMP    ??Subroutine72_0 & 0xFFFF
          CFI EndBlock cfiBlock409
// 3090 
// 3091 /******************************************************************************
// 3092  * @fn          ZDSecMgrInitNVKeyTables
// 3093  *
// 3094  * @brief       Initialize the NV table for All keys: NWK, Master, TCLK and APS
// 3095  *
// 3096  * @param       setDefault - TRUE to set default values
// 3097  *
// 3098  * @return      none
// 3099  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 3100 void ZDSecMgrInitNVKeyTables(uint8 setDefault)
ZDSecMgrInitNVKeyTables:
          CFI Block cfiBlock410 Using cfiCommon0
          CFI Function ZDSecMgrInitNVKeyTables
        CODE
// 3101 {
        FUNCALL ZDSecMgrInitNVKeyTables, ZDSecMgrNwkKeyInit
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrInitNVKeyTables, ZDSecMgrApsLinkKeyInit
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrInitNVKeyTables, APSME_TCLinkKeyInit
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x9
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 0
        MOV     A,R1
        MOV     R6,A
// 3102   ZDSecMgrNwkKeyInit(setDefault);
        ; Setup parameters for call to function ZDSecMgrNwkKeyInit
        LCALL   ??ZDSecMgrNwkKeyInit?relay
// 3103   ZDSecMgrApsLinkKeyInit();
        ; Setup parameters for call to function ZDSecMgrApsLinkKeyInit
        LCALL   ??ZDSecMgrApsLinkKeyInit?relay
// 3104   APSME_TCLinkKeyInit(setDefault);
        ; Setup parameters for call to function APSME_TCLinkKeyInit
        MOV     A,R6
        MOV     R1,A
        LCALL   ??APSME_TCLinkKeyInit?relay
// 3105 }
        LJMP    ??Subroutine68_0 & 0xFFFF
          CFI EndBlock cfiBlock410
// 3106 
// 3107 /******************************************************************************
// 3108  * @fn          ZDSecMgrSaveApsLinkKey
// 3109  *
// 3110  * @brief       Save APS Link Key to NV. It will loop through all the keys
// 3111  *              to see which one to save.
// 3112  *
// 3113  * @param       none
// 3114  *
// 3115  * @return      none
// 3116  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 3117 void ZDSecMgrSaveApsLinkKey(void)
ZDSecMgrSaveApsLinkKey:
          CFI Block cfiBlock411 Using cfiCommon0
          CFI Function ZDSecMgrSaveApsLinkKey
        CODE
// 3118 {
        FUNCALL ZDSecMgrSaveApsLinkKey, osal_mem_alloc
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 18, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 18, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrSaveApsLinkKey, osal_nv_read
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 22, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 22, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrSaveApsLinkKey, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 22, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 22, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrSaveApsLinkKey, osal_memset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 18, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 18, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrSaveApsLinkKey, osal_mem_free
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 18, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 18, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x12
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V9 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V8 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V7 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 18)
        ; Saved register size: 18
        ; Auto size: 0
// 3119   APSME_LinkKeyData_t *pKeyData = NULL;
// 3120   int i;
// 3121 
// 3122   pKeyData = (APSME_LinkKeyData_t *)osal_mem_alloc(sizeof(APSME_LinkKeyData_t));
        ; Setup parameters for call to function osal_mem_alloc
        MOV     R2,#0x18
        MOV     R3,#0x0
        LCALL   ??osal_mem_alloc?relay
        MOV     ?V0 + 6,R2
        MOV     ?V0 + 7,R3
// 3123 
// 3124   if (pKeyData != NULL)
        MOV     A,R2
        ORL     A,?V0 + 7
        JNZ     $+5
        LJMP    ??ZDSecMgrSaveApsLinkKey_0 & 0xFFFF
// 3125   {
// 3126     // checks all pending flags to know which one to save
// 3127     for (i = 0; i < ZDSECMGR_ENTRY_MAX; i++)
        MOV     R6,#0x0
        MOV     R7,#0x0
// 3128     {
// 3129       if (ApsLinkKeyFrmCntr[i].pendingFlag == TRUE)
??ZDSecMgrSaveApsLinkKey_1:
        MOV     A,R6
        MOV     R0,A
        MOV     A,R7
        MOV     R1,A
        MOV     A,R0
        MOV     B,#0x9
        MUL     AB
        MOV     R0,A
        MOV     R2,B
        MOV     B,#0x9
        MOV     A,R1
        MUL     AB
        ADD     A,R2
        MOV     R1,A
        MOV     A,#ApsLinkKeyFrmCntr & 0xff
        ADD     A,R0
        MOV     ?V0 + 0,A
        MOV     A,#(ApsLinkKeyFrmCntr >> 8) & 0xff
        LCALL   ?Subroutine40 & 0xFFFF
??CrossCallReturnLabel_47:
        JNZ     ??ZDSecMgrSaveApsLinkKey_2
        MOV     A,R6
        ADD     A,#0x1
        MOV     ?V0 + 2,A
        MOV     A,R7
        ADDC    A,#0x2
        MOV     ?V0 + 3,A
        ; Setup parameters for call to function osal_nv_read
        MOV     R0,#?V0 + 6
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 20)
        MOV     ?V0 + 8,#0x18
        MOV     ?V0 + 9,#0x0
        MOV     R0,#?V0 + 8
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 22)
        MOV     R4,#0x0
        MOV     R5,#0x0
        MOV     R2,?V0 + 2
        MOV     R3,?V0 + 3
// 3130       {
// 3131         // retrieve key from NV
// 3132         if (osal_nv_read(ZCD_NV_APS_LINK_KEY_DATA_START + i, 0,
// 3133                          sizeof(APSME_LinkKeyData_t), pKeyData) == SUCCESS)
        LCALL   ??osal_nv_read?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 18)
        MOV     A,R1
        JNZ     ??ZDSecMgrSaveApsLinkKey_2
// 3134         {
// 3135           pKeyData->txFrmCntr = ApsLinkKeyFrmCntr[i].txFrmCntr;
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        LCALL   ?XLOAD_R2345
        MOV     A,?V0 + 6
        ADD     A,#0x10
        LCALL   ?Subroutine37 & 0xFFFF
??CrossCallReturnLabel_189:
        LCALL   ?XSTORE_R2345
// 3136           pKeyData->rxFrmCntr = ApsLinkKeyFrmCntr[i].rxFrmCntr;
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        LCALL   ?XLOAD_R2345
        MOV     A,?V0 + 6
        ADD     A,#0x14
        LCALL   ?Subroutine37 & 0xFFFF
??CrossCallReturnLabel_190:
        LCALL   ?XSTORE_R2345
// 3137 
// 3138           // Write the APS link key back to the NV
// 3139           osal_nv_write(ZCD_NV_APS_LINK_KEY_DATA_START + i, 0,
// 3140                         sizeof(APSME_LinkKeyData_t), pKeyData);
        ; Setup parameters for call to function osal_nv_write
        MOV     R0,#?V0 + 6
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 20)
        MOV     ?V0 + 0,#0x18
        MOV     ?V0 + 1,#0x0
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 22)
        MOV     R4,#0x0
        MOV     R5,#0x0
        MOV     R2,?V0 + 2
        MOV     R3,?V0 + 3
        LCALL   ??osal_nv_write?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 18)
// 3141 
// 3142           // clear the pending write flag
// 3143           ApsLinkKeyFrmCntr[i].pendingFlag = FALSE;
        MOV     DPL,?V0 + 4
        MOV     DPH,?V0 + 5
        CLR     A
        MOVX    @DPTR,A
// 3144         }
// 3145       }
// 3146     }
??ZDSecMgrSaveApsLinkKey_2:
        LCALL   ?Subroutine33 & 0xFFFF
??CrossCallReturnLabel_37:
        MOV     C,0xD0 /* PSW */.2
        XRL     A,PSW
        RLC     A
        JNC     $+5
        LJMP    ??ZDSecMgrSaveApsLinkKey_1 & 0xFFFF
// 3147 
// 3148     // clear copy of key in RAM
// 3149     osal_memset( pKeyData, 0x00, sizeof(APSME_LinkKeyData_t) );
        ; Setup parameters for call to function osal_memset
        MOV     R4,#0x18
        MOV     R5,#0x0
        MOV     R1,#0x0
        MOV     R2,?V0 + 6
        MOV     R3,?V0 + 7
        LCALL   ??osal_memset?relay
// 3150 
// 3151     osal_mem_free(pKeyData);
        ; Setup parameters for call to function osal_mem_free
        MOV     R2,?V0 + 6
        MOV     R3,?V0 + 7
        LCALL   ??osal_mem_free?relay
// 3152   }
// 3153 }
??ZDSecMgrSaveApsLinkKey_0:
        SJMP    ??Subroutine74_0
          CFI EndBlock cfiBlock411

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine6:
          CFI Block cfiBlock412 Using cfiCommon0
          CFI NoFunction
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 20)
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V7 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V8 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V9 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI Invalid
        LCALL   ?DEALLOC_XSTACK8
          CFI EndBlock cfiBlock412
        REQUIRE ??Subroutine74_0
        ; // Fall through to label ??Subroutine74_0

        RSEG BANKED_CODE:CODE:NOROOT(0)
??Subroutine74_0:
          CFI Block cfiBlock413 Using cfiCommon0
          CFI NoFunction
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 18)
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V7 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V8 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V9 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        MOV     R7,#0xa
        LJMP    ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock413
// 3154 
// 3155 /******************************************************************************
// 3156  * @fn          ZDSecMgrSaveTCLinkKey
// 3157  *
// 3158  * @brief       Save TC Link Key to NV. It will loop through all the keys
// 3159  *              to see which one to save.
// 3160  *
// 3161  * @param       none
// 3162  *
// 3163  * @return      none
// 3164  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 3165 void ZDSecMgrSaveTCLinkKey(void)
ZDSecMgrSaveTCLinkKey:
          CFI Block cfiBlock414 Using cfiCommon0
          CFI Function ZDSecMgrSaveTCLinkKey
        CODE
// 3166 {
        FUNCALL ZDSecMgrSaveTCLinkKey, osal_mem_alloc
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 18, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 18, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrSaveTCLinkKey, osal_nv_read
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 22, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 22, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrSaveTCLinkKey, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 22, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 22, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrSaveTCLinkKey, osal_memset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 18, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 18, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrSaveTCLinkKey, osal_mem_free
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 18, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 18, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x12
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V9 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V8 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V7 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 18)
        ; Saved register size: 18
        ; Auto size: 0
// 3167   APSME_TCLinkKey_t *pKeyData = NULL;
// 3168   uint16 i;
// 3169 
// 3170   pKeyData = (APSME_TCLinkKey_t *)osal_mem_alloc(sizeof(APSME_TCLinkKey_t));
        ; Setup parameters for call to function osal_mem_alloc
        MOV     R2,#0x20
        MOV     R3,#0x0
        LCALL   ??osal_mem_alloc?relay
        MOV     ?V0 + 6,R2
        MOV     ?V0 + 7,R3
// 3171 
// 3172   if (pKeyData != NULL)
        MOV     A,R2
        ORL     A,?V0 + 7
        JNZ     $+5
        LJMP    ??ZDSecMgrSaveTCLinkKey_0 & 0xFFFF
// 3173   {
// 3174     for( i = 0; i < ZDSECMGR_TC_DEVICE_MAX; i++ )
        MOV     R6,#0x0
        MOV     R7,#0x0
// 3175     {
// 3176       if (TCLinkKeyFrmCntr[i].pendingFlag == TRUE)
??ZDSecMgrSaveTCLinkKey_1:
        MOV     A,R6
        MOV     R0,A
        MOV     A,R7
        MOV     R1,A
        MOV     A,R0
        MOV     B,#0x9
        MUL     AB
        MOV     R0,A
        MOV     R2,B
        MOV     B,#0x9
        MOV     A,R1
        MUL     AB
        ADD     A,R2
        MOV     R1,A
        MOV     A,#TCLinkKeyFrmCntr & 0xff
        ADD     A,R0
        MOV     ?V0 + 0,A
        MOV     A,#(TCLinkKeyFrmCntr >> 8) & 0xff
        LCALL   ?Subroutine40 & 0xFFFF
??CrossCallReturnLabel_48:
        JNZ     ??ZDSecMgrSaveTCLinkKey_2
// 3177       {
// 3178         if (osal_nv_read(ZCD_NV_TCLK_TABLE_START + i, 0,
// 3179                          sizeof(APSME_TCLinkKey_t), pKeyData) == SUCCESS)
        MOV     A,R6
        ADD     A,#0x1
        MOV     ?V0 + 2,A
        MOV     A,R7
        ADDC    A,#0x1
        MOV     ?V0 + 3,A
        ; Setup parameters for call to function osal_nv_read
        MOV     R0,#?V0 + 6
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 20)
        MOV     ?V0 + 8,#0x20
        MOV     ?V0 + 9,#0x0
        MOV     R0,#?V0 + 8
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 22)
        MOV     R4,#0x0
        MOV     R5,#0x0
        MOV     R2,?V0 + 2
        MOV     R3,?V0 + 3
        LCALL   ??osal_nv_read?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 18)
        MOV     A,R1
        JNZ     ??ZDSecMgrSaveTCLinkKey_2
// 3180         {
// 3181           pKeyData->txFrmCntr = TCLinkKeyFrmCntr[i].txFrmCntr;
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        LCALL   ?XLOAD_R2345
        MOV     A,?V0 + 6
        ADD     A,#0x18
        LCALL   ?Subroutine37 & 0xFFFF
??CrossCallReturnLabel_191:
        LCALL   ?XSTORE_R2345
// 3182           pKeyData->rxFrmCntr = TCLinkKeyFrmCntr[i].rxFrmCntr;
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        LCALL   ?XLOAD_R2345
        MOV     A,?V0 + 6
        ADD     A,#0x1c
        LCALL   ?Subroutine37 & 0xFFFF
??CrossCallReturnLabel_192:
        LCALL   ?XSTORE_R2345
// 3183 
// 3184           // Write the TC link key back to the NV
// 3185           osal_nv_write(ZCD_NV_TCLK_TABLE_START + i, 0,
// 3186                         sizeof(APSME_TCLinkKey_t), pKeyData);
        ; Setup parameters for call to function osal_nv_write
        MOV     R0,#?V0 + 6
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 20)
        MOV     ?V0 + 0,#0x20
        MOV     ?V0 + 1,#0x0
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 22)
        MOV     R4,#0x0
        MOV     R5,#0x0
        MOV     R2,?V0 + 2
        MOV     R3,?V0 + 3
        LCALL   ??osal_nv_write?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 18)
// 3187 
// 3188           // clear the pending write flag
// 3189           TCLinkKeyFrmCntr[i].pendingFlag = FALSE;
        MOV     DPL,?V0 + 4
        MOV     DPH,?V0 + 5
        CLR     A
        MOVX    @DPTR,A
// 3190         }
// 3191       }
// 3192     }
??ZDSecMgrSaveTCLinkKey_2:
        LCALL   ?Subroutine51 & 0xFFFF
??CrossCallReturnLabel_67:
        SUBB    A,#0x2
        MOV     A,R7
        SUBB    A,#0x0
        JNC     $+5
        LJMP    ??ZDSecMgrSaveTCLinkKey_1 & 0xFFFF
// 3193       // clear copy of key in RAM
// 3194     osal_memset( pKeyData, 0x00, sizeof(APSME_TCLinkKey_t) );
        ; Setup parameters for call to function osal_memset
        MOV     R4,#0x20
        MOV     R5,#0x0
        MOV     R1,#0x0
        MOV     R2,?V0 + 6
        MOV     R3,?V0 + 7
        LCALL   ??osal_memset?relay
// 3195 
// 3196     osal_mem_free(pKeyData);
        ; Setup parameters for call to function osal_mem_free
        MOV     R2,?V0 + 6
        MOV     R3,?V0 + 7
        LCALL   ??osal_mem_free?relay
// 3197   }
// 3198 }
??ZDSecMgrSaveTCLinkKey_0:
        LJMP    ??Subroutine74_0 & 0xFFFF
          CFI EndBlock cfiBlock414

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine51:
          CFI Block cfiCond415 Using cfiCommon0
          CFI Function ZDSecMgrWriteNV
          CFI Conditional ??CrossCallReturnLabel_66, ??CrossCallReturnLabel_34
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 14)
          CFI Block cfiCond416 Using cfiCommon0
          CFI (cfiCond416) Function ZDSecMgrSetDefaultNV
          CFI (cfiCond416) Conditional ??CrossCallReturnLabel_66, ??CrossCallReturnLabel_35
          CFI (cfiCond416) R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond416) VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond416) V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond416) V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond416) V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond416) V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond416) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond416) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond416) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond416) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond416) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond416) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond416) CFA_SP SP+0
          CFI (cfiCond416) CFA_XSP16 add(XSP16, 19)
          CFI Block cfiCond417 Using cfiCommon0
          CFI (cfiCond417) Function ZDSecMgrSetDefaultNV
          CFI (cfiCond417) Conditional ??CrossCallReturnLabel_66, ??CrossCallReturnLabel_36
          CFI (cfiCond417) R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond417) VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond417) V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond417) V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond417) V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond417) V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond417) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond417) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond417) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond417) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond417) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond417) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond417) CFA_SP SP+0
          CFI (cfiCond417) CFA_XSP16 add(XSP16, 19)
          CFI Block cfiCond418 Using cfiCommon0
          CFI (cfiCond418) Function ZDSecMgrSaveApsLinkKey
          CFI (cfiCond418) Conditional ??CrossCallReturnLabel_66, ??CrossCallReturnLabel_37
          CFI (cfiCond418) R6 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI (cfiCond418) VB load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI (cfiCond418) V0 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI (cfiCond418) V1 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond418) V2 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond418) V3 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond418) V4 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond418) V5 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond418) V6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond418) V7 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond418) V8 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond418) V9 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond418) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond418) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond418) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond418) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond418) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond418) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond418) CFA_SP SP+0
          CFI (cfiCond418) CFA_XSP16 add(XSP16, 18)
          CFI Block cfiCond419 Using cfiCommon0
          CFI (cfiCond419) Function ZDSecMgrSaveTCLinkKey
          CFI (cfiCond419) Conditional ??CrossCallReturnLabel_67
          CFI (cfiCond419) R6 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI (cfiCond419) VB load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI (cfiCond419) V0 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI (cfiCond419) V1 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond419) V2 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond419) V3 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond419) V4 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond419) V5 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond419) V6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond419) V7 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond419) V8 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond419) V9 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond419) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond419) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond419) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond419) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond419) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond419) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond419) CFA_SP SP+0
          CFI (cfiCond419) CFA_XSP16 add(XSP16, 18)
          CFI Block cfiPicker420 Using cfiCommon1
          CFI (cfiPicker420) NoFunction
          CFI (cfiPicker420) Picker
        MOV     A,R6
        ADD     A,#0x1
        INC     R6
        MOV     A,R7
        ADDC    A,#0x0
        MOV     R7,A
        CLR     C
        MOV     A,R6
        RET
          CFI EndBlock cfiCond415
          CFI EndBlock cfiCond416
          CFI EndBlock cfiCond417
          CFI EndBlock cfiCond418
          CFI EndBlock cfiCond419
          CFI EndBlock cfiPicker420

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine40:
          CFI Block cfiCond421 Using cfiCommon0
          CFI Function ZDSecMgrSaveApsLinkKey
          CFI Conditional ??CrossCallReturnLabel_47
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V7 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V8 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V9 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 18)
          CFI Block cfiCond422 Using cfiCommon0
          CFI (cfiCond422) Function ZDSecMgrSaveTCLinkKey
          CFI (cfiCond422) Conditional ??CrossCallReturnLabel_48
          CFI (cfiCond422) R6 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI (cfiCond422) VB load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI (cfiCond422) V0 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI (cfiCond422) V1 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond422) V2 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond422) V3 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond422) V4 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond422) V5 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond422) V6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond422) V7 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond422) V8 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond422) V9 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond422) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond422) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond422) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond422) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond422) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond422) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond422) CFA_SP SP+0
          CFI (cfiCond422) CFA_XSP16 add(XSP16, 18)
          CFI Block cfiPicker423 Using cfiCommon1
          CFI (cfiPicker423) NoFunction
          CFI (cfiPicker423) Picker
        ADDC    A,R1
        MOV     ?V0 + 1,A
        MOV     A,?V0 + 0
        ADD     A,#0x8
        MOV     ?V0 + 4,A
        MOV     A,?V0 + 1
        ADDC    A,#0x0
        MOV     ?V0 + 5,A
        MOV     DPL,?V0 + 4
        MOV     DPH,A
        MOVX    A,@DPTR
        XRL     A,#0x1
        RET
          CFI EndBlock cfiCond421
          CFI EndBlock cfiCond422
          CFI EndBlock cfiPicker423
// 3199 
// 3200 /******************************************************************************
// 3201  * @fn          ZDSecMgrUpdateTCAddress
// 3202  *
// 3203  * @brief       Update Trust Center address and save to NV.
// 3204  *
// 3205  * @param       extAddr - [in] extended address or NULL if no TC protected
// 3206  *
// 3207  * @return      none
// 3208  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 3209 void ZDSecMgrUpdateTCAddress( uint8 *extAddr )
ZDSecMgrUpdateTCAddress:
          CFI Block cfiBlock424 Using cfiCommon0
          CFI Function ZDSecMgrUpdateTCAddress
        CODE
// 3210 {
        FUNCALL ZDSecMgrUpdateTCAddress, APSME_SetRequest
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 18, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 18, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrUpdateTCAddress, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 22, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 22, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0xa
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 10)
        ; Saved register size: 10
        ; Auto size: 8
        MOV     A,#-0x8
        LCALL   ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 18)
// 3211   uint8 noTCAddress[Z_EXTADDR_LEN] = { 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF };
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     R4,DPL
        MOV     R5,DPH
        MOV     DPH,#(`?<Constant {255, 255, 255, 255, 255, 255, 255,` >> 8) & 0xff
        MOV     DPL,#`?<Constant {255, 255, 255, 255, 255, 255, 255,` & 0xff
        MOV     A,#0x8
        LCALL   ?MOVE_LONG8_XDATA_XDATA
// 3212   APSME_SetRequest( apsTrustCenterAddress, 0, ( extAddr != NULL) ? extAddr : noTCAddress );
        MOV     A,R2
        ORL     A,R3
        JNZ     ??ZDSecMgrUpdateTCAddress_0
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     R2,DPL
        MOV     R3,DPH
??ZDSecMgrUpdateTCAddress_0:
        ; Setup parameters for call to function APSME_SetRequest
        MOV     A,R2
        MOV     R4,A
        MOV     A,R3
        MOV     R5,A
        MOV     R2,#0x0
        MOV     R3,#0x0
        MOV     R1,#-0x55
        LCALL   ??APSME_SetRequest?relay
// 3213 #if defined ( NV_RESTORE )
// 3214   osal_nv_write( ZCD_NV_TRUSTCENTER_ADDR, 0, Z_EXTADDR_LEN, zgApsTrustCenterAddr );
        ; Setup parameters for call to function osal_nv_write
        MOV     ?V0 + 0,#zgApsTrustCenterAddr & 0xff
        MOV     ?V0 + 1,#(zgApsTrustCenterAddr >> 8) & 0xff
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 20)
        MOV     ?V0 + 0,#0x8
        MOV     ?V0 + 1,#0x0
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 22)
        MOV     R4,#0x0
        MOV     R5,#0x0
        MOV     R2,#0x71
        MOV     R3,#0x0
        LCALL   ??osal_nv_write?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 18)
// 3215 #endif
// 3216 }
        MOV     A,#0x8
        LJMP    ??Subroutine72_0 & 0xFFFF
          CFI EndBlock cfiBlock424
// 3217 
// 3218 #if defined ( ZBA_FALLBACK_NWKKEY )
// 3219 /******************************************************************************
// 3220  * @fn          ZDSecMgrFallbackNwkKey
// 3221  *
// 3222  * @brief       Use the ZBA fallback network key.
// 3223  *
// 3224  * @param       none
// 3225  *
// 3226  * @return      none
// 3227  */
// 3228 void ZDSecMgrFallbackNwkKey( void )
// 3229 {
// 3230   if ( !_NIB.nwkKeyLoaded )
// 3231   {
// 3232     uint8 fallbackKey[SEC_KEY_LEN];
// 3233 
// 3234     ZDSecMgrReadKeyFromNv( ZCD_NV_PRECFGKEY, fallbackKey );
// 3235     SSP_UpdateNwkKey( fallbackKey, 0);
// 3236     SSP_SwitchNwkKey( 0 );
// 3237 
// 3238     // clear local copy of key
// 3239     osal_memset( fallbackKey, 0x00, SEC_KEY_LEN );
// 3240 
// 3241     // handle next step in authentication process
// 3242     ZDSecMgrAuthNwkKey();
// 3243   }
// 3244 }
// 3245 #endif // defined ( ZBA_FALLBACK_NWKKEY )
// 3246 
// 3247 #if defined ( NV_RESTORE )
// 3248 /******************************************************************************
// 3249  * @fn          ZDSecMgrClearNVKeyValues
// 3250  *
// 3251  * @brief       If NV_RESTORE is enabled and the status of the network needs
// 3252  *              default values this fuction clears ZCD_NV_NWKKEY,
// 3253  *              ZCD_NV_NWK_ACTIVE_KEY_INFO and ZCD_NV_NWK_ALTERN_KEY_INFO link
// 3254  *
// 3255  * @param       none
// 3256  *
// 3257  * @return      none
// 3258  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 3259 void ZDSecMgrClearNVKeyValues(void)
ZDSecMgrClearNVKeyValues:
          CFI Block cfiBlock425 Using cfiCommon0
          CFI Function ZDSecMgrClearNVKeyValues
        CODE
// 3260 {
        FUNCALL ZDSecMgrClearNVKeyValues, osal_memset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 48, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 48, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrClearNVKeyValues, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 52, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 52, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrClearNVKeyValues, osal_memset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 48, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 48, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrClearNVKeyValues, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 52, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 52, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZDSecMgrClearNVKeyValues, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 52, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 52, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0xa
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 10)
        ; Saved register size: 10
        ; Auto size: 38
        MOV     A,#-0x26
        LCALL   ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 48)
// 3261   nwkActiveKeyItems keyItems;
// 3262   nwkKeyDesc nwkKey;
// 3263 
// 3264   osal_memset(&keyItems, 0x00, sizeof(nwkActiveKeyItems));
        ; Setup parameters for call to function osal_memset
        MOV     R4,#0x15
        MOV     R5,#0x0
        MOV     R1,#0x0
        MOV     A,#0x11
        LCALL   ?XSTACK_DISP0_8
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??osal_memset?relay
// 3265 
// 3266   osal_nv_write(ZCD_NV_NWKKEY, 0, sizeof(nwkActiveKeyItems), &keyItems);
        ; Setup parameters for call to function osal_nv_write
        MOV     A,#0x11
        LCALL   ?XSTACK_DISP0_8
        MOV     ?V0 + 0,DPL
        MOV     ?V0 + 1,DPH
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 50)
        MOV     ?V0 + 0,#0x15
        MOV     ?V0 + 1,#0x0
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 52)
        MOV     R4,#0x0
        MOV     R5,#0x0
        MOV     R2,#-0x7e
        MOV     R3,#0x0
        LCALL   ??osal_nv_write?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 48)
// 3267 
// 3268   // Initialize NV items for NWK Active and Alternate keys.
// 3269   osal_memset( &nwkKey, 0x00, sizeof(nwkKeyDesc) );
        ; Setup parameters for call to function osal_memset
        MOV     R4,#0x11
        MOV     R5,#0x0
        MOV     R1,#0x0
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??osal_memset?relay
// 3270 
// 3271   osal_nv_write(ZCD_NV_NWK_ACTIVE_KEY_INFO, 0, sizeof(nwkKeyDesc), &nwkKey);
        ; Setup parameters for call to function osal_nv_write
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     ?V0 + 0,DPL
        MOV     ?V0 + 1,DPH
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 50)
        MOV     ?V0 + 0,#0x11
        MOV     ?V0 + 1,#0x0
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 52)
        MOV     R4,#0x0
        MOV     R5,#0x0
        MOV     R2,#0x3a
        MOV     R3,#0x0
        LCALL   ??osal_nv_write?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 48)
// 3272 
// 3273   osal_nv_write(ZCD_NV_NWK_ALTERN_KEY_INFO, 0, sizeof(nwkKeyDesc), &nwkKey);
        ; Setup parameters for call to function osal_nv_write
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     ?V0 + 0,DPL
        MOV     ?V0 + 1,DPH
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 50)
        MOV     ?V0 + 0,#0x11
        MOV     ?V0 + 1,#0x0
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 52)
        MOV     R4,#0x0
        MOV     R5,#0x0
        MOV     R2,#0x3b
        MOV     R3,#0x0
        LCALL   ??osal_nv_write?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 48)
// 3274 }
        LJMP    ?Subroutine9 & 0xFFFF
          CFI EndBlock cfiBlock425

        RSEG XDATA_ID:CODE:NOROOT(0)
`?<Initializer for ZDSecMgrAppKeyType>`:
        DATA8
        DB 3

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrAddrStore?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrAddrStore

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrExtAddrStore?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrExtAddrStore

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrExtAddrLookup?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrExtAddrLookup

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrAddrClear?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrAddrClear

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrEntryInit?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrEntryInit

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrEntryLookup?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrEntryLookup

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrEntryLookupAMI?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrEntryLookupAMI

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrEntryLookupExt?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrEntryLookupExt

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrEntryLookupExtGetIndex?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrEntryLookupExtGetIndex

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrEntryLookupAMIGetIndex?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrEntryLookupAMIGetIndex

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrEntryFree?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrEntryFree

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrEntryNew?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrEntryNew

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrAppKeyGet?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrAppKeyGet

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrAppKeyReq?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrAppKeyReq

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrSendNwkKey?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrSendNwkKey

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrDeviceRemoveByExtAddr?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrDeviceRemoveByExtAddr

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrDeviceRemove?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrDeviceRemove

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrDeviceValidateRM?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrDeviceValidateRM

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrDeviceValidate?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrDeviceValidate

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrDeviceJoin?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrDeviceJoin

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrDeviceJoinDirect?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrDeviceJoinDirect

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrDeviceJoinFwd?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrDeviceJoinFwd

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrDeviceNew?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrDeviceNew

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrAssocDeviceAuth?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrAssocDeviceAuth

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrAuthNwkKey?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrAuthNwkKey

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrInit?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrInit

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrConfig?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrConfig

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrPermitJoining?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrPermitJoining

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrPermitJoiningTimeout?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrPermitJoiningTimeout

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrNewDeviceEvent?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrNewDeviceEvent

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrTCExtAddrCheck?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrTCExtAddrCheck

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrTCDataLoad?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrTCDataLoad

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrTransportKeyInd?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrTransportKeyInd

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrUpdateDeviceInd?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrUpdateDeviceInd

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrRemoveDeviceInd?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrRemoveDeviceInd

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrRequestKeyInd?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrRequestKeyInd

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrSwitchKeyInd?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrSwitchKeyInd

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrRequestAppKey?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrRequestAppKey

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrSetupPartner?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrSetupPartner

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??APSME_LinkKeySet?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    APSME_LinkKeySet

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrAuthenticationSet?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrAuthenticationSet

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrAuthenticationCheck?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrAuthenticationCheck

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??APSME_LinkKeyNVIdGet?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    APSME_LinkKeyNVIdGet

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??APSME_IsLinkKeyValid?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    APSME_IsLinkKeyValid

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??APSME_KeyFwdToChild?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    APSME_KeyFwdToChild

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrAddLinkKey?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrAddLinkKey

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrInitNV?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrInitNV

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrWriteNV?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrWriteNV

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrRestoreFromNV?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrRestoreFromNV

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrSetDefaultNV?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrSetDefaultNV

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrAPSRemove?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrAPSRemove

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??APSME_TCLinkKeyInit?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    APSME_TCLinkKeyInit

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??APSME_TCLinkKeySync?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    APSME_TCLinkKeySync

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??APSME_TCLinkKeyLoad?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    APSME_TCLinkKeyLoad

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??APSME_IsDefaultTCLK?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    APSME_IsDefaultTCLK

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrNwkKeyInit?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrNwkKeyInit

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrReadKeyFromNv?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrReadKeyFromNv

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrApsLinkKeyInit?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrApsLinkKeyInit

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrInitNVKeyTables?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrInitNVKeyTables

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrSaveApsLinkKey?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrSaveApsLinkKey

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrSaveTCLinkKey?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrSaveTCLinkKey

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrUpdateTCAddress?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrUpdateTCAddress

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZDSecMgrClearNVKeyValues?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZDSecMgrClearNVKeyValues

        RSEG XDATA_ROM_C:CONST:REORDER:NOROOT(0)
        DATA8
`?<Constant {255, 255, 255, 255, 255, 255, 255,`:
        DB 255
        DB 255
        DB 255
        DB 255
        DB 255
        DB 255
        DB 255
        DB 255

        RSEG XDATA_ROM_C:CONST:REORDER:NOROOT(0)
        DATA32
__Constant_3e9:
        DD 1001

        RSEG XDATA_ROM_C:CONST:REORDER:NOROOT(0)
        DATA32
__Constant_b:
        DD 11

        RSEG XDATA_ROM_C:CONST:REORDER:NOROOT(0)
        DATA32
__Constant_1:
        DD 1

        RSEG XDATA_ROM_C:CONST:REORDER:NOROOT(0)
        DATA32
__Constant_a:
        DD 10

        END
// 3275 #endif // defined ( NV_RESTORE )
// 3276 
// 3277 /******************************************************************************
// 3278 ******************************************************************************/
// 
// 8 800 bytes in segment BANKED_CODE
//   378 bytes in segment BANK_RELAYS
//     1 byte  in segment XDATA_I
//     1 byte  in segment XDATA_ID
//    24 bytes in segment XDATA_ROM_C
//    90 bytes in segment XDATA_Z
// 
// 9 179 bytes of CODE  memory
//     8 bytes of CONST memory (+ 16 bytes shared)
//    91 bytes of XDATA memory
//
//Errors: none
//Warnings: none
